<!DOCTYPE html>
<html>
  <head>
    <script>
      (function(){
  const {protocol:proto, host:hostName, pathname:path, search:srch, hash:hsh} = window.location;
  if (!(path.endsWith("/") || path.endsWith(".html"))) {
    window.location.replace(`${proto}//${hostName}${path}/${srch}${hsh}`);
  }
})()</script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <title>🚧 Harmonic Oscillator Optimization</title><link rel="stylesheet" href="../../book.css">
    <script>
      
function saveCheckboxesInit() {
  for (checkbox of document.querySelectorAll('#toc input[type="checkbox"]')) {
    const value = localStorage.getItem(checkbox.id);

    // Treat the ToC toggle specially, because it should always default to
    // closed on mobile-width screens but respect user preference on desktop-width.
    if (checkbox.id === "toggle-toc" && window.matchMedia("(max-width: 700px)").matches) {
        checkbox.checked = false;
    } else if (value === "true") {
        checkbox.checked = true;
    } else if (value === "false") {
        checkbox.checked = false;
    } // if not found, do nothing

    checkbox.addEventListener("change", persistCheckbox);
  }
}

function persistCheckbox() {
  const value = this.checked; // in a handler, 'this' is the element with the handler on it
  const id = this.id;
  localStorage.setItem(this.id, value ? "true" : "false");
}

window.addEventListener("DOMContentLoaded", saveCheckboxesInit);
</script>
    <script>
      const __versoSiteRoot = "./../../"</script>
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js" integrity="sha384-zbcZAIxlvJtNE3Dp5nxLXdXtXyxwOdnILY1TDPVmKFhl4r4nSUG1r8bcFXGVa4Te" crossorigin="anonymous"></script>
    <script src="../../static/katex/katex.min.js"></script>
    <script src="../../static/math.js"></script>
    <script src="../../static/print.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../-verso-js/popper.js"></script>
    <script src="../../-verso-js/tippy.js"></script>
    <link rel="stylesheet" href="../../static/colors.css">
    <link rel="stylesheet" href="../../static/theme.css">
    <link rel="stylesheet" href="../../static/print.css">
    <link rel="stylesheet" href="../../static/fonts/source-serif/source-serif-text.css">
    <link rel="stylesheet" href="../../static/fonts/source-code-pro/source-code-pro.css">
    <link rel="stylesheet" href="../../static/katex/katex.min.css">
    <link rel="stylesheet" href="../../-verso-css/tippy-border.css">
    <style>

.hl.lean {
  white-space: pre;
  font-weight: normal;
  font-style: normal;
}

.hl.lean .keyword {
  font-weight : bold;
}

.hl.lean .var {
  font-style: italic;
  position: relative;
}

.hover-container {
  width: 0;
  height: 0;
  position: relative;
  display: inline;
}

.hl.lean a {
  color: inherit;
  text-decoration: currentcolor underline dotted;
}

.hl.lean a:hover {
  text-decoration: currentcolor underline solid;
}

.hl.lean .hover-info {
  white-space: normal;
}

.hl.lean .token .hover-info {
  display: none;
  position: absolute;
  background-color: #e5e5e5;
  border: 1px solid black;
  padding: 0.5rem;
  z-index: 300;
  font-size: inherit;
}

.hl.lean .hover-info.messages {
  max-height: 10rem;
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-gutter: stable;
  padding: 0 0.5rem 0 0;
  display: block;
}

.hl.lean .hover-info code {
  white-space: pre-wrap;
}

.hl.lean .hover-info.messages > code {
  padding: 0.5rem;
  display: block;
  width: fit-content;
}

.hl.lean .hover-info.messages > code:only-child {
  margin: 0;
}

.hl.lean .hover-info.messages > code {
  margin: 0.1rem;
}

.hl.lean .hover-info.messages > code:not(:first-child) {
  margin-top: 0rem;
}

/*
@media (hover: hover) {
  .hl.lean .has-info:hover > .hover-container > .hover-info:not(.tactic *),
  .hl.lean .tactic:has(> .tactic-toggle:checked) .has-info:hover > .hover-container > .hover-info,
  .hl.lean .token:hover > .hover-container > .hover-info:not(.has-info *):not(.tactic *),
  .hl.lean .tactic:has(> .tactic-toggle:checked) .token:hover > .hover-container > .hover-info:not(.has-info *) {
    display: inline-block;
    position: absolute;
    top: 1rem;
    font-weight: normal;
    font-style: normal;
    width: min-content;
  }
}
*/

.hl.lean.block {
  display: block;
}

.hl.lean.inline {
  display: inline;
  white-space: pre-wrap;
}

.hl.lean .token {
  transition: all 0.25s; /* Slight fade for highlights */
}

@media (hover: hover) {
  .hl.lean .token.binding-hl, .hl.lean .literal.string:hover, .hl.lean .token.typed:hover {
    background-color: #eee;
    border-radius: 2px;
    transition: none;
  }
}


.hl.lean .has-info {
  text-decoration-style: wavy;
  text-decoration-line: underline;
  text-decoration-thickness: 0.1rem;
}

.hl.lean .has-info .hover-info {
  display: none;
  position: absolute;
  transform: translate(0.25rem, 0.3rem);
  border: 1px solid black;
  padding: 0.5rem;
  z-index: 400;
  text-align: left;
}

.hl.lean .has-info.error {
  text-decoration-color: red;
}

@media (hover: hover) {
  .hl.lean .has-info.error:hover {
    background-color: #ffb3b3;
  }
}

.hl.lean .hover-info.messages > code.error {
  background-color: #e5e5e5;
  border-left: 0.2rem solid #ffb3b3;
}

.tippy-box[data-theme~='error'] .hl.lean .hover-info.messages > code.error {
  background: none;
  border: none;
}

.error pre {
    color: red;
}

.hl.lean .has-info.warning {
  text-decoration-color: #efd871;
}

@media (hover: hover) {
  .hl.lean .has-info.warning:hover {
    background-color: #efd871;
  }
}

.hl.lean .hover-info.messages > code.warning {
  background-color: #efd871;
}

.hl.lean .hover-info.messages > code.error {
  background-color: #e5e5e5;
  border-left: 0.2rem solid #efd871;
}

.tippy-box[data-theme~='warning'] .hl.lean .hover-info.messages > code.warning {
  background: none;
  border: none;
}


.hl.lean .has-info.info {
  text-decoration-color: blue;
}

@media (hover: hover) {
  .hl.lean .has-info.info:hover {
    background-color: #4777ff;
  }
}


.hl.lean .hover-info.messages > code.info {
  background-color: #e5e5e5;
  border-left: 0.2rem solid #4777ff;
}

.tippy-box[data-theme~='info'] .hl.lean .hover-info.messages > code.info {
  background: none;
  border: none;
}

.hl.lean div.docstring {
  font-family: sans-serif;
  white-space: normal;
  max-width: 40rem;
  width: max-content;
}

.hl.lean div.docstring > :last-child {
  margin-bottom: 0;
}

.hl.lean .hover-info .sep {
  display: block;
  width: auto;
  margin-left: 1rem;
  margin-right: 1rem;
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  padding: 0;
  height: 1px;
  border-top: 1px solid #ccc;
}

.hl.lean code {
  font-family: monospace;
}

.hl.lean .tactic-state {
  display: none;
  position: relative;
  left: 2rem;
  width: fit-content;
  border: 1px solid #888888;
  border-radius: 0.1rem;
  padding: 0.5rem;
  font-family: sans-serif;
  background-color: #ffffff;
  z-index: 200;
}

.hl.lean.popup .tactic-state {
  position: static;
  display: block;
  width: auto;
  border: none;
  padding: 0.5rem;
  font-family: sans-serif;
  background-color: #ffffff;
}


.hl.lean .tactic {
  position: relative;
}

.hl.lean .tactic-toggle:checked ~ .tactic-state {
  display: block;
}

/*
@media (hover: hover) {
  .hl.lean .tactic:hover > .tactic-toggle:not(:checked) ~ .tactic-state {
    display: block;
    position: absolute;
    left: 0;
    transform: translate(0.25rem, 0);
    z-index: 250;
  }
}
*/

.hl.lean .tactic > label {
  position: relative;
  transition: all 0.5s;
}

@media (hover: hover) {
  .hl.lean .tactic > label:hover {
    border-bottom: 1px dotted #bbbbbb;
  }
}

.hl.lean .tactic-toggle {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  height: 0;
  width: 0;
  z-index: -10;
}

.hl.lean .tactic > label::after {
  content: "";
  border: 1px solid #bbbbbb;
  border-radius: 1rem;
  height: 0.25rem;
  vertical-align: middle;
  width: 0.6rem;
  margin-left: 0.1rem;
  margin-right: 0.1rem;
  display: inline-block;
  transition: all 0.5s;
}

/*
@media (hover: hover) {
  .hl.lean .tactic > label:hover::after {
    border: 1px solid #aaaaaa;
    background-color: #aaaaaa;
    transition: all 0.5s;
  }
}
*/

.hl.lean .tactic > label:has(+ .tactic-toggle:checked)::after {
  border: 1px solid #999999;
  background-color: #999999;
  transition: all 0.5s;
}

.hl.lean .tactic-state .goal + .goal {
  margin-top: 1.5rem;
}

.hl.lean .tactic-state summary {
  margin-left: -0.5rem;
}

.hl.lean .tactic-state details {
  padding-left: 0.5rem;
}

.hl.lean .case-label {
  display: block;
  position: relative;
}

.hl.lean .case-label input[type="checkbox"] {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  height: 0;
  width: 0;
  z-index: -10;
}

.hl.lean .case-label:has(input[type="checkbox"])::before {
  width: 1rem;
  height: 1rem;
  display: inline-block;
  background-color: black;
  content: ' ';
  transition: ease 0.2s;
  margin-right: 0.7rem;
  clip-path: polygon(100% 0, 0 0, 50% 100%);
  width: 0.6rem;
  height: 0.6rem;
}

.hl.lean .case-label:has(input[type="checkbox"]:not(:checked))::before {
  transform: rotate(-90deg);
}

.hl.lean .case-label:has(input[type="checkbox"]) {

}

.hl.lean .case-label:has(input[type="checkbox"]:checked) {

}


.hl.lean .tactic-state .labeled-case > :not(:first-child) {
  max-height: 0px;
  display: block;
  overflow: hidden;
  transition: max-height 0.1s ease-in;
  margin-left: 0.5rem;
  margin-top: 0.1rem;
}

.hl.lean .labeled-case:has(.case-label input[type="checkbox"]:checked) > :not(:first-child) {
  max-height: 100%;
}


.hl.lean .tactic-state .goal-name::before {
  font-style: normal;
  content: "case ";
}

.hl.lean .tactic-state .goal-name {
  font-style: italic;
  font-family: monospace;
}

.hl.lean .tactic-state .hypotheses {
  display: table;
}

.hl.lean .tactic-state .hypothesis {
  display: table-row;
}

.hl.lean .tactic-state .hypothesis > * {
  display: table-cell;
}


.hl.lean .tactic-state .hypotheses .colon {
  text-align: center;
  min-width: 1rem;
}

.hl.lean .tactic-state .hypotheses .name {
  text-align: right;
}

.hl.lean .tactic-state .hypotheses .name,
.hl.lean .tactic-state .hypotheses .type,
.hl.lean .tactic-state .conclusion .type {
  font-family: monospace;
}

.tippy-box[data-theme~='lean'] {
  background-color: #e5e5e5;
  color: black;
  border: 1px solid black;
}
.tippy-box[data-theme~='lean'][data-placement^='top'] > .tippy-arrow::before {
  border-top-color: #e5e5e5;
}
.tippy-box[data-theme~='lean'][data-placement^='bottom'] > .tippy-arrow::before {
  border-bottom-color: #e5e5e5;
}
.tippy-box[data-theme~='lean'][data-placement^='left'] > .tippy-arrow::before {
  border-left-color: #e5e5e5;
}
.tippy-box[data-theme~='lean'][data-placement^='right'] > .tippy-arrow::before {
  border-right-color: #e5e5e5;
}

.tippy-box[data-theme~='message'][data-placement^='top'] > .tippy-arrow::before {
  border-top-color: #e5e5e5;
  border-width: 11px 11px 0;
}
.tippy-box[data-theme~='message'][data-placement^='top'] > .tippy-arrow::after {
  bottom: -11px;
  border-width: 11px 11px 0;
}
.tippy-box[data-theme~='message'][data-placement^='bottom'] > .tippy-arrow::before {
  border-width: 0 11px 11px;
}
.tippy-box[data-theme~='message'][data-placement^='bottom'] > .tippy-arrow::after {
  top: -11px;
  border-width: 0 11px 11px;
}
.tippy-box[data-theme~='message'][data-placement^='left'] > .tippy-arrow::before {
  border-left-color: #e5e5e5;
  border-width: 11px 0 11px 11px;
}
.tippy-box[data-theme~='message'][data-placement^='left'] > .tippy-arrow::after {
  right: -11px;
  border-width: 11px 0 11px 11px;
}

.tippy-box[data-theme~='message'][data-placement^='right'] > .tippy-arrow::before {
  border-right-color: #e5e5e5;
  border-width: 11px 11px 11px 0;
}
.tippy-box[data-theme~='message'][data-placement^='right'] > .tippy-arrow::after {
  left: -11px;
  border-width: 11px 11px 11px 0;
}



.tippy-box[data-theme~='warning'] {
  background-color: #e5e5e5;
  color: black;
  border: 3px solid #efd871;
}

.tippy-box[data-theme~='error'] {
  background-color: #e5e5e5;
  color: black;
  border: 3px solid #f7a7af;
}

.tippy-box[data-theme~='info'] {
  background-color: #e5e5e5;
  color: black;
  border: 3px solid #99b3c2;
}



.tippy-box[data-theme~='tactic'] {
  background-color: white;
  color: black;
  border: 1px solid black;
}
.tippy-box[data-theme~='tactic'][data-placement^='top'] > .tippy-arrow::before {
  border-top-color: white;
}
.tippy-box[data-theme~='tactic'][data-placement^='bottom'] > .tippy-arrow::before {
  border-bottom-color: white;
}
.tippy-box[data-theme~='tactic'][data-placement^='left'] > .tippy-arrow::before {
  border-left-color: white;
}
.tippy-box[data-theme~='tactic'][data-placement^='right'] > .tippy-arrow::before {
  border-right-color: white;
}

</style><style>
.namedocs {
  position: relative;
  border: solid 2px #99b3c0;
  background-color: #99b3c0;
  padding-left: 1px;
  padding-right: 1px;
  padding-bottom: 1px;
  padding-top: 1.5rem;
  margin-bottom: 1rem;
}

.namedocs .text {
  background-color: white;
  padding: 1.5rem;
  margin-top: 0.5rem;
}

.namedocs .text > pre {
  overflow-x: auto;
}

.namedocs .signature {
  font-family: var(--verso-code-font-family);
  font-size: larger;
  margin-top: 0 !important;
  margin-left: 1.5rem !important;
  margin-right: 1.5rem;
}

.namedocs .label {
  font-size: smaller;
  font-family: var(--verso-structure-font-family);
  position: absolute;
  right: 0.5rem;
  top: 0.5rem;
}

/* Sticking content into the right margin is not good on narrow screens,
   so move the label to the left to make space for the permalink widget. */

@media screen and (max-width: 700px) {
  .namedocs:has(.permalink-widget.block) .label {
    right: 1.5rem;
  }
}

.namedocs h1 {
  font-size: inherit;
  font-weight: bold;
}

.namedocs > .text .constructor {
  padding-left: 0.5rem;
  padding-top: 0;
  padding-right: 0;
  padding-bottom: 0;
  margin-top: 0.5rem;
  margin-bottom: 1.5rem;
}

.namedocs > .text .constructor::before {
  content: '| ';
  display: block;
  font-family: var(--verso-code-font-family);
  font-weight: bold;
  float: left;
  width: 0.5rem;
  white-space: pre;
}

.namedocs > .text .constructor .name-and-type {
  padding-left: 0.5rem;
  float: left;
  margin-top: 0;
}
.namedocs > .text .constructor .docs {
  clear: both;
  padding-left: 1rem;
}


.namedocs .methods td, .namedocs .fields td {
  vertical-align: top;
}
.namedocs .inheritance {
  vertical-align: top;
  font-size: smaller;
  font-family: var(--verso-structure-font-family);
}
.namedocs .inheritance ol {
  display: inline-block;
  margin: 0;
  padding: 0;
}
.namedocs .inheritance ol li {
  list-style-type: none;
  display: inline-block;
}
.namedocs .inheritance ol li::after {
  content: " > "
}
.namedocs .inheritance ol li:last-child::after {
  content: "";
}

.namedocs .extends {
  display: inline;
  margin: 0;
  padding: 0;
}

.namedocs .extends li {
  list-style-type: none;
  display: inline-block;
}

.namedocs .extends li label {
  padding-right: 1rem;
}

.namedocs .subdocs .name-and-type {
  font-size: 1rem;
  margin-left: 0;
  margin-top: 0;
  margin-right: 0;
  margin-bottom: 0.5rem;
}

.namedocs .subdocs .docs {
  margin-left: 1.5rem;
  margin-top: 0;
  margin-right: 0;
  margin-bottom: 0.5rem;
}

.namedocs:has(input[data-parent-idx]) [data-inherited-from] {
  transition-property: opacity, display;
  transition-duration: 0.4s;
  transition-behavior: allow-discrete;
  @starting-style { opacity: 0 !important; }
}
.namedocs:has(input[data-parent-idx="0"]) [data-inherited-from="0"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="0"]:checked) [data-inherited-from="0"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="0"]:checked):has(.inheritance[data-inherited-from="0"]:hover) [data-inherited-from]:not([data-inherited-from="0"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="1"]) [data-inherited-from="1"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="1"]:checked) [data-inherited-from="1"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="1"]:checked):has(.inheritance[data-inherited-from="1"]:hover) [data-inherited-from]:not([data-inherited-from="1"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="2"]) [data-inherited-from="2"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="2"]:checked) [data-inherited-from="2"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="2"]:checked):has(.inheritance[data-inherited-from="2"]:hover) [data-inherited-from]:not([data-inherited-from="2"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="3"]) [data-inherited-from="3"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="3"]:checked) [data-inherited-from="3"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="3"]:checked):has(.inheritance[data-inherited-from="3"]:hover) [data-inherited-from]:not([data-inherited-from="3"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="4"]) [data-inherited-from="4"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="4"]:checked) [data-inherited-from="4"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="4"]:checked):has(.inheritance[data-inherited-from="4"]:hover) [data-inherited-from]:not([data-inherited-from="4"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="5"]) [data-inherited-from="5"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="5"]:checked) [data-inherited-from="5"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="5"]:checked):has(.inheritance[data-inherited-from="5"]:hover) [data-inherited-from]:not([data-inherited-from="5"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="6"]) [data-inherited-from="6"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="6"]:checked) [data-inherited-from="6"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="6"]:checked):has(.inheritance[data-inherited-from="6"]:hover) [data-inherited-from]:not([data-inherited-from="6"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="7"]) [data-inherited-from="7"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="7"]:checked) [data-inherited-from="7"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="7"]:checked):has(.inheritance[data-inherited-from="7"]:hover) [data-inherited-from]:not([data-inherited-from="7"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="8"]) [data-inherited-from="8"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="8"]:checked) [data-inherited-from="8"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="8"]:checked):has(.inheritance[data-inherited-from="8"]:hover) [data-inherited-from]:not([data-inherited-from="8"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="9"]) [data-inherited-from="9"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="9"]:checked) [data-inherited-from="9"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="9"]:checked):has(.inheritance[data-inherited-from="9"]:hover) [data-inherited-from]:not([data-inherited-from="9"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="10"]) [data-inherited-from="10"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="10"]:checked) [data-inherited-from="10"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="10"]:checked):has(.inheritance[data-inherited-from="10"]:hover) [data-inherited-from]:not([data-inherited-from="10"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="11"]) [data-inherited-from="11"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="11"]:checked) [data-inherited-from="11"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="11"]:checked):has(.inheritance[data-inherited-from="11"]:hover) [data-inherited-from]:not([data-inherited-from="11"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="12"]) [data-inherited-from="12"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="12"]:checked) [data-inherited-from="12"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="12"]:checked):has(.inheritance[data-inherited-from="12"]:hover) [data-inherited-from]:not([data-inherited-from="12"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="13"]) [data-inherited-from="13"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="13"]:checked) [data-inherited-from="13"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="13"]:checked):has(.inheritance[data-inherited-from="13"]:hover) [data-inherited-from]:not([data-inherited-from="13"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="14"]) [data-inherited-from="14"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="14"]:checked) [data-inherited-from="14"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="14"]:checked):has(.inheritance[data-inherited-from="14"]:hover) [data-inherited-from]:not([data-inherited-from="14"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="15"]) [data-inherited-from="15"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="15"]:checked) [data-inherited-from="15"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="15"]:checked):has(.inheritance[data-inherited-from="15"]:hover) [data-inherited-from]:not([data-inherited-from="15"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="16"]) [data-inherited-from="16"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="16"]:checked) [data-inherited-from="16"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="16"]:checked):has(.inheritance[data-inherited-from="16"]:hover) [data-inherited-from]:not([data-inherited-from="16"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="17"]) [data-inherited-from="17"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="17"]:checked) [data-inherited-from="17"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="17"]:checked):has(.inheritance[data-inherited-from="17"]:hover) [data-inherited-from]:not([data-inherited-from="17"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="18"]) [data-inherited-from="18"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="18"]:checked) [data-inherited-from="18"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="18"]:checked):has(.inheritance[data-inherited-from="18"]:hover) [data-inherited-from]:not([data-inherited-from="18"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="19"]) [data-inherited-from="19"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="19"]:checked) [data-inherited-from="19"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="19"]:checked):has(.inheritance[data-inherited-from="19"]:hover) [data-inherited-from]:not([data-inherited-from="19"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="20"]) [data-inherited-from="20"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="20"]:checked) [data-inherited-from="20"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="20"]:checked):has(.inheritance[data-inherited-from="20"]:hover) [data-inherited-from]:not([data-inherited-from="20"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="21"]) [data-inherited-from="21"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="21"]:checked) [data-inherited-from="21"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="21"]:checked):has(.inheritance[data-inherited-from="21"]:hover) [data-inherited-from]:not([data-inherited-from="21"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="22"]) [data-inherited-from="22"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="22"]:checked) [data-inherited-from="22"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="22"]:checked):has(.inheritance[data-inherited-from="22"]:hover) [data-inherited-from]:not([data-inherited-from="22"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="23"]) [data-inherited-from="23"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="23"]:checked) [data-inherited-from="23"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="23"]:checked):has(.inheritance[data-inherited-from="23"]:hover) [data-inherited-from]:not([data-inherited-from="23"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="24"]) [data-inherited-from="24"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="24"]:checked) [data-inherited-from="24"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="24"]:checked):has(.inheritance[data-inherited-from="24"]:hover) [data-inherited-from]:not([data-inherited-from="24"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="25"]) [data-inherited-from="25"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="25"]:checked) [data-inherited-from="25"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="25"]:checked):has(.inheritance[data-inherited-from="25"]:hover) [data-inherited-from]:not([data-inherited-from="25"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="26"]) [data-inherited-from="26"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="26"]:checked) [data-inherited-from="26"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="26"]:checked):has(.inheritance[data-inherited-from="26"]:hover) [data-inherited-from]:not([data-inherited-from="26"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="27"]) [data-inherited-from="27"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="27"]:checked) [data-inherited-from="27"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="27"]:checked):has(.inheritance[data-inherited-from="27"]:hover) [data-inherited-from]:not([data-inherited-from="27"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="28"]) [data-inherited-from="28"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="28"]:checked) [data-inherited-from="28"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="28"]:checked):has(.inheritance[data-inherited-from="28"]:hover) [data-inherited-from]:not([data-inherited-from="28"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="29"]) [data-inherited-from="29"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="29"]:checked) [data-inherited-from="29"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="29"]:checked):has(.inheritance[data-inherited-from="29"]:hover) [data-inherited-from]:not([data-inherited-from="29"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="30"]) [data-inherited-from="30"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="30"]:checked) [data-inherited-from="30"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="30"]:checked):has(.inheritance[data-inherited-from="30"]:hover) [data-inherited-from]:not([data-inherited-from="30"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="31"]) [data-inherited-from="31"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="31"]:checked) [data-inherited-from="31"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="31"]:checked):has(.inheritance[data-inherited-from="31"]:hover) [data-inherited-from]:not([data-inherited-from="31"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="32"]) [data-inherited-from="32"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="32"]:checked) [data-inherited-from="32"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="32"]:checked):has(.inheritance[data-inherited-from="32"]:hover) [data-inherited-from]:not([data-inherited-from="32"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="33"]) [data-inherited-from="33"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="33"]:checked) [data-inherited-from="33"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="33"]:checked):has(.inheritance[data-inherited-from="33"]:hover) [data-inherited-from]:not([data-inherited-from="33"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="34"]) [data-inherited-from="34"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="34"]:checked) [data-inherited-from="34"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="34"]:checked):has(.inheritance[data-inherited-from="34"]:hover) [data-inherited-from]:not([data-inherited-from="34"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="35"]) [data-inherited-from="35"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="35"]:checked) [data-inherited-from="35"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="35"]:checked):has(.inheritance[data-inherited-from="35"]:hover) [data-inherited-from]:not([data-inherited-from="35"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="36"]) [data-inherited-from="36"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="36"]:checked) [data-inherited-from="36"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="36"]:checked):has(.inheritance[data-inherited-from="36"]:hover) [data-inherited-from]:not([data-inherited-from="36"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="37"]) [data-inherited-from="37"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="37"]:checked) [data-inherited-from="37"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="37"]:checked):has(.inheritance[data-inherited-from="37"]:hover) [data-inherited-from]:not([data-inherited-from="37"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="38"]) [data-inherited-from="38"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="38"]:checked) [data-inherited-from="38"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="38"]:checked):has(.inheritance[data-inherited-from="38"]:hover) [data-inherited-from]:not([data-inherited-from="38"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="39"]) [data-inherited-from="39"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="39"]:checked) [data-inherited-from="39"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="39"]:checked):has(.inheritance[data-inherited-from="39"]:hover) [data-inherited-from]:not([data-inherited-from="39"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="40"]) [data-inherited-from="40"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="40"]:checked) [data-inherited-from="40"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="40"]:checked):has(.inheritance[data-inherited-from="40"]:hover) [data-inherited-from]:not([data-inherited-from="40"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="41"]) [data-inherited-from="41"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="41"]:checked) [data-inherited-from="41"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="41"]:checked):has(.inheritance[data-inherited-from="41"]:hover) [data-inherited-from]:not([data-inherited-from="41"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="42"]) [data-inherited-from="42"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="42"]:checked) [data-inherited-from="42"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="42"]:checked):has(.inheritance[data-inherited-from="42"]:hover) [data-inherited-from]:not([data-inherited-from="42"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="43"]) [data-inherited-from="43"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="43"]:checked) [data-inherited-from="43"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="43"]:checked):has(.inheritance[data-inherited-from="43"]:hover) [data-inherited-from]:not([data-inherited-from="43"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="44"]) [data-inherited-from="44"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="44"]:checked) [data-inherited-from="44"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="44"]:checked):has(.inheritance[data-inherited-from="44"]:hover) [data-inherited-from]:not([data-inherited-from="44"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="45"]) [data-inherited-from="45"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="45"]:checked) [data-inherited-from="45"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="45"]:checked):has(.inheritance[data-inherited-from="45"]:hover) [data-inherited-from]:not([data-inherited-from="45"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="46"]) [data-inherited-from="46"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="46"]:checked) [data-inherited-from="46"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="46"]:checked):has(.inheritance[data-inherited-from="46"]:hover) [data-inherited-from]:not([data-inherited-from="46"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="47"]) [data-inherited-from="47"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="47"]:checked) [data-inherited-from="47"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="47"]:checked):has(.inheritance[data-inherited-from="47"]:hover) [data-inherited-from]:not([data-inherited-from="47"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="48"]) [data-inherited-from="48"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="48"]:checked) [data-inherited-from="48"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="48"]:checked):has(.inheritance[data-inherited-from="48"]:hover) [data-inherited-from]:not([data-inherited-from="48"]) {
  opacity: 0.5;
}
.namedocs:has(input[data-parent-idx="49"]) [data-inherited-from="49"] {
  display: none;
  opacity: 0;
}
.namedocs:has(input[data-parent-idx="49"]:checked) [data-inherited-from="49"] {
  display: table-row;
  transform: none;
  opacity: 1;
}
.namedocs:has(input[data-parent-idx="49"]:checked):has(.inheritance[data-inherited-from="49"]:hover) [data-inherited-from]:not([data-inherited-from="49"]) {
  opacity: 0.5;
}
</style><style>.solution {
  padding: 1.5em;
  border: 1px solid #98B2C0;
  border-radius: 0.5em;
  margin-bottom: 0.75em;
  margin-top: 0.75em;
  clear: both; /* Don't overlap margin notes with solutions */
}
.solution p:last-child {margin-bottom:0;}
.solution .description::before {
  content: "";
}
.solution[open] .description {
  margin-bottom: 1em;
}
.solution .description {
  font-style: italic;
  font-family: var(--verso-structure-font-family);
}
.solution .hl.lean.block {
  overflow-x: auto;
}
</style><style>
div.TODO {
  border: 5px solid red;
  position: relative;
}
div.TODO::before {
  content: "TODO";
  position: absolute;
  top: 0;
  right: 0;
  color: red;
  font-size: large;
  font-weight: bold;
  transform: rotate(-90deg) translate(-2em);
}
</style><style>.foldable {
  padding: 1.5em;
  border: 1px solid #98B2C0;
  border-radius: 0.5em;
  margin-bottom: 0.75em;
  margin-top: 0.75em;
  clear: both; /* Don't overlap margin notes with foldables */
}
.foldable p:last-child {margin-bottom:0;}
.foldable .description::before {
  content: "";
}
.foldable[open] .description {
  margin-bottom: 1em;
}
.foldable .description {
  font-style: italic;
  font-family: var(--verso-structure-font-family);
}
.foldable .hl.lean.block {
  overflow-x: auto;
}
</style><script>
      
window.onload = () => {

    // Don't show hovers inside of closed tactic states
    function blockedByTactic(elem) {
      let parent = elem.parentNode;
      while (parent && "classList" in parent) {
        if (parent.classList.contains("tactic")) {
          const toggle = parent.querySelector("input.tactic-toggle");
          if (toggle) {
            return !toggle.checked;
          }
        }
        parent = parent.parentNode;
      }
      return false;
    }

    function blockedByTippy(elem) {
      // Don't show a new hover until the old ones are all closed.
      // Scoped to the nearest "top-level block" to avoid being O(n) in the size of the document.
      var block = elem;
      const topLevel = new Set(["section", "body", "html", "nav", "header"]);
      while (block.parentNode && !topLevel.has(block.parentNode.nodeName.toLowerCase())) {
        block = block.parentNode;
      }
      for (const child of block.querySelectorAll(".token, .has-info")) {
        if (child._tippy && child._tippy.state.isVisible) { return true };
      }
      return false;
    }

    for (const c of document.querySelectorAll(".hl.lean .token")) {
        if (c.dataset.binding != "") {
            c.addEventListener("mouseover", (event) => {
                if (blockedByTactic(c)) {return;}
                const context = c.closest(".hl.lean").dataset.leanContext;
                for (const example of document.querySelectorAll(".hl.lean")) {
                    if (example.dataset.leanContext == context) {
                        for (const tok of example.querySelectorAll(".token")) {
                            if (c.dataset.binding == tok.dataset.binding) {
                                tok.classList.add("binding-hl");
                            }
                        }
                    }
                }
            });
        }
        c.addEventListener("mouseout", (event) => {
            for (const tok of document.querySelectorAll(".hl.lean .token")) {
                tok.classList.remove("binding-hl");
            }
        });
    }
    /* Render docstrings */
    if ('undefined' !== typeof marked) {
        for (const d of document.querySelectorAll("code.docstring, pre.docstring")) {
            const str = d.innerText;
            const html = marked.parse(str);
            const rendered = document.createElement("div");
            rendered.classList.add("docstring");
            rendered.innerHTML = html;
            d.parentNode.replaceChild(rendered, d);
        }
    }
    // Add hovers
    let siteRoot = typeof __versoSiteRoot !== 'undefined' ? __versoSiteRoot : "/";
    fetch(siteRoot + "-verso-docs.json").then((resp) => resp.json()).then((versoDocData) => {

      const defaultTippyProps = {
        /* DEBUG -- remove the space: * /
        onHide(any) { return false; },
        trigger: "click",
        // */
        theme: "lean",
        maxWidth: "none",
        appendTo: () => document.body,
        interactive: true,
        delay: [100, null],
        ignoreAttributes: true,
        onShow(inst) {
          if (inst.reference.querySelector(".hover-info") || "versoHover" in inst.reference.dataset) {
            if (blockedByTactic(inst.reference)) { return false };
            if (blockedByTippy(inst.reference)) { return false; }
          } else { // Nothing to show here!
            return false;
          }
        },
        content (tgt) {
          const content = document.createElement("span");
          content.className = "hl lean";
          content.style.display = "block";
          content.style.maxHeight = "300px";
          content.style.overflowY = "auto";
          content.style.overflowX = "hidden";
          const hoverId = tgt.dataset.versoHover;
          const hoverInfo = tgt.querySelector(".hover-info");
          if (hoverId) { // Docstrings from the table
            // TODO stop doing an implicit conversion from string to number here
            let data = versoDocData[hoverId];
            if (data) {
              const info = document.createElement("span");
              info.className = "hover-info";
              info.style.display = "block";
              info.innerHTML = data;
              content.appendChild(info);
              /* Render docstrings - TODO server-side */
              if ('undefined' !== typeof marked) {
                  for (const d of content.querySelectorAll("code.docstring, pre.docstring")) {
                      const str = d.innerText;
                      const html = marked.parse(str);
                      const rendered = document.createElement("div");
                      rendered.classList.add("docstring");
                      rendered.innerHTML = html;
                      d.parentNode.replaceChild(rendered, d);
                  }
              }
            } else {
              content.innerHTML = "Failed to load doc ID: " + hoverId;
            }
          } else if (hoverInfo) { // The inline info, still used for compiler messages
            content.appendChild(hoverInfo.cloneNode(true));
          }
          return content;
        }
      };

      const addTippy = (selector, props) => {
        tippy(selector, Object.assign({}, defaultTippyProps, props));
      };
      addTippy('.hl.lean .const.token, .hl.lean .keyword.token, .hl.lean .literal.token, .hl.lean .option.token, .hl.lean .var.token, .hl.lean .typed.token', {theme: 'lean'});
      addTippy('.hl.lean .has-info.warning', {theme: 'warning message'});
      addTippy('.hl.lean .has-info.info', {theme: 'info message'});
      addTippy('.hl.lean .has-info.error', {theme: 'error message'});

      tippy('.hl.lean .tactic', {
        allowHtml: true,
        /* DEBUG -- remove the space: * /
        onHide(any) { return false; },
        trigger: "click",
        // */
        maxWidth: "none",
        onShow(inst) {
          const toggle = inst.reference.querySelector("input.tactic-toggle");
          if (toggle && toggle.checked) {
            return false;
          }
          if (blockedByTippy(inst.reference)) { return false; }
        },
        theme: "tactic",
        placement: 'bottom-start',
        content (tgt) {
          const content = document.createElement("span");
          const state = tgt.querySelector(".tactic-state").cloneNode(true);
          state.style.display = "block";
          content.appendChild(state);
          content.style.display = "block";
          content.className = "hl lean popup";
          return content;
        }
      });
  });
}
</script>
    </head>
  <body>
    <label for="toggle-toc" id="toggle-toc-click"><span class="line line1"></span><span class="line line2"></span><span class="line line3"></span></label><div class="with-toc">
      <div class="toc-backdrop" onclick="document.getElementById('toggle-toc-click')?.click()"></div>
      <nav id="toc">
        <input type="checkbox" id="toggle-toc" checked="checked"><div class="first">
          <a href="../../" id="logo"><img src="../../static/lean_logo.svg"></a><nav id="local-buttons">
            <a class="local-button active" href="../Harmonic-Oscillator/#Scientific-Computing-in-Lean--Examples--Harmonic-Oscillator" rel="prev" title="4.1. Harmonic Oscillator"><span class="arrow">←</span><span class="where">Prev</span></a><a class="local-button active" href="../#Scientific-Computing-in-Lean--Examples" title="4. Examples"><span class="arrow">↑</span><span class="where">Up</span></a><span class="local-button inactive"><span class="where">Next</span><span class="arrow">→</span></span></nav>
          <div class="split-tocs">
            <div class="split-toc book">
              <div class="title">
                <label for="--verso-manual-toc-----bookRoot" class="toggle-split-toc"><input type="checkbox" class="toggle-split-toc" id="--verso-manual-toc-----bookRoot"></label><span class=""><a href="../../">Scientific Computing in Lean</a></span></div>
              <table><tr class="numbered"><td class="num">1.</td><td><a href="../../Working-with-Arrays/#Scientific-Computing-in-Lean--Working-with-Arrays">Working with Arrays</a></td></tr><tr class="numbered"><td class="num">2.</td><td><a href="../../Differentiation/#Scientific-Computing-in-Lean--Differentiation">Differentiation</a></td></tr><tr class="numbered"><td class="num">3.</td><td><a href="../../Miscellaneous/#Scientific-Computing-in-Lean--Miscellaneous">Miscellaneous</a></td></tr><tr class="current numbered"><td class="num">4.</td><td><a href="../#Scientific-Computing-in-Lean--Examples">Examples</a></td></tr></table></div>
            <div class="split-toc">
              <div class="title">
                <label for="--verso-manual-toc-Scientific-Computing-in-Lean--Examples" class="toggle-split-toc"><input type="checkbox" class="toggle-split-toc" id="--verso-manual-toc-Scientific-Computing-in-Lean--Examples"></label><span class="number">4.</span> <span class=""><a href="../#Scientific-Computing-in-Lean--Examples">Examples</a></span></div>
              <table><tr class="numbered"><td class="num">4.1.</td><td><a href="../Harmonic-Oscillator/#Scientific-Computing-in-Lean--Examples--Harmonic-Oscillator">Harmonic Oscillator</a></td></tr><tr class="current numbered"><td class="num">4.2.</td><td><a href="#Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization">🚧 Harmonic Oscillator Optimization</a></td></tr></table></div>
            <div class="split-toc">
              <div class="title">
                <label for="--verso-manual-toc-Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization" class="toggle-split-toc"><input type="checkbox" class="toggle-split-toc" id="--verso-manual-toc-Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization" checked="checked"></label><span class="number">4.2.</span> <span class="current"><a href="#Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization">🚧 Harmonic Oscillator Optimization</a></span></div>
              <table><tr class="numbered"><td class="num">4.2.1.</td><td><a href="#Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization--Problem-Statement">Problem Statement</a></td></tr><tr class="numbered"><td class="num">4.2.2.</td><td><a href="#Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization--Lean-Specification">Lean Specification</a></td></tr><tr class="numbered"><td class="num">4.2.3.</td><td><a href="#Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization--Turning-Specification-into-Implementation">Turning Specification into Implementation</a></td></tr></table></div>
            </div>
          </div>
        <div class="last"></div>
        </nav>
      <main><section>
          <h1>
            4.2. 🚧 Harmonic Oscillator Optimization</h1>
          <section>
            <h2 id="Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization--Problem-Statement">
              4.2.1. Problem Statement</h2>
            <p>
              In this example, we will demonstrate how to find a parameter of differential equation such that the solution satisfies particular property. Consider this practical problem. We are designing a new musical instrument, we have already decided on its particular shape. We want to hit a particular note and we will do that by finding the right material. To do this we model the musical instrument with harmonic oscillator and we will find the right stifness value that gives us solution with desired frequency.</p>
            <p>
              Of course that in reality we would optimize for the shape rather than for the material but this would yield much harder mathematical problem. Therefore we do it the other way around which is much easier, serves as demonstration on how to use SciLean and we can easily check the numrical answer to the analytical solution.</p>
            <p>
              The harmonic oscillator is governed by the following differential equation</p>
            <p>
              $$m \ddot x = - k x
$$</p>
            <p>
              because we will try to find the appropricate <code>k</code> we will denote \(x(k,t)\) the solution of this equation as a function of time \(t\) and stiffness \(k\).</p>
            <p>
              How can we express the requirement that the solution should hit a particular frequencty \(omega\)? One way to state this requirement is that the solution should return to the same position after time \(T\). We want to find stiffness \(k\) such that</p>
            <p>
              $$x(k,T) = x(k,0)
$$</p>
            <p>
              where the time \(T\) is related to the given frequency by</p>
            <p>
              $$T = \frac{2 \pi}{\omega}
$$</p>
            <p>
              (You might have noticed that this argument contains a flaw which we kindly ask you to ignore for the moment as we will discuss it at the end.)</p>
            </section>
          <section>
            <h2 id="Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization--Lean-Specification">
              4.2.2. Lean Specification</h2>
            <p>
              Lets formulate this in Lean now. In the previous example 'Harmonic Oscillator' we have shows how to specify harmonic oscillator using its energy</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-2457">def</span> <span class="const token" data-binding="const-HarOscOpt.H" data-verso-hover="617" id="HarOscOpt___H">H</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">x</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">p</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">(</span><span class="typed token" data-binding="" data-verso-hover="47">1</span><span class="unknown token" data-binding="">/</span><span class="unknown token" data-binding="">(</span><span class="typed token" data-binding="" data-verso-hover="47">2</span><span class="unknown token" data-binding="">*</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">*</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">p</span><span class="unknown token" data-binding="">^</span><span class="typed token" data-binding="" data-verso-hover="2">2</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">k</span><span class="unknown token" data-binding="">/</span><span class="typed token" data-binding="" data-verso-hover="47">2</span> <span class="unknown token" data-binding="">*</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">x</span><span class="unknown token" data-binding="">^</span><span class="typed token" data-binding="" data-verso-hover="2">2</span>
<span class="unknown token" data-binding=""></span></code><p>
              The solution of the corresponding differential equation is symbolically represented using the function <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span></code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.noncomputable-2644">noncomputable</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-2658">def</span> <span class="const token" data-binding="const-HarOscOpt.solution" data-verso-hover="618" id="HarOscOpt___solution">solution</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">p₀</span> <span class="var token" data-binding="var-_uniq.10" data-verso-hover="47">t</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">×</span><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="unknown token" data-binding="">:=</span>
  <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t₀</span> <span class="unknown token" data-binding="">:=</span> <span class="typed token" data-binding="" data-verso-hover="47">0</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">x₀</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">p₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t</span> <span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.10" data-verso-hover="47">t</span><span class="unknown token" data-binding="">)</span>
    <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-2774">fun</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.195" data-verso-hover="47">t</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.223" data-verso-hover="47">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.224" data-verso-hover="47">p</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span>
        <span class="unknown token" data-binding="">(</span> <span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.233" data-verso-hover="47">p'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.224" data-verso-hover="47">p</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <a href="#HarOscOpt___H"><span class="const token" data-binding="const-HarOscOpt.H" data-verso-hover="617">H</span></a> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.223" data-verso-hover="47">x</span>  <span class="var token" data-binding="var-_uniq.233" data-verso-hover="47">p'</span><span class="unknown token" data-binding="">,</span>
         <span class="unknown token" data-binding="">-</span><span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.654" data-verso-hover="47">x'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.223" data-verso-hover="47">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <a href="#HarOscOpt___H"><span class="const token" data-binding="const-HarOscOpt.H" data-verso-hover="617">H</span></a> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.654" data-verso-hover="47">x'</span> <span class="var token" data-binding="var-_uniq.224" data-verso-hover="47">p</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><p>
              The expression <code>solution m k x₀ p₀ t</code> is the position and momentum at time <code>t</code> of harmonic oscillator with mass <code>m</code>, stiffness <code>k</code> starting at time <code>0</code> at position <code>x₀</code> and momentum <code>p₀</code>.</p>
            <p>
              Notice that we had to mark the function <code class="hl lean inline" data-lean-context="examples"><a href="#HarOscOpt___solution"><span class="const token" data-binding="const-HarOscOpt.solution" data-verso-hover="618">solution</span></a></code> with <code>noncomputable</code> as it is purely symbolic as it can't be executed because it uses the function <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span></code>.</p>
            <p>
              To express that we are looking for the stiffness satisfying a particular property we can use the notation <code>solve x, f x = 0</code> which will symbolically return the solution <code>x</code> of the equation <code>f x = 0</code>.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.noncomputable-3455">noncomputable</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-3469">def</span> <span class="const token" data-binding="const-HarOscOpt.optimalStiffness" data-verso-hover="619" id="HarOscOpt___optimalStiffness">optimalStiffness</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="unknown token" data-binding="">:=</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-3523" data-verso-hover="81">let</span> <span class="var token" data-binding="var-_uniq.41" data-verso-hover="620">x</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-3532">fun</span> <span class="var token" data-binding="var-_uniq.16" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.19" data-verso-hover="47">t</span> <span class="unknown token" data-binding="">=&gt;</span>
    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-3547" data-verso-hover="81">let</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.548" data-verso-hover="47">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.549" data-verso-hover="47">p</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <a href="#HarOscOpt___solution"><span class="const token" data-binding="const-HarOscOpt.solution" data-verso-hover="618">solution</span></a> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.16" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span> <span class="typed token" data-binding="" data-verso-hover="47">0</span> <span class="var token" data-binding="var-_uniq.19" data-verso-hover="47">t</span>
    <span class="var token" data-binding="var-_uniq.548" data-verso-hover="47">x</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-3590" data-verso-hover="81">let</span> <span class="var token" data-binding="var-_uniq.447" data-verso-hover="47">T</span> <span class="unknown token" data-binding="">:=</span> <span class="typed token" data-binding="" data-verso-hover="47">2</span><span class="unknown token" data-binding="">*</span><span class="unknown token" data-binding="">π</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>
  <span class="keyword token" data-binding="kw-occ-SciLean.«termSolve_,_»-3609" data-verso-hover="621">solve</span> <span class="var token" data-binding="var-_uniq.450" data-verso-hover="47">k</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.41" data-verso-hover="620">x</span> <span class="var token" data-binding="var-_uniq.450" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.447" data-verso-hover="47">T</span> <span class="unknown token" data-binding="">=</span> <span class="var token" data-binding="var-_uniq.41" data-verso-hover="620">x</span> <span class="var token" data-binding="var-_uniq.450" data-verso-hover="47">k</span> <span class="typed token" data-binding="" data-verso-hover="47">0</span>
<span class="unknown token" data-binding=""></span></code><p>
              The notation <code>solve x, f x = 0</code> uses the noncomputable function <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-SciLean.solveFun" data-verso-hover="622">solveFun</span></code> which returns a term that satisfies a particular property. This is why we have to mark <code class="hl lean inline" data-lean-context="examples"><a href="#HarOscOpt___optimalStiffness"><span class="const token" data-binding="const-HarOscOpt.optimalStiffness" data-verso-hover="619">optimalStiffness</span></a></code> as noncomputable.</p>
            <p>
              Our goal is to have an executable function that can approximatelly compute the symbolic function <code class="hl lean inline" data-lean-context="examples"><a href="#HarOscOpt___optimalStiffness"><span class="const token" data-binding="const-HarOscOpt.optimalStiffness" data-verso-hover="619">optimalStiffness</span></a></code>.</p>
            <p>
              We can therefore define function <code>findStiffness</code> that is an approximation to the specification. In the next section we will show how replace <code>skip</code> with a sequence of tactics that will turn the specification into executable approximation and allows us to remove the <code>noncomputable</code> annotation from this fuction.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.noncomputable-4306">noncomputable</span>
<span class="keyword token" data-binding="kw-occ-SciLean.«command_Approx__:_:=_By_»-4306">approx</span> <span class="const token" data-binding="const-HarOscOpt.findStiffness" data-verso-hover="623">findStiffness</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-4366" data-verso-hover="81">let</span> <span class="unknown token" data-binding="">T</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">*</span><span class="unknown token" data-binding="">π</span><span class="unknown token" data-binding="">/</span><span class="unknown token" data-binding="">ω</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-4385" data-verso-hover="81">let</span> <span class="unknown token" data-binding="">y</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-4394">fun</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">k</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span>
    <span class="unknown token" data-binding="">odeSolve</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t₀</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">T</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
      <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-4469">fun</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">p</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span>
        <span class="unknown token" data-binding="">(</span> <span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">p'</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">p</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">H</span> <span class="unknown token" data-binding="">m</span> <span class="unknown token" data-binding="">k</span> <span class="unknown token" data-binding="">x</span>  <span class="unknown token" data-binding="">p'</span><span class="unknown token" data-binding="">,</span>
         <span class="unknown token" data-binding="">-</span><span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x'</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">H</span> <span class="unknown token" data-binding="">m</span> <span class="unknown token" data-binding="">k</span> <span class="unknown token" data-binding="">x'</span> <span class="unknown token" data-binding="">p</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
  <span class="keyword token" data-binding="kw-occ-SciLean.«termSolve_,_»-4568" data-verso-hover="621">solve</span> <span class="unknown token" data-binding="">k</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">y</span> <span class="unknown token" data-binding="">k</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">.</span><span class="unknown token" data-binding="">1</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">x₀</span>
<span class="keyword token" data-binding="kw-occ-SciLean.«command_Approx__:_:=_By_»-4306">by</span>
  <span class="tactic"><label for="tactic-state-17492254242007557298-4597-4601"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.skip-4597" data-verso-hover="624">skip</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-17492254242007557298-4597-4601"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-SciLean.Approx" data-verso-hover="599">Approx</span> (?m.2380 <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>)
  (<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.2481" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.2571" data-verso-hover="625">y</span> := <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.2484" data-verso-hover="47">k</span> =&gt;
    <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
      (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.2508" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.2510" data-verso-hover="602">x</span> =&gt;
        <span class="keyword token" data-binding="">match</span> <span class="var token" data-binding="var-_uniq.2510" data-verso-hover="602">x</span> <span class="keyword token" data-binding="">with</span>
        | (<span class="var token" data-binding="var-_uniq.2560" data-verso-hover="47">x</span>, <span class="var token" data-binding="var-_uniq.2561" data-verso-hover="47">p</span>) =&gt; (∇ (<span class="var token" data-binding="var-_uniq.2534" data-verso-hover="47">p'</span>:=<span class="var token" data-binding="var-_uniq.2514" data-verso-hover="47">p</span>), <a href="#HarOscOpt___H"><span class="const token" data-binding="const-HarOscOpt.H" data-verso-hover="617">H</span></a> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.2484" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.2513" data-verso-hover="47">x</span> <span class="var token" data-binding="var-_uniq.2534" data-verso-hover="47">p'</span>, <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>∇ (<span class="var token" data-binding="var-_uniq.2552" data-verso-hover="47">x'</span>:=<span class="var token" data-binding="var-_uniq.2513" data-verso-hover="47">x</span>), <a href="#HarOscOpt___H"><span class="const token" data-binding="const-HarOscOpt.H" data-verso-hover="617">H</span></a> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.2484" data-verso-hover="47">k</span> <span class="var token" data-binding="var-_uniq.2552" data-verso-hover="47">x'</span> <span class="var token" data-binding="var-_uniq.2514" data-verso-hover="47">p</span>))
      0 <span class="var token" data-binding="var-_uniq.2481" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
  solve <span class="var token" data-binding="var-_uniq.2582" data-verso-hover="47">k</span>, (<span class="var token" data-binding="var-_uniq.2571" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.2582" data-verso-hover="47">k</span>).1<span class="const token" data-binding="const-Eq" data-verso-hover="69"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>)</span></span></span></span></span>
<span class="unknown token" data-binding=""></span></code></section>
          <section>
            <h2 id="Scientific-Computing-in-Lean--Examples--___-Harmonic-Oscillator-Optimization--Turning-Specification-into-Implementation">
              4.2.3. Turning Specification into Implementation</h2>
            <p>
              Unfortunatelly the current documentation tool we are using does not allow mixing a proof with text so we have to write down everything with only brief comments and only then we will go over each tactic and explain what it does.</p>
            <p>
              The are two little differences in the initial specification that are mainly of technical nature. First, we had to add the function <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span></code> which is just an identity function and should be ignored. Its purpose is to prevent inlining of <code>y</code> by the tactic <code>autodiff</code>. The se</p>
            <p>
              Please go ahead and have a brief look at every step. The short comments should give you rought idea what each tactic is doing and by clicking on each command will display the current state.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.«command_Approx__:_:=_By_»-5362">approx</span> <span class="const token" data-binding="const-HarOscOpt.findStiffness" data-verso-hover="627">findStiffness</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-5413" data-verso-hover="81">let</span> <span class="unknown token" data-binding="">T</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">*</span><span class="unknown token" data-binding="">π</span><span class="unknown token" data-binding="">/</span><span class="unknown token" data-binding="">ω</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-5432" data-verso-hover="81">let</span> <span class="unknown token" data-binding="">y</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">holdLet</span> <span class="unknown token" data-binding="">&lt;|</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-5452">fun</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">k</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span>
    <span class="unknown token" data-binding="">odeSolve</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t₀</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">T</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
      <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-5527">fun</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">t</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">p</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span>
        <span class="unknown token" data-binding="">(</span> <span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">p'</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">p</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">H</span> <span class="unknown token" data-binding="">m</span> <span class="unknown token" data-binding="">k</span> <span class="unknown token" data-binding="">x</span>  <span class="unknown token" data-binding="">p'</span><span class="unknown token" data-binding="">,</span>
         <span class="unknown token" data-binding="">-</span><span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x'</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">H</span> <span class="unknown token" data-binding="">m</span> <span class="unknown token" data-binding="">k</span> <span class="unknown token" data-binding="">x'</span> <span class="unknown token" data-binding="">p</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
  <span class="keyword token" data-binding="kw-occ-SciLean.«termSolve_,_»-5626" data-verso-hover="621">solve</span> <span class="unknown token" data-binding="">k</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">y</span> <span class="unknown token" data-binding="">k</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">.</span><span class="unknown token" data-binding="">1</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">x₀</span>
<span class="keyword token" data-binding="kw-occ-SciLean.«command_Approx__:_:=_By_»-5362">by</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.conv-5655" data-verso-hover="628">conv</span> <span class="unknown token" data-binding="">=&gt;</span>
    -- focus on the specification
    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.enter-5701" data-verso-hover="629">enter</span><span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">]</span>

    -- Unfold Hamiltonian and compute gradients
    <span class="tactic"><label for="tactic-state-7714156229434660640-5763-5771"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.unfold-5763" data-verso-hover="258">unfold</span> <a href="#HarOscOpt___H"><span class="const token" data-binding="const-HarOscOpt.H" data-verso-hover="617">H</span></a></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7714156229434660640-5763-5771"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118070" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118267" data-verso-hover="625">y</span> :=
  <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span> =&gt;
    <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
      (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118102" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118104" data-verso-hover="602">x</span> =&gt;
        <span class="keyword token" data-binding="">match</span> <span class="var token" data-binding="var-_uniq.118104" data-verso-hover="602">x</span> <span class="keyword token" data-binding="">with</span>
        | (<span class="var token" data-binding="var-_uniq.118256" data-verso-hover="47">x</span>, <span class="var token" data-binding="var-_uniq.118257" data-verso-hover="47">p</span>) =&gt;
          (∇ (<span class="var token" data-binding="var-_uniq.118129" data-verso-hover="47">p'</span>:=<span class="var token" data-binding="var-_uniq.118108" data-verso-hover="47">p</span>), (1<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118129" data-verso-hover="47">p'</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="143"> + </span><span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118107" data-verso-hover="47">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>∇ (<span class="var token" data-binding="var-_uniq.118204" data-verso-hover="47">x'</span>:=<span class="var token" data-binding="var-_uniq.118107" data-verso-hover="47">x</span>), (1<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118108" data-verso-hover="47">p</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="143"> + </span><span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118204" data-verso-hover="47">x'</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2)))
      0 <span class="var token" data-binding="var-_uniq.118070" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
solve <span class="var token" data-binding="var-_uniq.118278" data-verso-hover="47">k</span>, (<span class="var token" data-binding="var-_uniq.118267" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118278" data-verso-hover="47">k</span>).1<span class="const token" data-binding="const-Eq" data-verso-hover="69"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span></span></span></span></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7566295132704216721-5773-5781"><span class="keyword token" data-binding="kw-occ-SciLean.Tactic.lautodiffConvStx-5773">autodiff</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7566295132704216721-5773-5781"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118070" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118162" data-verso-hover="625">y</span> :=
  <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span> =&gt;
    <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
      (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118100" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118101" data-verso-hover="602">x</span> =&gt;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118114" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118115" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118101" data-verso-hover="602">x</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118122" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118123" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118101" data-verso-hover="602">x</span>.1;
        (<span class="var token" data-binding="var-_uniq.118114" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118115" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118122" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118123" data-verso-hover="47">ydf_3</span>))))
      0 <span class="var token" data-binding="var-_uniq.118070" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
solve <span class="var token" data-binding="var-_uniq.118173" data-verso-hover="47">k</span>, (<span class="var token" data-binding="var-_uniq.118162" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118173" data-verso-hover="47">k</span>).1<span class="const token" data-binding="const-Eq" data-verso-hover="69"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span></span></span></span></span>

    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.convConvSeq-5787" data-verso-hover="630">conv</span> <span class="unknown token" data-binding="">=&gt;</span>
      -- focus on solve k, (y k).1 = x₀
      <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.enter-5843" data-verso-hover="629">enter</span><span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">T</span><span class="unknown token" data-binding="">,</span><span class="tactic"><label for="tactic-state-15660498593838404415-5851-5852"><span class="unknown token" data-binding="">y</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-15660498593838404415-5851-5852"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.24468" data-verso-hover="47">T</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="const token" data-binding="const-Prod" data-verso-hover="68"> × </span><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">| </span><span class="type">solve <span class="var token" data-binding="var-_uniq.118050" data-verso-hover="47">k</span>, (<span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118050" data-verso-hover="47">k</span>).1<span class="const token" data-binding="const-Eq" data-verso-hover="69"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span></span></span></span></span><span class="unknown token" data-binding="">]</span>

      -- reformulate as minimization problem
      <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.convRw__-5906" data-verso-hover="631">rw</span><span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-SciLean.solve_eq_argmin_norm2" data-verso-hover="632">solve_eq_argmin_norm2</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="unknown token" data-binding="">(</span><span class="tactic"><label for="tactic-state-12245735956164975575-5938-5940"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-5938" data-verso-hover="67">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-12245735956164975575-5938-5940"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.24468" data-verso-hover="47">T</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="const token" data-binding="const-Prod" data-verso-hover="68"> × </span><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-SciLean.HasUniqueSolution" data-verso-hover="633">HasUniqueSolution</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118044" data-verso-hover="47">x</span> =&gt; (<span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118044" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-Eq" data-verso-hover="69"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span></span></span></span></span> <span class="tactic"><label for="tactic-state-7-5941-5952"><span class="keyword token" data-binding="kw-occ-SciLean.tacticSorry_proof-5941" data-verso-hover="375">sorry_proof</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-5941-5952"><span class="tactic-state">All goals completed! 🐙</span></span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">]</span>

      -- approximate by gradient descrent
      <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.convRw__-6004" data-verso-hover="631">rw</span><span class="unknown token" data-binding="">[</span><span class="tactic"><label for="tactic-state-18370086937398583423-6007-6115"><span class="const token" data-binding="const-SciLean.argmin_eq_limit_optimize" data-verso-hover="634">argmin_eq_limit_optimize</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">R</span><span class="unknown token" data-binding="">:=</span><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="unknown token" data-binding="">)</span>
          <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span> <span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span><span class="unknown token" data-binding="">)</span>
          <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">method</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-SciLean.Optimjl.LBFGS" data-verso-hover="635">LBFGS</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="typed token" data-binding="" data-verso-hover="2">1</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-18370086937398583423-6007-6115"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.24468" data-verso-hover="47">T</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span><span class="const token" data-binding="const-Prod" data-verso-hover="68"> × </span><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">| </span><span class="type">limit <span class="var token" data-binding="var-_uniq.118058" data-verso-hover="636">opts</span> ∈ <span class="const token" data-binding="const-SciLean.Options.filter" data-verso-hover="637">Options.filter</span>,
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118098" data-verso-hover="638">f'</span> := <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> (&lt;∂ <span class="var token" data-binding="var-_uniq.118077" data-verso-hover="47">x</span>, ‖(<span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118077" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²);
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118159" data-verso-hover="639">r</span> :=
    <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118122" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.24485" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118122" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.118058" data-verso-hover="636">opts</span>) <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
  <span class="var token" data-binding="var-_uniq.118159" data-verso-hover="639">r</span>.minimizer</span></span></span></span></span><span class="unknown token" data-binding="">]</span>

  -- consume limit by `Approx`
  <span class="keyword token" data-binding="kw-occ-SciLean.approx_limit_tactic-6151" data-verso-hover="608">approx_limit</span> <span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span> <span class="unknown token" data-binding="">(</span><span class="tactic"><label for="tactic-state-18142506010211222482-6170-6172"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-6170" data-verso-hover="67">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-18142506010211222482-6170-6172"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118070" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118162" data-verso-hover="625">y</span> :=
    <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span> =&gt;
      <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
        (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118100" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118101" data-verso-hover="602">x</span> =&gt;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118114" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118115" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118101" data-verso-hover="602">x</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118122" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118078" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118123" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118101" data-verso-hover="602">x</span>.1;
          (<span class="var token" data-binding="var-_uniq.118114" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118115" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118122" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118123" data-verso-hover="47">ydf_3</span>))))
        0 <span class="var token" data-binding="var-_uniq.118070" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
  limit <span class="var token" data-binding="var-_uniq.118181" data-verso-hover="636">opts</span> ∈ <span class="const token" data-binding="const-SciLean.Options.filter" data-verso-hover="637">Options.filter</span>,
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118219" data-verso-hover="638">f'</span> := <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> (&lt;∂ <span class="var token" data-binding="var-_uniq.118198" data-verso-hover="47">x</span>, ‖(<span class="var token" data-binding="var-_uniq.118162" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118198" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118280" data-verso-hover="639">r</span> :=
      <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118243" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118162" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118243" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.118181" data-verso-hover="636">opts</span>)
        <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
    <span class="var token" data-binding="var-_uniq.118280" data-verso-hover="639">r</span>.minimizer)<span class="const token" data-binding="const-Eq" data-verso-hover="69"> =
  </span>limit <span class="var token" data-binding="var-_uniq.118296" data-verso-hover="636">opts</span> ∈ <span class="const token" data-binding="const-SciLean.Options.filter" data-verso-hover="637">Options.filter</span>,
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118315" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118390" data-verso-hover="625">y</span> :=
      <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118323" data-verso-hover="47">k</span> =&gt;
        <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
          (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118334" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118335" data-verso-hover="602">x</span> =&gt;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118345" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118346" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118335" data-verso-hover="602">x</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118353" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118323" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118354" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118335" data-verso-hover="602">x</span>.1;
            (<span class="var token" data-binding="var-_uniq.118345" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118346" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118353" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118354" data-verso-hover="47">ydf_3</span>))))
          0 <span class="var token" data-binding="var-_uniq.118315" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118418" data-verso-hover="638">f'</span> := <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> (&lt;∂ <span class="var token" data-binding="var-_uniq.118407" data-verso-hover="47">x</span>, ‖(<span class="var token" data-binding="var-_uniq.118390" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118407" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118466" data-verso-hover="639">r</span> :=
      <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118442" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118390" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118442" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.118296" data-verso-hover="636">opts</span>)
        <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
    <span class="var token" data-binding="var-_uniq.118466" data-verso-hover="639">r</span>.minimizer</span></span></span></span></span> <span class="tactic"><label for="tactic-state-7-6173-6184"><span class="keyword token" data-binding="kw-occ-SciLean.tacticSorry_proof-6173" data-verso-hover="375">sorry_proof</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-6173-6184"><span class="tactic-state">All goals completed! 🐙</span></span><span class="unknown token" data-binding="">)</span>

  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.conv-6189" data-verso-hover="628">conv</span> <span class="unknown token" data-binding="">=&gt;</span>
    -- focus on the specification again
    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.enter-6241" data-verso-hover="629">enter</span><span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">]</span>

    -- rewrite reverse mode AD (&lt;∂) as forward mode AD (∂&gt;)
    -- this is possible because we are differentiating scalar function `Float → Float`
    <span class="tactic"><label for="tactic-state-18278104206962264520-6408-6448"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.simp-6408" data-verso-hover="221">simp</span> <span class="unknown token" data-binding="">-</span><span class="const token" data-binding="const-Lean.Meta.Simp.Config.zeta" data-verso-hover="604">zeta</span> <span class="keyword token" data-binding="kw-occ-null-6419">only</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-revFDeriv_eq_fwdFDeriv" data-verso-hover="643">revFDeriv_eq_fwdFDeriv</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-18278104206962264520-6408-6448"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-SciLean.Optimjl.Options" data-verso-hover="644">Options</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118166" data-verso-hover="625">y</span> :=
  <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118082" data-verso-hover="47">k</span> =&gt;
    <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
      (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118104" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118105" data-verso-hover="602">x</span> =&gt;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118118" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118119" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118105" data-verso-hover="602">x</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118126" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118082" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118127" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118105" data-verso-hover="602">x</span>.1;
        (<span class="var token" data-binding="var-_uniq.118118" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118119" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118126" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118127" data-verso-hover="47">ydf_3</span>))))
      0 <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118221" data-verso-hover="638">f'</span> :=
  <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118172" data-verso-hover="47">x</span> =&gt;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118206" data-verso-hover="602">x</span> := ∂&gt; (<span class="var token" data-binding="var-_uniq.118185" data-verso-hover="47">x</span>:=<span class="var token" data-binding="var-_uniq.118172" data-verso-hover="47">x</span>;1), ‖(<span class="var token" data-binding="var-_uniq.118166" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118185" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118207" data-verso-hover="47">y</span> := <span class="var token" data-binding="var-_uniq.118206" data-verso-hover="602">x</span>.1;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118208" data-verso-hover="47">dy</span> := <span class="var token" data-binding="var-_uniq.118206" data-verso-hover="602">x</span>.2;
    (<span class="var token" data-binding="var-_uniq.118207" data-verso-hover="47">y</span>, <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118214" data-verso-hover="47">dy'</span> =&gt; <span class="var token" data-binding="var-_uniq.118208" data-verso-hover="47">dy</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118214" data-verso-hover="47">dy'</span>);
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118282" data-verso-hover="639">r</span> :=
  <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118245" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118166" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118245" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span>) <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
<span class="var token" data-binding="var-_uniq.118282" data-verso-hover="639">r</span>.minimizer</span></span></span></span></span>

    -- run forward mode AD
    -- this will formulate a new ODE that solves for `x`, `p`, `dx/dk` and `dp/dk`
    <span class="tactic"><label for="tactic-state-9063962851360370421-6564-6572"><span class="keyword token" data-binding="kw-occ-SciLean.Tactic.lautodiffConvStx-6564">autodiff</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-9063962851360370421-6564-6572"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-SciLean.Optimjl.Options" data-verso-hover="644">Options</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118166" data-verso-hover="625">y</span> :=
  <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118082" data-verso-hover="47">k</span> =&gt;
    <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span>
      (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118104" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118105" data-verso-hover="602">x</span> =&gt;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118118" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118119" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118105" data-verso-hover="602">x</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118126" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118082" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118127" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118105" data-verso-hover="602">x</span>.1;
        (<span class="var token" data-binding="var-_uniq.118118" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118119" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118126" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118127" data-verso-hover="47">ydf_3</span>))))
      0 <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118379" data-verso-hover="638">f'</span> :=
  <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118172" data-verso-hover="47">x</span> =&gt;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118182" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118301" data-verso-hover="645">F</span> :=
      <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118188" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118189" data-verso-hover="646">xdx</span> =&gt;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118190" data-verso-hover="602">x_1</span> := <span class="var token" data-binding="var-_uniq.118189" data-verso-hover="646">xdx</span>.1;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118191" data-verso-hover="602">dx</span> := <span class="var token" data-binding="var-_uniq.118189" data-verso-hover="646">xdx</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118192" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118190" data-verso-hover="602">x_1</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118193" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118191" data-verso-hover="602">dx</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118200" data-verso-hover="47">zdz_2</span> := <span class="var token" data-binding="var-_uniq.118172" data-verso-hover="47">x</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118204" data-verso-hover="47">zdz_3</span> := 2<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118205" data-verso-hover="47">zdz_4</span> := <span class="var token" data-binding="var-_uniq.118190" data-verso-hover="602">x_1</span>.1;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118206" data-verso-hover="47">zdz_5</span> := <span class="var token" data-binding="var-_uniq.118191" data-verso-hover="602">dx</span>.1;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118213" data-verso-hover="47">zdz</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118192" data-verso-hover="47">zdz</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118220" data-verso-hover="47">zdz_6</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118193" data-verso-hover="47">zdz_1</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118227" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118182" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118213" data-verso-hover="47">zdz</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118234" data-verso-hover="47">zdz_7</span> := <span class="var token" data-binding="var-_uniq.118182" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118220" data-verso-hover="47">zdz_6</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118241" data-verso-hover="47">zdz_8</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118205" data-verso-hover="47">zdz_4</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118248" data-verso-hover="47">zdz_9</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118206" data-verso-hover="47">zdz_5</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118255" data-verso-hover="47">zdz_10</span> := <span class="var token" data-binding="var-_uniq.118200" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118241" data-verso-hover="47">zdz_8</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118280" data-verso-hover="47">zdz_11</span> := <span class="var token" data-binding="var-_uniq.118200" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118248" data-verso-hover="47">zdz_9</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="143"> + </span><span class="var token" data-binding="var-_uniq.118204" data-verso-hover="47">zdz_3</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118241" data-verso-hover="47">zdz_8</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118284" data-verso-hover="47">zdz_12</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118255" data-verso-hover="47">zdz_10</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118288" data-verso-hover="47">zdz_13</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118280" data-verso-hover="47">zdz_11</span>;
        ((<span class="var token" data-binding="var-_uniq.118227" data-verso-hover="47">zdz</span>, <span class="var token" data-binding="var-_uniq.118284" data-verso-hover="47">zdz_12</span>), <span class="var token" data-binding="var-_uniq.118234" data-verso-hover="47">zdz_7</span>, <span class="var token" data-binding="var-_uniq.118288" data-verso-hover="47">zdz_13</span>);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118319" data-verso-hover="646">xdx</span> := <span class="const token" data-binding="const-SciLean.odeSolve" data-verso-hover="597">odeSolve</span> <span class="var token" data-binding="var-_uniq.118301" data-verso-hover="645">F</span> 0 <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> ((<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0), 0);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118320" data-verso-hover="602">y</span> := <span class="var token" data-binding="var-_uniq.118319" data-verso-hover="646">xdx</span>.1;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118321" data-verso-hover="602">dy</span> := <span class="var token" data-binding="var-_uniq.118319" data-verso-hover="646">xdx</span>.2;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118322" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118320" data-verso-hover="602">y</span>.1;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118323" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118321" data-verso-hover="602">dy</span>.1;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118336" data-verso-hover="47">ydy</span> := <span class="var token" data-binding="var-_uniq.118322" data-verso-hover="47">zdz</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118349" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118336" data-verso-hover="47">ydy</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118366" data-verso-hover="47">zdz_2</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>⟪<span class="var token" data-binding="var-_uniq.118323" data-verso-hover="47">zdz_1</span>, <span class="var token" data-binding="var-_uniq.118336" data-verso-hover="47">ydy</span>⟫;
    (<span class="var token" data-binding="var-_uniq.118349" data-verso-hover="47">zdz</span>, <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118372" data-verso-hover="47">dy'</span> =&gt; <span class="var token" data-binding="var-_uniq.118366" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118372" data-verso-hover="47">dy'</span>);
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118445" data-verso-hover="639">r</span> :=
  <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118404" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118166" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118404" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span>) <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
<span class="var token" data-binding="var-_uniq.118445" data-verso-hover="639">r</span>.minimizer</span></span></span></span></span>

  -- approximate both ODEs with RK4
  <span class="tactic"><label for="tactic-state-366306311957117618-6612-6676"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.simp-6612" data-verso-hover="204">simp</span> <span class="unknown token" data-binding="">-</span><span class="const token" data-binding="const-Lean.Meta.Simp.Config.zeta" data-verso-hover="604">zeta</span> <span class="keyword token" data-binding="kw-occ-null-6623">only</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-SciLean.odeSolve_fixed_dt" data-verso-hover="605">odeSolve_fixed_dt</span> <span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-6660" data-verso-hover="67">by</span> <span class="keyword token" data-binding="kw-occ-SciLean.tacticSorry_proof-6663" data-verso-hover="375">sorry_proof</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-366306311957117618-6612-6676"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-SciLean.Optimjl.Options" data-verso-hover="644">Options</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-SciLean.Approx" data-verso-hover="599">Approx</span> (<span class="const token" data-binding="const-Filter.atTop" data-verso-hover="600">Filter.atTop</span><span class="const token" data-binding="const-SProd.sprod" data-verso-hover="601"> ×ˢ </span>?m.117588 <span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>)
  (<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118092" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118222" data-verso-hover="625">y</span> :=
    <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118102" data-verso-hover="47">k</span> =&gt;
      limit <span class="var token" data-binding="var-_uniq.118119" data-verso-hover="2">n</span> → ∞,
        <span class="const token" data-binding="const-SciLean.odeSolveFixedStep" data-verso-hover="607">odeSolveFixedStep</span>
          (<span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118160" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118161" data-verso-hover="602">x</span> =&gt;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118174" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118175" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118161" data-verso-hover="602">x</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118182" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118102" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118183" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118161" data-verso-hover="602">x</span>.1;
            (<span class="var token" data-binding="var-_uniq.118174" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118175" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118182" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118183" data-verso-hover="47">ydf_3</span>))))
          <span class="var token" data-binding="var-_uniq.118119" data-verso-hover="2">n</span> 0 <span class="var token" data-binding="var-_uniq.118092" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118453" data-verso-hover="638">f'</span> :=
    <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118228" data-verso-hover="47">x</span> =&gt;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118238" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118357" data-verso-hover="645">F</span> :=
        <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118244" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118245" data-verso-hover="646">xdx</span> =&gt;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118246" data-verso-hover="602">x_1</span> := <span class="var token" data-binding="var-_uniq.118245" data-verso-hover="646">xdx</span>.1;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118247" data-verso-hover="602">dx</span> := <span class="var token" data-binding="var-_uniq.118245" data-verso-hover="646">xdx</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118248" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118246" data-verso-hover="602">x_1</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118249" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118247" data-verso-hover="602">dx</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118256" data-verso-hover="47">zdz_2</span> := <span class="var token" data-binding="var-_uniq.118228" data-verso-hover="47">x</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118260" data-verso-hover="47">zdz_3</span> := 2<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118261" data-verso-hover="47">zdz_4</span> := <span class="var token" data-binding="var-_uniq.118246" data-verso-hover="602">x_1</span>.1;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118262" data-verso-hover="47">zdz_5</span> := <span class="var token" data-binding="var-_uniq.118247" data-verso-hover="602">dx</span>.1;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118269" data-verso-hover="47">zdz</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118248" data-verso-hover="47">zdz</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118276" data-verso-hover="47">zdz_6</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118249" data-verso-hover="47">zdz_1</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118283" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118238" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118269" data-verso-hover="47">zdz</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118290" data-verso-hover="47">zdz_7</span> := <span class="var token" data-binding="var-_uniq.118238" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118276" data-verso-hover="47">zdz_6</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118297" data-verso-hover="47">zdz_8</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118261" data-verso-hover="47">zdz_4</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118304" data-verso-hover="47">zdz_9</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118262" data-verso-hover="47">zdz_5</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118311" data-verso-hover="47">zdz_10</span> := <span class="var token" data-binding="var-_uniq.118256" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118297" data-verso-hover="47">zdz_8</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118336" data-verso-hover="47">zdz_11</span> := <span class="var token" data-binding="var-_uniq.118256" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118304" data-verso-hover="47">zdz_9</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="143"> + </span><span class="var token" data-binding="var-_uniq.118260" data-verso-hover="47">zdz_3</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118297" data-verso-hover="47">zdz_8</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118340" data-verso-hover="47">zdz_12</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118311" data-verso-hover="47">zdz_10</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118344" data-verso-hover="47">zdz_13</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118336" data-verso-hover="47">zdz_11</span>;
          ((<span class="var token" data-binding="var-_uniq.118283" data-verso-hover="47">zdz</span>, <span class="var token" data-binding="var-_uniq.118340" data-verso-hover="47">zdz_12</span>), <span class="var token" data-binding="var-_uniq.118290" data-verso-hover="47">zdz_7</span>, <span class="var token" data-binding="var-_uniq.118344" data-verso-hover="47">zdz_13</span>);
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118393" data-verso-hover="646">xdx</span> := limit <span class="var token" data-binding="var-_uniq.118367" data-verso-hover="2">n</span> → ∞, <span class="const token" data-binding="const-SciLean.odeSolveFixedStep" data-verso-hover="607">odeSolveFixedStep</span> (<span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="var token" data-binding="var-_uniq.118357" data-verso-hover="645">F</span>) <span class="var token" data-binding="var-_uniq.118367" data-verso-hover="2">n</span> 0 <span class="var token" data-binding="var-_uniq.118092" data-verso-hover="47">T</span> ((<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0), 0);
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118394" data-verso-hover="602">y</span> := <span class="var token" data-binding="var-_uniq.118393" data-verso-hover="646">xdx</span>.1;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118395" data-verso-hover="602">dy</span> := <span class="var token" data-binding="var-_uniq.118393" data-verso-hover="646">xdx</span>.2;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118396" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118394" data-verso-hover="602">y</span>.1;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118397" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118395" data-verso-hover="602">dy</span>.1;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118410" data-verso-hover="47">ydy</span> := <span class="var token" data-binding="var-_uniq.118396" data-verso-hover="47">zdz</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118423" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118410" data-verso-hover="47">ydy</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118440" data-verso-hover="47">zdz_2</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>⟪<span class="var token" data-binding="var-_uniq.118397" data-verso-hover="47">zdz_1</span>, <span class="var token" data-binding="var-_uniq.118410" data-verso-hover="47">ydy</span>⟫;
      (<span class="var token" data-binding="var-_uniq.118423" data-verso-hover="47">zdz</span>, <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118446" data-verso-hover="47">dy'</span> =&gt; <span class="var token" data-binding="var-_uniq.118440" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118446" data-verso-hover="47">dy'</span>);
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118519" data-verso-hover="639">r</span> :=
    <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118478" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118222" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118478" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span>) <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
  <span class="var token" data-binding="var-_uniq.118519" data-verso-hover="639">r</span>.minimizer)</span></span></span><span class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> → <span class="sort token" data-binding="">Type</span></span></span></span><span class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(<span class="var token" data-binding="var-_uniq.118041" data-verso-hover="47">m </span><span class="var token" data-binding="var-_uniq.118043" data-verso-hover="47">x₀ </span><span class="var token" data-binding="var-_uniq.118045" data-verso-hover="47">ω </span><span class="var token" data-binding="var-_uniq.118046" data-verso-hover="47">k₀</span> : <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span>) → <span class="const token" data-binding="const-Filter" data-verso-hover="609">Filter</span> (<span class="const token" data-binding="const-Nat" data-verso-hover="5">ℕ</span><span class="const token" data-binding="const-Prod" data-verso-hover="68"> × </span>?m.117586 <span class="var token" data-binding="var-_uniq.118041" data-verso-hover="47">m</span> <span class="var token" data-binding="var-_uniq.118043" data-verso-hover="47">x₀</span> <span class="var token" data-binding="var-_uniq.118045" data-verso-hover="47">ω</span> <span class="var token" data-binding="var-_uniq.118046" data-verso-hover="47">k₀</span>)</span></span></span></span></span>

  -- choose the same number of steps for both ODE solvers
  -- and consume the corresponding limin in `Approx`
  <span class="keyword token" data-binding="kw-occ-SciLean.approx_limit_tactic-6791" data-verso-hover="608">approx_limit</span> <span class="var token" data-binding="var-_uniq.117630" data-verso-hover="2">steps</span> <span class="unknown token" data-binding="">(</span><span class="tactic"><label for="tactic-state-12718243028995260751-6811-6813"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-6811" data-verso-hover="67">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-12718243028995260751-6811-6813"><span class="tactic-state"><span class="goal"><span class="hypotheses"><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span><span class="hypothesis"><span class="name"><span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span></span><span class="colon">:</span><span class="type"><span class="const token" data-binding="const-SciLean.Optimjl.Options" data-verso-hover="644">Options</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span></span></span></span><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118202" data-verso-hover="625">y</span> :=
    <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118082" data-verso-hover="47">k</span> =&gt;
      limit <span class="var token" data-binding="var-_uniq.118099" data-verso-hover="2">n</span> → ∞,
        <span class="const token" data-binding="const-SciLean.odeSolveFixedStep" data-verso-hover="607">odeSolveFixedStep</span>
          (<span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118140" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118141" data-verso-hover="602">x</span> =&gt;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118154" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118155" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118141" data-verso-hover="602">x</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118162" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118082" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118163" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118141" data-verso-hover="602">x</span>.1;
            (<span class="var token" data-binding="var-_uniq.118154" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118155" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118162" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118163" data-verso-hover="47">ydf_3</span>))))
          <span class="var token" data-binding="var-_uniq.118099" data-verso-hover="2">n</span> 0 <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118433" data-verso-hover="638">f'</span> :=
    <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118208" data-verso-hover="47">x</span> =&gt;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118218" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118337" data-verso-hover="645">F</span> :=
        <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118224" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118225" data-verso-hover="646">xdx</span> =&gt;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118226" data-verso-hover="602">x_1</span> := <span class="var token" data-binding="var-_uniq.118225" data-verso-hover="646">xdx</span>.1;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118227" data-verso-hover="602">dx</span> := <span class="var token" data-binding="var-_uniq.118225" data-verso-hover="646">xdx</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118228" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118226" data-verso-hover="602">x_1</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118229" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118227" data-verso-hover="602">dx</span>.2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118236" data-verso-hover="47">zdz_2</span> := <span class="var token" data-binding="var-_uniq.118208" data-verso-hover="47">x</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118240" data-verso-hover="47">zdz_3</span> := 2<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118241" data-verso-hover="47">zdz_4</span> := <span class="var token" data-binding="var-_uniq.118226" data-verso-hover="602">x_1</span>.1;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118242" data-verso-hover="47">zdz_5</span> := <span class="var token" data-binding="var-_uniq.118227" data-verso-hover="602">dx</span>.1;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118249" data-verso-hover="47">zdz</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118228" data-verso-hover="47">zdz</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118256" data-verso-hover="47">zdz_6</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118229" data-verso-hover="47">zdz_1</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118263" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118218" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118249" data-verso-hover="47">zdz</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118270" data-verso-hover="47">zdz_7</span> := <span class="var token" data-binding="var-_uniq.118218" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118256" data-verso-hover="47">zdz_6</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118277" data-verso-hover="47">zdz_8</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118241" data-verso-hover="47">zdz_4</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118284" data-verso-hover="47">zdz_9</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118242" data-verso-hover="47">zdz_5</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118291" data-verso-hover="47">zdz_10</span> := <span class="var token" data-binding="var-_uniq.118236" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118277" data-verso-hover="47">zdz_8</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118316" data-verso-hover="47">zdz_11</span> := <span class="var token" data-binding="var-_uniq.118236" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118284" data-verso-hover="47">zdz_9</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="143"> + </span><span class="var token" data-binding="var-_uniq.118240" data-verso-hover="47">zdz_3</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118277" data-verso-hover="47">zdz_8</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118320" data-verso-hover="47">zdz_12</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118291" data-verso-hover="47">zdz_10</span>;
          <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118324" data-verso-hover="47">zdz_13</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118316" data-verso-hover="47">zdz_11</span>;
          ((<span class="var token" data-binding="var-_uniq.118263" data-verso-hover="47">zdz</span>, <span class="var token" data-binding="var-_uniq.118320" data-verso-hover="47">zdz_12</span>), <span class="var token" data-binding="var-_uniq.118270" data-verso-hover="47">zdz_7</span>, <span class="var token" data-binding="var-_uniq.118324" data-verso-hover="47">zdz_13</span>);
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118373" data-verso-hover="646">xdx</span> := limit <span class="var token" data-binding="var-_uniq.118347" data-verso-hover="2">n</span> → ∞, <span class="const token" data-binding="const-SciLean.odeSolveFixedStep" data-verso-hover="607">odeSolveFixedStep</span> (<span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="var token" data-binding="var-_uniq.118337" data-verso-hover="645">F</span>) <span class="var token" data-binding="var-_uniq.118347" data-verso-hover="2">n</span> 0 <span class="var token" data-binding="var-_uniq.118072" data-verso-hover="47">T</span> ((<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0), 0);
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118374" data-verso-hover="602">y</span> := <span class="var token" data-binding="var-_uniq.118373" data-verso-hover="646">xdx</span>.1;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118375" data-verso-hover="602">dy</span> := <span class="var token" data-binding="var-_uniq.118373" data-verso-hover="646">xdx</span>.2;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118376" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118374" data-verso-hover="602">y</span>.1;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118377" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118375" data-verso-hover="602">dy</span>.1;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118390" data-verso-hover="47">ydy</span> := <span class="var token" data-binding="var-_uniq.118376" data-verso-hover="47">zdz</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118403" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118390" data-verso-hover="47">ydy</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2;
      <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118420" data-verso-hover="47">zdz_2</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>⟪<span class="var token" data-binding="var-_uniq.118377" data-verso-hover="47">zdz_1</span>, <span class="var token" data-binding="var-_uniq.118390" data-verso-hover="47">ydy</span>⟫;
      (<span class="var token" data-binding="var-_uniq.118403" data-verso-hover="47">zdz</span>, <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118426" data-verso-hover="47">dy'</span> =&gt; <span class="var token" data-binding="var-_uniq.118420" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118426" data-verso-hover="47">dy'</span>);
  <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118499" data-verso-hover="639">r</span> :=
    <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118458" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118202" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118458" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span>) <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
  <span class="var token" data-binding="var-_uniq.118499" data-verso-hover="639">r</span>.minimizer)<span class="const token" data-binding="const-Eq" data-verso-hover="69"> =
  </span>limit <span class="var token" data-binding="var-_uniq.118513" data-verso-hover="2">n</span> → ∞,
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118532" data-verso-hover="47">T</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>π<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="47">ω</span>;
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118615" data-verso-hover="625">y</span> :=
      <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118540" data-verso-hover="47">k</span> =&gt;
        <span class="const token" data-binding="const-SciLean.odeSolveFixedStep" data-verso-hover="607">odeSolveFixedStep</span>
          (<span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118559" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118560" data-verso-hover="602">x</span> =&gt;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118570" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118571" data-verso-hover="47">ydf_1</span> := <span class="var token" data-binding="var-_uniq.118560" data-verso-hover="602">x</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118578" data-verso-hover="47">ydf_2</span> := <span class="var token" data-binding="var-_uniq.118540" data-verso-hover="47">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118579" data-verso-hover="47">ydf_3</span> := <span class="var token" data-binding="var-_uniq.118560" data-verso-hover="602">x</span>.1;
            (<span class="var token" data-binding="var-_uniq.118570" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118571" data-verso-hover="47">ydf_1</span>), <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span>(<span class="var token" data-binding="var-_uniq.118578" data-verso-hover="47">ydf_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118579" data-verso-hover="47">ydf_3</span>))))
          <span class="var token" data-binding="var-_uniq.118513" data-verso-hover="2">n</span> 0 <span class="var token" data-binding="var-_uniq.118532" data-verso-hover="47">T</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118813" data-verso-hover="638">f'</span> :=
      <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118621" data-verso-hover="47">x</span> =&gt;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118631" data-verso-hover="47">ydf</span> := (2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="47">m</span>)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118744" data-verso-hover="645">F</span> :=
          <span class="const token" data-binding="const-SciLean.holdLet" data-verso-hover="626">holdLet</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118637" data-verso-hover="47">t</span> <span class="var token" data-binding="var-_uniq.118638" data-verso-hover="646">xdx</span> =&gt;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118639" data-verso-hover="602">x_1</span> := <span class="var token" data-binding="var-_uniq.118638" data-verso-hover="646">xdx</span>.1;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118640" data-verso-hover="602">dx</span> := <span class="var token" data-binding="var-_uniq.118638" data-verso-hover="646">xdx</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118641" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118639" data-verso-hover="602">x_1</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118642" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118640" data-verso-hover="602">dx</span>.2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118649" data-verso-hover="47">zdz_2</span> := <span class="var token" data-binding="var-_uniq.118621" data-verso-hover="47">x</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="139"> / </span>2;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118653" data-verso-hover="47">zdz_3</span> := 2<span class="const token" data-binding="const-Inv.inv" data-verso-hover="201">⁻¹</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118654" data-verso-hover="47">zdz_4</span> := <span class="var token" data-binding="var-_uniq.118639" data-verso-hover="602">x_1</span>.1;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118655" data-verso-hover="47">zdz_5</span> := <span class="var token" data-binding="var-_uniq.118640" data-verso-hover="602">dx</span>.1;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118662" data-verso-hover="47">zdz</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118641" data-verso-hover="47">zdz</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118669" data-verso-hover="47">zdz_6</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118642" data-verso-hover="47">zdz_1</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118676" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118631" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118662" data-verso-hover="47">zdz</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118683" data-verso-hover="47">zdz_7</span> := <span class="var token" data-binding="var-_uniq.118631" data-verso-hover="47">ydf</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118669" data-verso-hover="47">zdz_6</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118690" data-verso-hover="47">zdz_8</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118654" data-verso-hover="47">zdz_4</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118697" data-verso-hover="47">zdz_9</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118655" data-verso-hover="47">zdz_5</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118704" data-verso-hover="47">zdz_10</span> := <span class="var token" data-binding="var-_uniq.118649" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118690" data-verso-hover="47">zdz_8</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118723" data-verso-hover="47">zdz_11</span> := <span class="var token" data-binding="var-_uniq.118649" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118697" data-verso-hover="47">zdz_9</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="143"> + </span><span class="var token" data-binding="var-_uniq.118653" data-verso-hover="47">zdz_3</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118690" data-verso-hover="47">zdz_8</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118727" data-verso-hover="47">zdz_12</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118704" data-verso-hover="47">zdz_10</span>;
            <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118731" data-verso-hover="47">zdz_13</span> := <span class="const token" data-binding="const-Neg.neg" data-verso-hover="199">-</span><span class="var token" data-binding="var-_uniq.118723" data-verso-hover="47">zdz_11</span>;
            ((<span class="var token" data-binding="var-_uniq.118676" data-verso-hover="47">zdz</span>, <span class="var token" data-binding="var-_uniq.118727" data-verso-hover="47">zdz_12</span>), <span class="var token" data-binding="var-_uniq.118683" data-verso-hover="47">zdz_7</span>, <span class="var token" data-binding="var-_uniq.118731" data-verso-hover="47">zdz_13</span>);
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118770" data-verso-hover="646">xdx</span> := <span class="const token" data-binding="const-SciLean.odeSolveFixedStep" data-verso-hover="607">odeSolveFixedStep</span> (<span class="const token" data-binding="const-SciLean.rungeKutta4" data-verso-hover="606">rungeKutta4</span> <span class="var token" data-binding="var-_uniq.118744" data-verso-hover="645">F</span>) <span class="var token" data-binding="var-_uniq.118513" data-verso-hover="2">n</span> 0 <span class="var token" data-binding="var-_uniq.118532" data-verso-hover="47">T</span> ((<span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>, 0), 0);
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118771" data-verso-hover="602">y</span> := <span class="var token" data-binding="var-_uniq.118770" data-verso-hover="646">xdx</span>.1;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118772" data-verso-hover="602">dy</span> := <span class="var token" data-binding="var-_uniq.118770" data-verso-hover="646">xdx</span>.2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118773" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118771" data-verso-hover="602">y</span>.1;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118774" data-verso-hover="47">zdz_1</span> := <span class="var token" data-binding="var-_uniq.118772" data-verso-hover="602">dy</span>.1;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118781" data-verso-hover="47">ydy</span> := <span class="var token" data-binding="var-_uniq.118773" data-verso-hover="47">zdz</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118788" data-verso-hover="47">zdz</span> := <span class="var token" data-binding="var-_uniq.118781" data-verso-hover="47">ydy</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="179"> ^ </span>2;
        <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118800" data-verso-hover="47">zdz_2</span> := 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span>⟪<span class="var token" data-binding="var-_uniq.118774" data-verso-hover="47">zdz_1</span>, <span class="var token" data-binding="var-_uniq.118781" data-verso-hover="47">ydy</span>⟫;
        (<span class="var token" data-binding="var-_uniq.118788" data-verso-hover="47">zdz</span>, <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118806" data-verso-hover="47">dy'</span> =&gt; <span class="var token" data-binding="var-_uniq.118800" data-verso-hover="47">zdz_2</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="140"> * </span><span class="var token" data-binding="var-_uniq.118806" data-verso-hover="47">dy'</span>);
    <span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.118862" data-verso-hover="639">r</span> :=
      <span class="const token" data-binding="const-SciLean.Optimjl.optimize" data-verso-hover="640">optimize</span> (<span class="const token" data-binding="const-SciLean.Optimjl.ObjectiveFunction.mk" data-verso-hover="641">ObjectiveFunction.mk</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.118838" data-verso-hover="47">x</span> =&gt; ‖(<span class="var token" data-binding="var-_uniq.118615" data-verso-hover="625">y</span> <span class="var token" data-binding="var-_uniq.118838" data-verso-hover="47">x</span>).1<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="180"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="47">x₀</span>‖₂²) ⋯) (<span class="const token" data-binding="const-SciLean.Optimjl.AbstractOptimizer.setOptions" data-verso-hover="642">AbstractOptimizer.setOptions</span> <span class="const token" data-binding="const-Float" data-verso-hover="26">Float</span> <span class="const token" data-binding="const-Inhabited.default" data-verso-hover="61">default</span> <span class="var token" data-binding="var-_uniq.26518" data-verso-hover="636">opts</span>)
        <span class="var token" data-binding="var-_uniq.8" data-verso-hover="47">k₀</span>;
    <span class="var token" data-binding="var-_uniq.118862" data-verso-hover="639">r</span>.minimizer</span></span></span></span></span> <span class="tactic"><label for="tactic-state-7-6814-6825"><span class="keyword token" data-binding="kw-occ-SciLean.tacticSorry_proof-6814" data-verso-hover="375">sorry_proof</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-6814-6825"><span class="tactic-state">All goals completed! 🐙</span></span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">39.478418</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-6840" data-verso-hover="11">#eval</span></span> <span class="unknown token" data-binding="">(</span><span class="typed token" data-binding="" data-verso-hover="47">2</span><span class="unknown token" data-binding="">*</span><span class="unknown token" data-binding="">π</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">^</span><span class="typed token" data-binding="" data-verso-hover="2">2</span>
<span class="unknown token" data-binding=""></span></code><code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">355.306213</code><code class="message info">n	xₙ	xₙ₊₁	f(xₙ)	∇f(xₙ)	sₙ	α
0	10.000000	10.013080	3.999144	-0.013080	0.013080	1.000000
1	10.013080	10.027457	3.998965	-0.014377	0.014377	1.000000
2	10.027457	10.043258	3.998748	-0.015800	0.015800	1.000000
3	10.043258	10.060618	3.998486	-0.017360	0.017360	1.000000
4	10.060618	10.079688	3.998170	-0.019070	0.019070	1.000000
5	10.079688	10.100631	3.997788	-0.020942	0.020942	1.000000
6	10.100631	10.123623	3.997328	-0.022992	0.022992	1.000000
7	10.123623	10.148857	3.996774	-0.025234	0.025234	1.000000
8	10.148857	10.176542	3.996106	-0.027685	0.027685	1.000000
9	10.176542	10.206904	3.995302	-0.030362	0.030362	1.000000
10	10.206904	10.240189	3.994336	-0.033285	0.033285	1.000000
11	10.240189	10.276660	3.993175	-0.036471	0.036471	1.000000
12	10.276660	10.316601	3.991782	-0.039941	0.039941	1.000000
13	10.316601	10.360318	3.990111	-0.043717	0.043717	1.000000
14	10.360318	10.408139	3.988110	-0.047821	0.047821	1.000000
15	10.408139	10.460412	3.985716	-0.052273	0.052273	1.000000
16	10.460412	10.517508	3.982858	-0.057096	0.057096	1.000000
17	10.517508	10.579821	3.979449	-0.062313	0.062313	1.000000
18	10.579821	10.647767	3.975390	-0.067945	0.067945	1.000000
19	10.647767	10.721778	3.970567	-0.074012	0.074012	1.000000
20	10.721778	10.802310	3.964847	-0.080531	0.080531	1.000000
21	10.802310	10.889830	3.958080	-0.087520	0.087520	1.000000
22	10.889830	10.984821	3.950092	-0.094991	0.094991	1.000000
23	10.984821	11.087771	3.940689	-0.102950	0.102950	1.000000
24	11.087771	11.199173	3.929654	-0.111402	0.111402	1.000000
25	11.199173	11.319516	3.916744	-0.120342	0.120342	1.000000
26	11.319516	11.449274	3.901692	-0.129759	0.129759	1.000000
27	11.449274	11.588905	3.884211	-0.139630	0.139630	1.000000
28	11.588905	11.738831	3.863992	-0.149926	0.149926	1.000000
29	11.738831	11.899435	3.840709	-0.160604	0.160604	1.000000
30	11.899435	12.071045	3.814025	-0.171609	0.171609	1.000000
31	12.071045	12.253919	3.783602	-0.182874	0.182874	1.000000
32	12.253919	12.448237	3.749103	-0.194318	0.194318	1.000000
33	12.448237	12.654086	3.710213	-0.205849	0.205849	1.000000
34	12.654086	12.871448	3.666642	-0.217362	0.217362	1.000000
35	12.871448	13.100192	3.618144	-0.228743	0.228743	1.000000
36	13.100192	13.340063	3.564532	-0.239871	0.239871	1.000000
37	13.340063	13.590683	3.505686	-0.250620	0.250620	1.000000
38	13.590683	13.851544	3.441571	-0.260862	0.260862	1.000000
39	13.851544	14.122018	3.372245	-0.270474	0.270474	1.000000
40	14.122018	14.401358	3.297866	-0.279339	0.279339	1.000000
41	14.401358	14.688711	3.218689	-0.287354	0.287354	1.000000
42	14.688711	14.983138	3.135073	-0.294427	0.294427	1.000000
43	14.983138	15.283626	3.047464	-0.300488	0.300488	1.000000
44	15.283626	15.589111	2.956391	-0.305485	0.305485	1.000000
45	15.589111	15.898500	2.862445	-0.309389	0.309389	1.000000
46	15.898500	16.210693	2.766260	-0.312193	0.312193	1.000000
47	16.210693	16.524602	2.668500	-0.313909	0.313909	1.000000
48	16.524602	16.839174	2.569829	-0.314572	0.314572	1.000000
49	16.839174	306.292294	2.470902	-0.314231	289.453119	1.000000
50	306.292294	352.721303	0.607448	-0.043436	46.429009	1.000000
51	352.721303	352.730521	0.000006	-0.000009	0.009218	1.000000
52	352.730521	353.584317	0.000005	-0.000009	0.853796	1.000000
53	353.584317	353.947131	0.000001	-0.000003	0.362814	1.000000
54	353.947131	354.297762	0.000000	-0.000001	0.350631	1.000000
55	354.297762	354.539999	0.000000	-0.000001	0.242237	1.000000
56	354.539999	354.729669	0.000000	-0.000000	0.189670	1.000000
57	354.729669	354.871184	0.000000	-0.000000	0.141515	1.000000
58	354.871184	354.978844	0.000000	-0.000000	0.107660	1.000000
59	354.978844	355.060288	0.000000	-0.000000	0.081444	1.000000
60	355.060288	355.122241	0.000000	-0.000000	0.061952	1.000000
61	355.122241	355.169543	0.000000	-0.000000	0.047302	1.000000
62	355.169543	355.205967	0.000000	-0.000000	0.036424	1.000000
63	355.205967	355.234382	0.000000	-0.000000	0.028415	1.000000
64	355.234382	355.256987	0.000000	-0.000000	0.022605	1.000000
65	355.256987	355.275377	0.000000	-0.000000	0.018390	1.000000
66	355.275377	355.290337	0.000000	-0.000000	0.014960	1.000000
67	355.290337	355.301080	0.000000	-0.000000	0.010743	1.000000
68	355.301080	355.305664	0.000000	-0.000000	0.004584	1.000000
69	355.305664	355.306207	0.000000	-0.000000	0.000542	1.000000
70	355.306207	355.306213	0.000000	-0.000000	0.000006	1.000000
71	355.306213	355.306213	0.000000	-0.000000	0.000000	1.000000
 * Status: success

 * Candidate solution
    Minimizer:                 355.306213
    Final objective value:     0.000000

 * Found with
    Algorithm:     (TODO: implement this)

 * Convergence measures
    |x - x'|               = 0.000000 ≤ 0.000000
    |x - x'|               = 0.000000 ≰ 0.000000
    |f(x) - f(x')|         = 0.000000 ≰ 0.000000
    |f(x) - f(x')|/|f(x')| = 0.000000 ≰ 0.000000
    |g(x)|                 = 0.000000 ≰ 0.000000

 * Work counters
    Seconds run:   0ns   (vs limit ∞ns)
    Iterations:    72
    f(x) calls:    73
    ∇f(x) calls:   73
    ∇²f(x) calls:  0

</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-6868" data-verso-hover="11">#eval</span></span> <span class="const token" data-binding="const-HarOscOpt.findStiffness" data-verso-hover="627">findStiffness</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">m</span><span class="unknown token" data-binding="">:=</span><span class="typed token" data-binding="" data-verso-hover="47">1</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">ω</span><span class="unknown token" data-binding="">:=</span><span class="typed token" data-binding="" data-verso-hover="47">2</span><span class="unknown token" data-binding="">*</span><span class="unknown token" data-binding="">π</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">x₀</span><span class="unknown token" data-binding="">:=</span><span class="typed token" data-binding="" data-verso-hover="47">1</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">k₀</span><span class="unknown token" data-binding="">:=</span><span class="typed token" data-binding="" data-verso-hover="47">10</span><span class="unknown token" data-binding="">)</span>
        <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">{</span><span class="const token" data-binding="const-SciLean.Optimjl.Options.x_abstol" data-verso-hover="647">x_abstol</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">1e-16</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-SciLean.Optimjl.Options.g_abstol" data-verso-hover="647">g_abstol</span> <span class="unknown token" data-binding="">:=</span> <span class="typed token" data-binding="" data-verso-hover="47">0</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-SciLean.Optimjl.Options.show_trace" data-verso-hover="648">show_trace</span> <span class="unknown token" data-binding="">:=</span> <span class="const token" data-binding="const-Bool.true" data-verso-hover="370">true</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-SciLean.Optimjl.Options.result_trace" data-verso-hover="648">result_trace</span> <span class="unknown token" data-binding="">:=</span> <span class="const token" data-binding="const-Bool.true" data-verso-hover="370">true</span><span class="unknown token" data-binding="">}</span><span class="unknown token" data-binding="">,</span><span class="typed token" data-binding="" data-verso-hover="2">200</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">39.478418</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-7034" data-verso-hover="11">#eval</span></span> <span class="typed token" data-binding="" data-verso-hover="47">4</span><span class="unknown token" data-binding="">*</span><span class="unknown token" data-binding="">π</span><span class="unknown token" data-binding="">^</span><span class="typed token" data-binding="" data-verso-hover="2">2</span>
<span class="unknown token" data-binding=""></span></code><p>
              Original differential equation</p>
            <p>
              $$\begin{align}
\dot x &= \frac{p}{m} \\
\dot p &= -k x \\
x(0) &= x_0 \qquad p(0) = p_0
\end{align}
$$</p>
            <p>
              Derived differential equation that also solves for two additional variables \(x<em>k\) and \(p</em>k\) which are derivatives of the solution w.r.t. \(k\).
The <code>autodiff</code> tactic uses the theorem <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-SciLean.odeSolve.arg_ft₀tx₀.fwdDeriv_rule" data-verso-hover="649">odeSolve.arg_ft₀tx₀.fwdDeriv_rule</span></code> that states what happends when we differentiate the solution of differential equation w.r.t. to parameter, inital condition or initial and terminal time.</p>
            <p>
              $$\begin{align}
\dot x &= \frac{p}{m} \\
\dot p &= -k x \\
\dot x_k &= \frac{p_k}{m} \\
\dot p_k &= -x - k x_k \\
x(0) = x_0 \qquad p(0) &= p_0 \qquad x_k(0) = 0 \qquad p_k(0) = 0
\end{align}
$$</p>
            </section>
          </section>
        </main></div>
    </body>
  </html>

