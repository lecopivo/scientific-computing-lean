<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Symbolic Differentiation</title><link rel="stylesheet" href="../../book.css">
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js" integrity="sha384-zbcZAIxlvJtNE3Dp5nxLXdXtXyxwOdnILY1TDPVmKFhl4r4nSUG1r8bcFXGVa4Te" crossorigin="anonymous"></script>
    <script src="../../static/katex/katex.min.js"></script>
    <script src="../../static/math.js"></script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../-verso-js/popper.js"></script>
    <script src="../../-verso-js/tippy.js"></script>
    <link rel="stylesheet" href="../../static/theme.css">
    <link rel="stylesheet" href="../../static/inter/inter.css">
    <link rel="stylesheet" href="../../static/firacode/fira_code.css">
    <link rel="stylesheet" href="../../static/katex/katex.min.css">
    <link rel="stylesheet" href="../../-verso-css/tippy-border.css">
    <style>
div.collapsible-hint {
  margin: 5px 0;
}

div.collapsible-hint-header {
  padding: 2px;
  font-size: medium;
  cursor: pointer;
  position: relative;
}

div.collapsible-hint-header::after {
  content: "⊢";
  position: absolute;
  left: 50px;
  transition: transform 0.3s ease;
}

div.collapsible-hint-content {
  border: 1px solid white;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

div.collapsible-hint.expanded .collapsible-hint-content {
  max-height: 500px; /* Adjust this value depending on the content's height */
  border: 1px solid lightgrey;
}

div.collapsible-hint.expanded .collapsible-hint-header::after {
  transform: rotate(90deg); /* Rotate to show ">" when expanded */
}
</style><style>

.hl.lean {
  white-space: pre;
  font-weight: normal;
  font-style: normal;
}

.hl.lean .keyword {
  font-weight : bold;
}

.hl.lean .var {
  font-style: italic;
  position: relative;
}

.hover-container {
  width: 0;
  height: 0;
  position: relative;
  display: inline;
}

.hl.lean .hover-info {
  white-space: normal;
}

.hl.lean .token .hover-info {
  display: none;
  position: absolute;
  background-color: #e5e5e5;
  border: 1px solid black;
  padding: 0.5em;
  z-index: 300;
  font-size: inherit;
}

.hl.lean .hover-info.messages {
  max-height: 10em;
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-gutter: stable;
  padding: 0 0.5em 0 0;
  display: block;
}

.hl.lean .hover-info code {
  white-space: pre-wrap;
}

.hl.lean .hover-info.messages > code {
  padding: 0.5em;
  display: block;
  width: fit-content;
}

.hl.lean .hover-info.messages > code:only-child {
  margin: 0;
}

.hl.lean .hover-info.messages > code {
  margin: 0.1em;
}

.hl.lean .hover-info.messages > code:not(:first-child) {
  margin-top: 0em;
}

/*
@media (hover: hover) {
  .hl.lean .has-info:hover > .hover-container > .hover-info:not(.tactic *),
  .hl.lean .tactic:has(> .tactic-toggle:checked) .has-info:hover > .hover-container > .hover-info,
  .hl.lean .token:hover > .hover-container > .hover-info:not(.has-info *):not(.tactic *),
  .hl.lean .tactic:has(> .tactic-toggle:checked) .token:hover > .hover-container > .hover-info:not(.has-info *) {
    display: inline-block;
    position: absolute;
    top: 1em;
    font-weight: normal;
    font-style: normal;
    width: min-content;
  }
}
*/

.hl.lean.block {
  display: block;
}

.hl.lean.inline {
  display: inline;
}

.hl.lean .token {
  transition: all 0.25s; /* Slight fade for highlights */
}

@media (hover: hover) {
  .hl.lean .token.binding-hl, .hl.lean .literal.string:hover {
    background-color: #eee;
    border-radius: 2px;
    transition: none;
  }
}


.hl.lean .has-info {
  text-decoration-style: wavy;
  text-decoration-line: underline;
  text-decoration-thickness: 0.1rem;
}

.hl.lean .has-info .hover-info {
  display: none;
  position: absolute;
  transform: translate(0.25rem, 0.3rem);
  border: 1px solid black;
  padding: 0.5em;
  z-index: 400;
  text-align: left;
}

.hl.lean .has-info.error {
  text-decoration-color: red;
}

@media (hover: hover) {
  .hl.lean .has-info.error:hover {
    background-color: #ffb3b3;
  }
}

.hl.lean .hover-info.messages > code.error {
  background-color: #e5e5e5;
  border-left: 0.2em solid #ffb3b3;
}

.tippy-box[data-theme~='error'] .hl.lean .hover-info.messages > code.error {
  background: none;
  border: none;
}

.error pre {
    color: red;
}

.hl.lean .has-info.warning {
  text-decoration-color: #efd871;
}

@media (hover: hover) {
  .hl.lean .has-info.warning:hover {
    background-color: #efd871;
  }
}

.hl.lean .hover-info.messages > code.warning {
  background-color: #efd871;
}

.hl.lean .hover-info.messages > code.error {
  background-color: #e5e5e5;
  border-left: 0.2em solid #efd871;
}

.tippy-box[data-theme~='warning'] .hl.lean .hover-info.messages > code.warning {
  background: none;
  border: none;
}


.hl.lean .has-info.info {
  text-decoration-color: blue;
}

@media (hover: hover) {
  .hl.lean .has-info.info:hover {
    background-color: #4777ff;
  }
}


.hl.lean .hover-info.messages > code.info {
  background-color: #e5e5e5;
  border-left: 0.2em solid #4777ff;
}

.tippy-box[data-theme~='info'] .hl.lean .hover-info.messages > code.info {
  background: none;
  border: none;
}

.hl.lean div.docstring {
  font-family: sans-serif;
  white-space: normal;
  max-width: 40em;
  width: max-content;
}

.hl.lean div.docstring > :last-child {
  margin-bottom: 0;
}

.hl.lean .hover-info .sep {
  display: block;
  width: auto;
  margin-left: 1em;
  margin-right: 1em;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  padding: 0;
  height: 1px;
  border-top: 1px solid #ccc;
}

.hl.lean code {
  font-family: monospace;
}

.hl.lean .tactic-state {
  display: none;
  position: relative;
  left: 2em;
  width: fit-content;
  border: 1px solid #888888;
  border-radius: 0.1em;
  padding: 0.5em;
  font-family: sans-serif;
  background-color: #ffffff;
  z-index: 200;
}

.hl.lean.popup .tactic-state {
  position: static;
  display: block;
  width: auto;
  border: none;
  padding: 0.5em;
  font-family: sans-serif;
  background-color: #ffffff;
}


.hl.lean .tactic {
  position: relative;
}

.hl.lean .tactic-toggle:checked ~ .tactic-state {
  display: block;
}

/*
@media (hover: hover) {
  .hl.lean .tactic:hover > .tactic-toggle:not(:checked) ~ .tactic-state {
    display: block;
    position: absolute;
    left: 0;
    transform: translate(0.25rem, 0);
    z-index: 250;
  }
}
*/

.hl.lean .tactic > label {
  position: relative;
  transition: all 0.5s;
}

@media (hover: hover) {
  .hl.lean .tactic > label:hover {
    border-bottom: 1px dotted #bbbbbb;
  }
}

.hl.lean .tactic-toggle {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  height: 0;
  width: 0;
  z-index: -10;
}

.hl.lean .tactic > label::after {
  content: "";
  border: 1px solid #bbbbbb;
  border-radius: 1em;
  height: 0.25em;
  vertical-align: middle;
  width: 0.6em;
  margin-left: 0.1em;
  margin-right: 0.1em;
  display: inline-block;
  transition: all 0.5s;
}

/*
@media (hover: hover) {
  .hl.lean .tactic > label:hover::after {
    border: 1px solid #aaaaaa;
    background-color: #aaaaaa;
    transition: all 0.5s;
  }
}
*/

.hl.lean .tactic > label:has(+ .tactic-toggle:checked)::after {
  border: 1px solid #999999;
  background-color: #999999;
  transition: all 0.5s;
}

.hl.lean .tactic-state .goal + .goal {
  margin-top: 1.5em;
}

.hl.lean .tactic-state summary {
  margin-left: -0.5em;
}

.hl.lean .tactic-state details {
  padding-left: 0.5em;
}

.hl.lean .tactic-state .goal-name::before {
  font-style: normal;
  content: "case ";
}

.hl.lean .tactic-state .goal-name {
  font-style: italic;
  font-family: monospace;
}

.hl.lean .tactic-state .hypotheses td.colon {
  text-align: center;
  min-width: 1em;
}

.hl.lean .tactic-state .hypotheses td.name {
  text-align: right;
}

.hl.lean .tactic-state .hypotheses td.name,
.hl.lean .tactic-state .hypotheses td.type,
.hl.lean .tactic-state .conclusion .type {
  font-family: monospace;
}

.tippy-box[data-theme~='lean'] {
  background-color: #e5e5e5;
  color: black;
  border: 1px solid black;
}
.tippy-box[data-theme~='lean'][data-placement^='top'] > .tippy-arrow::before {
  border-top-color: #e5e5e5;
}
.tippy-box[data-theme~='lean'][data-placement^='bottom'] > .tippy-arrow::before {
  border-bottom-color: #e5e5e5;
}
.tippy-box[data-theme~='lean'][data-placement^='left'] > .tippy-arrow::before {
  border-left-color: #e5e5e5;
}
.tippy-box[data-theme~='lean'][data-placement^='right'] > .tippy-arrow::before {
  border-right-color: #e5e5e5;
}

.tippy-box[data-theme~='message'][data-placement^='top'] > .tippy-arrow::before {
  border-top-color: #e5e5e5;
  border-width: 11px 11px 0;
}
.tippy-box[data-theme~='message'][data-placement^='top'] > .tippy-arrow::after {
  bottom: -11px;
  border-width: 11px 11px 0;
}
.tippy-box[data-theme~='message'][data-placement^='bottom'] > .tippy-arrow::before {
  border-width: 0 11px 11px;
}
.tippy-box[data-theme~='message'][data-placement^='bottom'] > .tippy-arrow::after {
  top: -11px;
  border-width: 0 11px 11px;
}
.tippy-box[data-theme~='message'][data-placement^='left'] > .tippy-arrow::before {
  border-left-color: #e5e5e5;
  border-width: 11px 0 11px 11px;
}
.tippy-box[data-theme~='message'][data-placement^='left'] > .tippy-arrow::after {
  right: -11px;
  border-width: 11px 0 11px 11px;
}

.tippy-box[data-theme~='message'][data-placement^='right'] > .tippy-arrow::before {
  border-right-color: #e5e5e5;
  border-width: 11px 11px 11px 0;
}
.tippy-box[data-theme~='message'][data-placement^='right'] > .tippy-arrow::after {
  left: -11px;
  border-width: 11px 11px 11px 0;
}



.tippy-box[data-theme~='warning'] {
  background-color: #e5e5e5;
  color: black;
  border: 3px solid #efd871;
}

.tippy-box[data-theme~='error'] {
  background-color: #e5e5e5;
  color: black;
  border: 3px solid #f7a7af;
}

.tippy-box[data-theme~='info'] {
  background-color: #e5e5e5;
  color: black;
  border: 3px solid #99b3c2;
}



.tippy-box[data-theme~='tactic'] {
  background-color: white;
  color: black;
  border: 1px solid black;
}
.tippy-box[data-theme~='tactic'][data-placement^='top'] > .tippy-arrow::before {
  border-top-color: white;
}
.tippy-box[data-theme~='tactic'][data-placement^='bottom'] > .tippy-arrow::before {
  border-bottom-color: white;
}
.tippy-box[data-theme~='tactic'][data-placement^='left'] > .tippy-arrow::before {
  border-left-color: white;
}
.tippy-box[data-theme~='tactic'][data-placement^='right'] > .tippy-arrow::before {
  border-right-color: white;
}

</style><style>
div.TODO {
  border: 5px solid red;
  position: relative;
}
div.TODO::before {
  content: "TODO";
  position: absolute;
  top: 0;
  right: 0;
  color: red;
  font-size: large;
  font-weight: bold;
  transform: rotate(-90deg) translate(-2em);
}
</style><style>
div.collapsible {
  margin: 5px 0;
}

div.collapsible-header {
  padding: 2px;
  font-size: medium;
  cursor: pointer;
  position: relative;
}

div.collapsible-header::after {
  content: "⊢";
  position: absolute;
  left: 60px;
  transition: transform 0.3s ease;
}

div.collapsible-content {
  border: 1px solid white;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

div.collapsible.expanded .collapsible-content {
  max-height: 500px; /* Adjust this value depending on the content's height */
  border: 1px solid lightgrey;
}

div.collapsible.expanded .collapsible-header::after {
  transform: rotate(90deg); /* Rotate to show ">" when expanded */
}
</style><script>
      
window.onload = () => {

    // Don't show hovers inside of closed tactic states
    function blockedByTactic(elem) {
      let parent = elem.parentNode;
      while (parent && "classList" in parent) {
        if (parent.classList.contains("tactic")) {
          const toggle = parent.querySelector("input.tactic-toggle");
          if (toggle) {
            return !toggle.checked;
          }
        }
        parent = parent.parentNode;
      }
      return false;
    }

    function blockedByTippy(elem) {
      // Don't show a new hover until the old ones are all closed.
      // Scoped to the nearest "top-level block" to avoid being O(n) in the size of the document.
      var block = elem;
      const topLevel = new Set(["section", "body", "html", "nav", "header"]);
      while (block.parentNode && !topLevel.has(block.parentNode.nodeName.toLowerCase())) {
        block = block.parentNode;
      }
      for (const child of block.querySelectorAll(".token, .has-info")) {
        if (child._tippy && child._tippy.state.isVisible) { return true };
      }
      return false;
    }

    for (const c of document.querySelectorAll(".hl.lean .token")) {
        if (c.dataset.binding != "") {
            c.addEventListener("mouseover", (event) => {
                if (blockedByTactic(c)) {return;}
                const context = c.closest(".hl.lean").dataset.leanContext;
                for (const example of document.querySelectorAll(".hl.lean")) {
                    if (example.dataset.leanContext == context) {
                        for (const tok of example.querySelectorAll(".token")) {
                            if (c.dataset.binding == tok.dataset.binding) {
                                tok.classList.add("binding-hl");
                            }
                        }
                    }
                }
            });
        }
        c.addEventListener("mouseout", (event) => {
            for (const tok of document.querySelectorAll(".hl.lean .token")) {
                tok.classList.remove("binding-hl");
            }
        });
    }
    /* Render docstrings */
    if ('undefined' !== typeof marked) {
        for (const d of document.querySelectorAll("code.docstring, pre.docstring")) {
            const str = d.innerText;
            const html = marked.parse(str);
            const rendered = document.createElement("div");
            rendered.classList.add("docstring");
            rendered.innerHTML = html;
            d.parentNode.replaceChild(rendered, d);
        }
    }
    // Add hovers
    fetch("/-verso-docs.json").then((resp) => resp.json()).then((versoDocData) => {

      const defaultTippyProps = {
        /* DEBUG -- remove the space: * /
        onHide(any) { return false; },
        trigger: "click",
        // */
        theme: "lean",
        maxWidth: "none",
        appendTo: () => document.body,
        interactive: true,
        delay: [100, null],
        ignoreAttributes: true,
        onShow(inst) {
          if (inst.reference.querySelector(".hover-info") || "versoHover" in inst.reference.dataset) {
            if (blockedByTactic(inst.reference)) { return false };
            if (blockedByTippy(inst.reference)) { return false; }
          } else { // Nothing to show here!
            return false;
          }
        },
        content (tgt) {
          const content = document.createElement("span");
          content.className = "hl lean";
          content.style.display = "block";
          content.style.maxHeight = "300px";
          content.style.overflowY = "auto";
          content.style.overflowX = "hidden";
          const hoverId = tgt.dataset.versoHover;
          const hoverInfo = tgt.querySelector(".hover-info");
          if (hoverId) { // Docstrings from the table
            // TODO stop doing an implicit conversion from string to number here
            let data = versoDocData[hoverId];
            if (data) {
              const info = document.createElement("span");
              info.className = "hover-info";
              info.style.display = "block";
              info.innerHTML = data;
              content.appendChild(info);
              /* Render docstrings - TODO server-side */
              if ('undefined' !== typeof marked) {
                  for (const d of content.querySelectorAll("code.docstring, pre.docstring")) {
                      const str = d.innerText;
                      const html = marked.parse(str);
                      const rendered = document.createElement("div");
                      rendered.classList.add("docstring");
                      rendered.innerHTML = html;
                      d.parentNode.replaceChild(rendered, d);
                  }
              }
            } else {
              content.innerHTML = "Failed to load doc ID: " + hoverId;
            }
          } else if (hoverInfo) { // The inline info, still used for compiler messages
            content.appendChild(hoverInfo.cloneNode(true));
          }
          return content;
        }
      };

      const addTippy = (selector, props) => {
        tippy(selector, Object.assign({}, defaultTippyProps, props));
      };
      addTippy('.hl.lean .const.token, .hl.lean .keyword.token, .hl.lean .literal.token', {theme: 'lean'});
      addTippy('.hl.lean .has-info.warning', {theme: 'warning message'});
      addTippy('.hl.lean .has-info.info', {theme: 'info message'});
      addTippy('.hl.lean .has-info.error', {theme: 'error message'});

      tippy('.hl.lean .tactic', {
        allowHtml: true,
        /* DEBUG -- remove the space: * /
        onHide(any) { return false; },
        trigger: "click",
        // */
        maxWidth: "none",
        onShow(inst) {
          const toggle = inst.reference.querySelector("input.tactic-toggle");
          if (toggle && toggle.checked) {
            return false;
          }
          if (blockedByTippy(inst.reference)) { return false; }
        },
        theme: "tactic",
        placement: 'bottom-start',
        content (tgt) {
          const content = document.createElement("span");
          const state = tgt.querySelector(".tactic-state").cloneNode(true);
          state.style.display = "block";
          content.appendChild(state);
          content.style.display = "block";
          content.className = "hl lean popup";
          return content;
        }
      });
  });
}
</script>
    </head>
  <body>
    <div class="with-toc">
      <header>
        <h1>
          <a href="../../">Scientific Computing in Lean</a></h1>
        <div id="controls">
          <label for="toggle-toc" id="toggle-toc-click">📖</label></div>
        <div id="print">
          <span>🖨</span></div>
        </header>
      <nav id="toc">
        <input type="checkbox" id="toggle-toc" checked="checked"><ol>
          <li>
            <a href="../../Introduction#Scientific-Computing-in-Lean--Introduction">Introduction</a><ol>
              <li>
                <a href="../../Introduction/About#Scientific-Computing-in-Lean--Introduction--About">About</a></li>
              <li>
                <a href="../../Introduction/Introduction#Scientific-Computing-in-Lean--Introduction--Introduction">Introduction</a><ol>
                  <li>
                    <a href="../../Introduction/Introduction#Scientific-Computing-in-Lean--Introduction--Introduction--Why-Lean-for-Scientific-Computing">Why Lean for Scientific Computing?</a></li>
                  </ol>
                </li>
              </ol>
            </li>
          <li>
            <a href="../../Working-with-Arrays#Scientific-Computing-in-Lean--Working-with-Arrays">Working with Arrays</a><ol>
              <li>
                <a href="../../Working-with-Arrays/Basic-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Basic-Operations">Basic Operations</a><ol>
                  <li>
                    <a href="../../Working-with-Arrays/Basic-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Basic-Operations--Reshaping-Arrays">Reshaping Arrays</a></li>
                  <li>
                    <a href="../../Working-with-Arrays/Basic-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Basic-Operations--Exercises">Exercises</a></li>
                  </ol>
                </li>
              <li>
                <a href="../../Working-with-Arrays/Tensor-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Tensor-Operations">Tensor Operations</a><ol>
                  <li>
                    <a href="../../Working-with-Arrays/Tensor-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Tensor-Operations--Transformations-and-Reductions">Transformations and Reductions</a></li>
                  <li>
                    <a href="../../Working-with-Arrays/Tensor-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Tensor-Operations--Convolution-and-Operations-on-Indices">Convolution and Operations on Indices</a></li>
                  <li>
                    <a href="../../Working-with-Arrays/Tensor-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Tensor-Operations--Pooling-and-Difficulties-with-Dependent-Types">Pooling and Difficulties with Dependent Types</a></li>
                  <li>
                    <a href="../../Working-with-Arrays/Tensor-Operations#Scientific-Computing-in-Lean--Working-with-Arrays--Tensor-Operations--Simple-Neural-Network">Simple Neural Network</a></li>
                  </ol>
                </li>
              <li>
                <a href="../../Working-with-Arrays/Optimizing-Array-Expressions#Scientific-Computing-in-Lean--Working-with-Arrays--Optimizing-Array-Expressions">Optimizing Array Expressions</a><ol>
                  <li>
                    <a href="../../Working-with-Arrays/Optimizing-Array-Expressions#Scientific-Computing-in-Lean--Working-with-Arrays--Optimizing-Array-Expressions--Loop-Fusion">Loop Fusion</a></li>
                  <li>
                    <a href="../../Working-with-Arrays/Optimizing-Array-Expressions#Scientific-Computing-in-Lean--Working-with-Arrays--Optimizing-Array-Expressions--Optimizing-Array-Indexing">Optimizing Array Indexing</a></li>
                  </ol>
                </li>
              </ol>
            </li>
          <li>
            <a href="../../-Differentiation#Scientific-Computing-in-Lean---Differentiation">🚧 Differentiation</a><ol>
              <li>
                <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation">Symbolic Differentiation</a><ol>
                  <li>
                    <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Notation">Notation</a></li>
                  <li>
                    <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Examples">Examples</a></li>
                  <li>
                    <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Gradient">Gradient</a></li>
                  <li>
                    <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Derivative-Rules">Derivative Rules</a></li>
                  <li>
                    <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Differentiating-Division-Log-Sqrt-">Differentiating Division, Log, Sqrt, ...</a></li>
                  <li>
                    <a href="../../-Differentiation/Symbolic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Abstract-Vector-Spaces">Abstract Vector Spaces</a></li>
                  </ol>
                </li>
              <li>
                <a href="../../-Differentiation/Automatic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Automatic-Differentiation">Automatic Differentiation</a><ol>
                  <li>
                    <a href="../../-Differentiation/Automatic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Automatic-Differentiation--Forward-Mode">Forward Mode</a></li>
                  <li>
                    <a href="../../-Differentiation/Automatic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Automatic-Differentiation--Reverse-Mode">Reverse Mode</a></li>
                  <li>
                    <a href="../../-Differentiation/Automatic-Differentiation#Scientific-Computing-in-Lean---Differentiation--Automatic-Differentiation--Derivatives-of-Neural-Network-Layers">Derivatives of Neural Network Layers</a></li>
                  </ol>
                </li>
              <li>
                <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation">Function Transformation</a><ol>
                  <li>
                    <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation--User-Defined-Function-Transformation">User Defined Function Transformation</a></li>
                  <li>
                    <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation--Lambda-Theorems">Lambda Theorems</a></li>
                  <li>
                    <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation--Function-Theorems">Function Theorems</a></li>
                  <li>
                    <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation--Free-Variable-Theorems">Free Variable Theorems</a></li>
                  <li>
                    <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation--Morphism-Theorems">Morphism Theorems</a></li>
                  <li>
                    <a href="../../-Differentiation/Function-Transformation#Scientific-Computing-in-Lean---Differentiation--Function-Transformation--Advanced-Function-Theorems">Advanced Function Theorems</a></li>
                  </ol>
                </li>
              </ol>
            </li>
          <li>
            <a href="../../Examples#Scientific-Computing-in-Lean--Examples">Examples</a><ol>
              <li>
                <a href="../../Examples/Harmonic-Oscillator#Scientific-Computing-in-Lean--Examples--Harmonic-Oscillator">Harmonic Oscillator</a></li>
              </ol>
            </li>
          </ol>
        </nav>
      <main><section>
          <h1>
            Symbolic Differentiation</h1>
          <p>
            Differentiation is at the heart of many problems in scientific computing, from optimizing functions to solving differential equations. Computing derivatives is a mechanical process but very error prone when done manually. In this chapter, we will explore how we can compute derivatives of expressions and programs automatically.</p>
          <p>
            Let's recall what derivative is, for a function <code>f : ℝ → ℝ</code> we define it derivative as</p>
          <p>
            $$f'(x) = \lim_{h → 0} \frac{f(x+h) - f(x)}{h}
$$</p>
          <p>
            The mathematical library <strong>Mathlib</strong> defines derivative <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span></code> for a general function <code>f : X → Y</code> from some vector spaces <code>X</code> and <code>Y</code>. The derivative of <code>f</code> at point <code>x : X</code> in direction <code>dx : X</code> is</p>
          <p>
            $$\texttt{fderiv ℝ f x dx} = \lim_{h → 0} \frac{f(x+h\cdot dx) - f(x)}{h}
$$</p>
          <p>
            <strong>SciLean</strong> provides tactic <code>fun_trans</code> which can compute derivatives. The name <code>fun_trans</code> stands for 'function transformation' and differentiations is just one example of function transformation. We will talk about general function transformations later in the book.</p>
          <p>
            One of the simplest examples of a derivative is the derivative of \(x^n\) which is equal to \(n x^{n-1}\). Let's compute it using <code>fun_trans</code> tactic</p>
          <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-1524" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">↑n * x ^ (n - 1) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-1553">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-1573">fun</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.20" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="var token" data-binding="var-_uniq.20" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-1560">rewrite_by</span> <span class="tactic"><label for="tactic-state-3389842003703735567-1611-1620"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-1611">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-3389842003703735567-1611-1620"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Nat" data-verso-hover="5">ℕ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type">↑<span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>(<span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span>1)</span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
            <pre>↑n * x ^ (n - 1) : ℝ
</pre></div>
          <div class="TODO">
            <p>
              Add a link to an interactive code editor and encourage reader to differentiate more complicated expressions involving sin, cos, exp, ... but warn about log or division.</p>
            </div>
          <section>
            <h2 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Notation">
              Notation</h2>
            <p>
              Writing <code>fderiv ℝ (fun x =&gt; f x)</code> is somewhat tedious so <strong>SciLean</strong> makes our life easier by introducing a nice notation <code>∂ x, f x</code> for differentiating <code>(f x)</code> w.r.t. <code>x</code>.</p>
            <p>
              Before we explore this notation further we have to mention that  <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span></code> can also compute complex derivatives with <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span> <span class="unknown token" data-binding="">ℂ</span></code> instead of <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span> <span class="unknown token" data-binding="">ℝ</span></code>. However, most of the time we work exclusively with real derivative so we can inform Lean that the default choce of the scalar field are real numbers using the following command</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-2405">set_default_scalar</span> <span class="unknown token" data-binding="">ℝ</span>
<span class="unknown token" data-binding=""></span></code><p>
              Now Lean knows that we want real derivative when we write <code>∂ x, f x</code>.</p>
            <p>
              Using this notation we can compute again the above derivative</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-2593" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; ↑n * x ^ (n - 1) : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-2612">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.10" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.10" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-2619">rewrite_by</span> <span class="tactic"><label for="tactic-state-15095968220163791515-2651-2660"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-2651">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-15095968220163791515-2651-2660"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Nat" data-verso-hover="5">ℕ</span></td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.3419" data-verso-hover="236">x</span> =&gt; ↑<span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.3419" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>(<span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span>1)</span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; ↑n * x ^ (n - 1) : ℝ → ℝ
</pre></div>
            <p>
              Because we did not specify the point where we want to compute the derivative we obtained a function in <code>x</code>. We can specify the point where we want to compute the derivative with <code>∂ (x:=x₀), ...</code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-2958" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">↑n * x₀ ^ (n - 1) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-2990">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.13" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.13" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-2997">rewrite_by</span> <span class="tactic"><label for="tactic-state-10093373467645080824-3029-3038"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-3029">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-10093373467645080824-3029-3038"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Nat" data-verso-hover="5">ℕ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x₀</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type">↑<span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">x₀</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>(<span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span>1)</span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>↑n * x₀ ^ (n - 1) : ℝ
</pre></div>
            <p>
              Writing <code>rewrite_by fun_trans</code> every time we want to diferentiate an expression gets a bit tedious. We can add an exclamation mark after <code>∂</code> to indicate that we want to run <code>fun_trans</code> tactic to compute the derivative.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-3346" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; ↑n * x ^ (n - 1) : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-3365">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.10" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.10" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; ↑n * x ^ (n - 1) : ℝ → ℝ
</pre></div>
            <p>
              We can differentiate w.r.t to a vector valued variable <code>(x : ℝ×ℝ)</code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; fun dx =&gt;L[ℝ] 2 * ⟪dx, x⟫_ℝ : ℝ × ℝ → ℝ × ℝ →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-3567">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.8" data-verso-hover="240">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.8" data-verso-hover="240">x</span><span class="unknown token" data-binding="">‖₂²</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; fun dx =&gt;L[ℝ] 2 * ⟪dx, x⟫_ℝ : ℝ × ℝ → ℝ × ℝ →L[ℝ] ℝ
</pre></div>
            <p>
              For derivatives w.r.t. a vector valued variable we have to also specify the direction in which we differentiate. Therefore in the above we obtained derivative as a function of the position <code>x</code> and direction <code>dx</code>. Furthermore, the notation <code>fun dx =&gt;L[ℝ] ...</code> indicates that the function is linear function in <code>dx</code> and similarly <code>X →L[ℝ] Y</code> stands for the space of ℝ-linear functions from <code>X</code> to <code>Y</code>.</p>
            <p>
              If we want to specify the position and the direction in which we want to compute the derivatives we use the notation <code>∂ (x:=x₀;dx₀), f x</code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-4306" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="240">dx₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">2 * ⟪dx₀, x₀⟫_ℝ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4339">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.29" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">;</span><span class="var token" data-binding="var-_uniq.8" data-verso-hover="240">dx₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.29" data-verso-hover="240">x</span><span class="unknown token" data-binding="">‖₂²</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>2 * ⟪dx₀, x₀⟫_ℝ : ℝ
</pre></div>
            <p>
              To summarize all the different variants. For function of a scalar valued argument</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-4536" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.205" data-verso-hover="241">f</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.207" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ f : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4577">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.205" data-verso-hover="241">f</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ x, f x : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4590">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.214" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.205" data-verso-hover="241">f</span> <span class="var token" data-binding="var-_uniq.214" data-verso-hover="236">x</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=x₀), f x : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4608">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.410" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.207" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.205" data-verso-hover="241">f</span> <span class="var token" data-binding="var-_uniq.410" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><p>
              For function of a vector valued argument</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-4688" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.645" data-verso-hover="242">f</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.649" data-verso-hover="240">x₀</span> <span class="var token" data-binding="var-_uniq.653" data-verso-hover="240">dx₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ f : ℝ × ℝ → ℝ × ℝ →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4745">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.645" data-verso-hover="242">f</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ x, f x : ℝ × ℝ → ℝ × ℝ →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4758">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.347" data-verso-hover="240">x</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.645" data-verso-hover="242">f</span> <span class="var token" data-binding="var-_uniq.347" data-verso-hover="240">x</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=x₀), f x : ℝ × ℝ →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4776">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.658" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.649" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.645" data-verso-hover="242">f</span> <span class="var token" data-binding="var-_uniq.658" data-verso-hover="240">x</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">(∂ (x:=x₀), f x) dx₀ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4802">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.981" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.649" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">;</span><span class="var token" data-binding="var-_uniq.653" data-verso-hover="240">dx₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.645" data-verso-hover="242">f</span> <span class="var token" data-binding="var-_uniq.981" data-verso-hover="240">x</span>
<span class="unknown token" data-binding=""></span></code><p>
              There is nothing stopping us from applying derivative multiple times to compute higher order derivatives</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; 2 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-4969">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2620" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.2620" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; 2 : ℝ → ℝ
</pre></div>
            <section>
              <h3 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Notation--Exercises">
                Exercises</h3>
              <ol start="1">
                <li>
                  <p>
                    Express first derivative of <code>f : ℝ → ℝ → ℝ</code> in the first and the second argument. Also express derivative in both arguments at the same time.</p>
                  </li>
                </ol>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-5252" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.614" data-verso-hover="243">f</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.616" data-verso-hover="236">x₀</span> <span class="var token" data-binding="var-_uniq.618" data-verso-hover="236">y₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>

-- first argument
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=x₀), f x y₀ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5324">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.25" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.616" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.614" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.25" data-verso-hover="236">x</span> <span class="var token" data-binding="var-_uniq.618" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=x₀), f x y₀ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5357">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.614" data-verso-hover="243">f</span> <span class="unknown token" data-binding="">·</span> <span class="var token" data-binding="var-_uniq.618" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.616" data-verso-hover="236">x₀</span>

-- second agument
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (y:=y₀), f x₀ y : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5404">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.424" data-verso-hover="236">y</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.618" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.614" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.616" data-verso-hover="236">x₀</span> <span class="var token" data-binding="var-_uniq.424" data-verso-hover="236">y</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=y₀), f x₀ x : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5437">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.614" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.616" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">·</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.618" data-verso-hover="236">y₀</span>

-- both arguments
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=(x₀, y₀)),
  match x with
  | (x, y) =&gt; f x y : ℝ × ℝ →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5484">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.852" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.853" data-verso-hover="236">y</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.616" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.618" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.614" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.852" data-verso-hover="236">x</span> <span class="var token" data-binding="var-_uniq.853" data-verso-hover="236">y</span>
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              <ol start="2">
                <li>
                  <p>
                    For <code>(g : ℝ×ℝ → ℝ)</code>, express derivative of <code>g (x,y)</code> in <code>x</code>.</p>
                  </li>
                </ol>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-5627" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.526" data-verso-hover="242">g</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.528" data-verso-hover="236">x₀</span> <span class="var token" data-binding="var-_uniq.530" data-verso-hover="236">y₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">(∂ (xy:=(x₀, y₀)), g xy) (1, 0) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5678">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.29" data-verso-hover="240">xy</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.528" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.530" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">;</span><span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.526" data-verso-hover="242">g</span> <span class="var token" data-binding="var-_uniq.29" data-verso-hover="240">xy</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">(∂ g (x₀, y₀)) (1, 0) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5719">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.526" data-verso-hover="242">g</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.528" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.530" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=x₀), g (x, y₀) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5750">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1041" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.528" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.526" data-verso-hover="242">g</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1041" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.530" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              <ol start="3">
                <li>
                  <p>
                    Express second derivatives of <code>f : ℝ → ℝ → ℝ</code> in the first and the second argument.</p>
                  </li>
                </ol>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-5911" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.488" data-verso-hover="243">f</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.490" data-verso-hover="236">x₀</span> <span class="var token" data-binding="var-_uniq.492" data-verso-hover="236">y₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x':=x₀), ∂ (x'':=x'), f x'' y₀ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-5964">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.25" data-verso-hover="236">x'</span><span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.490" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.232" data-verso-hover="236">x''</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.25" data-verso-hover="236">x'</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.488" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.232" data-verso-hover="236">x''</span> <span class="var token" data-binding="var-_uniq.492" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (∂ x, f x y₀) x₀ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-6016">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.488" data-verso-hover="243">f</span> <span class="unknown token" data-binding="">·</span> <span class="var token" data-binding="var-_uniq.492" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.490" data-verso-hover="236">x₀</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (y':=y₀), ∂ (y'':=y'), f x₀ y'' : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-6051">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.497" data-verso-hover="236">y'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.492" data-verso-hover="236">y₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.704" data-verso-hover="236">y''</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.497" data-verso-hover="236">y'</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.488" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.490" data-verso-hover="236">x₀</span> <span class="var token" data-binding="var-_uniq.704" data-verso-hover="236">y''</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (∂ x, f x₀ x) y₀ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-6102">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.488" data-verso-hover="243">f</span> <span class="var token" data-binding="var-_uniq.490" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">·</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.492" data-verso-hover="236">y₀</span>
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              <ol start="4">
                <li>
                  <p>
                    Let \(L(t,x)\) be a function of time and space and <code>y(t)</code> a function of time. Express \( \frac{d}{dt} L(t, y(t)) \) and \( \frac{\partial}{\partial t} L(t, y(t)) \) in Lean. What is the difference between these two expressions? </p>
                  </li>
                </ol>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-6417" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.18" data-verso-hover="243">L</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.22" data-verso-hover="241">y</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.24" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>

-- d/dt L
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (t':=t), L t' (y t') : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-6491">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.29" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.24" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.18" data-verso-hover="243">L</span> <span class="var token" data-binding="var-_uniq.29" data-verso-hover="236">t'</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.22" data-verso-hover="241">y</span> <span class="var token" data-binding="var-_uniq.29" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">)</span>

-- ∂/∂t L
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (t':=t), L t' (y t) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-6538">#check</span></span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.230" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.24" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.18" data-verso-hover="243">L</span> <span class="var token" data-binding="var-_uniq.230" data-verso-hover="236">t'</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.22" data-verso-hover="241">y</span> <span class="var token" data-binding="var-_uniq.24" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><p>
                    Because SciLean's notation forces you to be a bit more explicit, there is no need to distinguish between \( \frac{d}{dt} \) and \( \frac{\partial}{\partial t} \). Lots of pain and suffering has been infliced on generations of physics students because of the ambiguity of partial derivative notation.</p>
                  </div>
                </div>
              <ol start="4">
                <li>
                  <p>
                    Express one dimensional Euler-Lagrange equation in Lean</p>
                  </li>
                </ol>
              <p>
                $$\frac{d}{dt} \frac{\partial L}{\partial \dot x}(x(t),\dot x(t)) -  \frac{\partial L}{\partial x}(x(t), \dot x(t))
$$</p>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-7103" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="243">L</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.10" data-verso-hover="241">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.12" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">let v := ∂ x;
∂ (t':=t), ∂ (v':=v t'), L (x t') v' - ∂ (x':=x t), L x' (v t) : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-7167">#check</span></span> 
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-7177" data-verso-hover="80">let</span> <span class="var token" data-binding="var-_uniq.217" data-verso-hover="241">v</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.10" data-verso-hover="241">x</span>
  <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.225" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.12" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.261" data-verso-hover="236">v'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.217" data-verso-hover="241">v</span> <span class="var token" data-binding="var-_uniq.225" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="243">L</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.10" data-verso-hover="241">x</span> <span class="var token" data-binding="var-_uniq.225" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.261" data-verso-hover="236">v'</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">-</span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.281" data-verso-hover="236">x'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.10" data-verso-hover="241">x</span> <span class="var token" data-binding="var-_uniq.12" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="243">L</span> <span class="var token" data-binding="var-_uniq.281" data-verso-hover="236">x'</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.217" data-verso-hover="241">v</span> <span class="var token" data-binding="var-_uniq.12" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              </section>
            </section>
          <section>
            <h2 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Examples">
              Examples</h2>
            <p>
              Let's put computing derivatives to some practical use. We will demonstrate how to use <strong>SciLean</strong> symbolic differentiations to solve few common tasks in scientific computing and physics.</p>
            <section>
              <h3 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Examples--Newtons-solver">
                Newton's solver</h3>
              <p>
                Solving non-linear equation \( f(x) = 0 \) is a very common problem in scientific computing. Often this can be done only approximately and a popular tool to do so is Newton's method. It is an interative process that starts with an initial guess \(x₀\) which is incrementally improved by the following rule</p>
              <p>
                $$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}
$$</p>
              <p>
                We can use Newton's method to compute sqruare root of \(y\) by choosing \( f(x) = x^2 - y\).</p>
              <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-8032">def</span> <span class="const token" data-binding="const-mySqrt" data-verso-hover="244">mySqrt</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">steps</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="81">y</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> <span class="unknown token" data-binding="">:=</span> <span class="const token" data-binding="const-Id.run" data-verso-hover="6">Id.run</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.do-8087">do</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doLet-8092">let</span> <span class="var token" data-binding="var-_uniq.115" data-verso-hover="245">f</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-8101">fun</span> <span class="var token" data-binding="var-_uniq.33" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="var token" data-binding="var-_uniq.33" data-verso-hover="81">x</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span> <span class="unknown token" data-binding="">-</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="81">y</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doLet-8120">let</span> <span class="keyword token" data-binding="kw-occ-null-8124">mut</span> <span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">1.0</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doFor-8139" data-verso-hover="8">for</span> <span class="unknown token" data-binding="">_</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doForDecl-8143">in</span> <span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">:</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">steps</span><span class="unknown token" data-binding="">]</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doFor-8139" data-verso-hover="8">do</span>
    <span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">-</span> <span class="var token" data-binding="var-_uniq.115" data-verso-hover="245">f</span> <span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">/</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span> <span class="var token" data-binding="var-_uniq.115" data-verso-hover="245">f</span> <span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-8181">rewrite_by</span> <span class="tactic"><label for="tactic-state-17103945928595264540-8204-8220"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-8204">fun_trans</span><span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-17103945928595264540-8204-8220"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">steps</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Nat" data-verso-hover="5">ℕ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="81">y</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.115" data-verso-hover="245">f</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> → <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> := <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.6686" data-verso-hover="81">x</span> =&gt; <span class="var token" data-binding="var-_uniq.6686" data-verso-hover="81">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="81">y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> := 1.0</td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.157" data-verso-hover="247">col✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Std.Range" data-verso-hover="248">Std.Range</span> := { <span class="const token" data-binding="const-Std.Range.start" data-verso-hover="249">start</span> := 0, <span class="const token" data-binding="const-Std.Range.stop" data-verso-hover="249">stop</span> := <span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">steps</span>, <span class="const token" data-binding="const-Std.Range.step" data-verso-hover="249">step</span> := 1 }</td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.201" data-verso-hover="4">x✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Nat" data-verso-hover="5">ℕ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.204" data-verso-hover="81">r✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> := <span class="var token" data-binding="var-_uniq.204" data-verso-hover="81">r✝</span></td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type">2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span></span></span></div></div></span><span class="unknown token" data-binding="">)</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doReturn-8224" data-verso-hover="9">return</span> <span class="var token" data-binding="var-_uniq.207" data-verso-hover="81">x</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">1.414214
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-8234">#eval</span></span> <span class="const token" data-binding="const-mySqrt" data-verso-hover="250">mySqrt</span> <span class="unknown token" data-binding="">10</span> <span class="unknown token" data-binding="">2.0</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
                <pre>1.414214
</pre></div>
              <div class="TODO">
                <p>
                  In <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-mySqrt" data-verso-hover="250">mySqrt</span></code> we should use <code>(∂! f x)</code> notation but unfortunatelly it is currently broken for some reason.</p>
                </div>
              <p>
                You might feel a bit unconfortable here are we are differentiating a function defined on floating point numbers. If you think that can't be formally correct then you are right. We will discuss this issue in a later chapter "Working with Real Numbers".</p>
              <section>
                <h4 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Examples--Newtons-solver--Exercises">
                  Exercises</h4>
                <ol start="1">
                  <li>
                    <p>
                      try to solve different equations, for example <code>exp x = y</code> to obtain <code>log</code>, <code>x*exp x = y</code> to obtain Lambert W function or some polynomial.</p>
                    </li>
                  <li>
                    <p>
                      measure relative,\(\left| \frac{f(x_n)}{x_n} \right| \), and absolute error \( \left| f(x_n) \right| \) and use them for stopping criteria.</p>
                    </li>
                  <li>
                    <p>
                      A difficult exercise is to define a general <code>newtonSolve</code> function that takes an arbitrary function <code>f : Float → Float</code> and uring elaboration synthesizes its derivative. Add multiple hints, 1. use <code>infer_var</code> trick, 2. state explicitly how the arguments should look like</p>
                    </li>
                  </ol>
                <div class="collapsible" onclick="this.classList.toggle('expanded');">
                  <div class="collapsible-header">
                    Solution</div>
                  <div class="collapsible-content">
                    <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-9288">set_default_scalar</span> <span class="unknown token" data-binding="">Float</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-9313">def</span> <span class="const token" data-binding="const-newtonSolve" data-verso-hover="251">newtonSolve</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.527" data-verso-hover="4">steps</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.529" data-verso-hover="81">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">)</span>
    <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.533" data-verso-hover="93">f</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> <span class="unknown token" data-binding="">→</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.537" data-verso-hover="93">f'</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> <span class="unknown token" data-binding="">→</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">}</span>
    <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.809" data-verso-hover="252">hf</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.537" data-verso-hover="93">f'</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.533" data-verso-hover="93">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.binderTactic-9430">by</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-9436" data-verso-hover="253">unfold</span> <span class="unknown token" data-binding="">deriv</span><span class="unknown token" data-binding="">;</span> <span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-9450">fun_trans</span><span class="unknown token" data-binding="">;</span> <span class="keyword token" data-binding="kw-occ-SciLean.inferVar-9461">infer_var</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span> <span class="unknown token" data-binding="">:=</span> <span class="const token" data-binding="const-Id.run" data-verso-hover="6">Id.run</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.do-9490">do</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doLet-9495">let</span> <span class="keyword token" data-binding="kw-occ-null-9499">mut</span> <span class="var token" data-binding="var-_uniq.921" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.529" data-verso-hover="81">x₀</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doFor-9515" data-verso-hover="8">for</span> <span class="unknown token" data-binding="">_</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doForDecl-9519">in</span> <span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">:</span><span class="var token" data-binding="var-_uniq.527" data-verso-hover="4">steps</span><span class="unknown token" data-binding="">]</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doFor-9515" data-verso-hover="8">do</span>
    <span class="var token" data-binding="var-_uniq.921" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.921" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">-</span> <span class="var token" data-binding="var-_uniq.533" data-verso-hover="93">f</span> <span class="var token" data-binding="var-_uniq.921" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">/</span> <span class="var token" data-binding="var-_uniq.537" data-verso-hover="93">f'</span> <span class="var token" data-binding="var-_uniq.921" data-verso-hover="81">x</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.doReturn-9563" data-verso-hover="9">return</span> <span class="var token" data-binding="var-_uniq.921" data-verso-hover="81">x</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">1.414214
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-9573">#eval</span></span> <span class="const token" data-binding="const-newtonSolve" data-verso-hover="254">newtonSolve</span> <span class="unknown token" data-binding="">10</span> <span class="unknown token" data-binding="">1.0</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-9599">fun</span> <span class="var token" data-binding="var-_uniq.1202" data-verso-hover="81">x</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="var token" data-binding="var-_uniq.1202" data-verso-hover="81">x</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span> <span class="unknown token" data-binding="">-</span> <span class="unknown token" data-binding="">2.0</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code></div>
                  </div>
                </section>
              </section>
            <section>
              <h3 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Examples--Kinematics">
                Kinematics</h3>
              <p>
                We can also use <strong>SciLean</strong>'s symbolic differentiation to prove some basic theorems from physics. For example we can state the second Newton's law</p>
              <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-9848">def</span> <span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="255">NewtonSecondLaw</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="241">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.10" data-verso-hover="241">F</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> <span class="sort token" data-binding="">Prop</span> <span class="unknown token" data-binding="">:=</span>
  <span class="unknown token" data-binding="">∀</span> <span class="var token" data-binding="var-_uniq.18" data-verso-hover="236">t</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">*</span> <span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="241">x</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.18" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">=</span> <span class="var token" data-binding="var-_uniq.10" data-verso-hover="241">F</span> <span class="var token" data-binding="var-_uniq.18" data-verso-hover="236">t</span>
<span class="unknown token" data-binding=""></span></code><p>
                saying that for a particle with mass <code>m</code> under the influence of force <code>F</code> has trajectory <code>x</code> if the mass times the acceleration <code>deriv (∂ x) t</code>, i.e. the second derivative of trajectory, is equal to the force <code>F t</code>.</p>
              <p>
                We can show that under constant force <code>f</code> a particle with mass <code>m</code> has trajectory <code>(fun t =&gt; 1/2 * f/m * t^2)</code></p>
              <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-10302">example</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.37" data-verso-hover="256">hm</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">≠</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span>
    <span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="257">NewtonSecondLaw</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-10362">fun</span> <span class="var token" data-binding="var-_uniq.41" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">/</span><span class="unknown token" data-binding="">2</span> <span class="unknown token" data-binding="">*</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">*</span> <span class="var token" data-binding="var-_uniq.41" data-verso-hover="236">t</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-10389">fun</span> <span class="unknown token" data-binding="">_</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-11136463473028576745-10404-10406"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-10404" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-11136463473028576745-10404-10406"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.37" data-verso-hover="256">hm</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="257">NewtonSecondLaw</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.14851" data-verso-hover="236">t</span> =&gt; 1 / 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.14851" data-verso-hover="236">t</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2) <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.14894" data-verso-hover="236">x</span> =&gt; <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span></span></span></div></div></span>

  <span class="tactic"><label for="tactic-state-10220475187341847376-10410-10432"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-10410" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="257">NewtonSecondLaw</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-10220475187341847376-10410-10432"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.37" data-verso-hover="256">hm</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∀ (<span class="var token" data-binding="var-_uniq.14850" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>), <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>∂ (∂ <span class="var token" data-binding="var-_uniq.14865" data-verso-hover="236">t</span>, 1 / 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.14865" data-verso-hover="236">t</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2) <span class="var token" data-binding="var-_uniq.14850" data-verso-hover="236">t</span><span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>(<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.14903" data-verso-hover="236">x</span> =&gt; <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span>) <span class="var token" data-binding="var-_uniq.14850" data-verso-hover="236">t</span></span></span></div></div></span>
  -- compute derivatives
  <span class="tactic"><label for="tactic-state-2773839945280178276-10460-10477"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-10460">fun_trans</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-2773839945280178276-10460-10477"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.37" data-verso-hover="256">hm</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>(2<span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>2)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span></span></span></div></div></span>
  -- finish algebraic simplifications
  <span class="tactic"><label for="tactic-state-13705107788213365195-10518-10528"><span class="keyword token" data-binding="kw-occ-Mathlib.Tactic.FieldSimp.fieldSimp-10518" data-verso-hover="260">field_simp</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-13705107788213365195-10518-10528"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.37" data-verso-hover="256">hm</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>(<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>2)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">f</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>)</span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-10530-10534"><span class="keyword token" data-binding="kw-occ-Mathlib.Tactic.RingNF.ring-10530" data-verso-hover="261">ring</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-10530-10534"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><div class="TODO">
                <p>
                  <strong>Warning</strong>: currently the tactic <code>fun_trans</code> uses theorems that are not fully proven therefore the above proof is not completely formal proof. If you do not like this you are welcome to improve SciLean by helping out proving its theorems. Lots of theorems should be just matter of finding the right mathlib theorem.</p>
                </div>
              <section>
                <h4 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Examples--Kinematics--Exercises">
                  Exercises</h4>
                <ol start="1">
                  <li>
                    <p>
                      show that trajectory <code>x := fun t =&gt; (cos t, sin t)</code> satisfies differential equation <code>∂ x t = (- (x t).2, (x t).1)</code></p>
                    </li>
                  </ol>
                <div class="collapsible" onclick="this.classList.toggle('expanded');">
                  <div class="collapsible-header">
                    Solution</div>
                  <div class="collapsible-content">
                    <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-11031" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span> <span class="unknown token" data-binding="">Scalar</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-11051">def</span> <span class="const token" data-binding="const-ode" data-verso-hover="262">ode</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="263">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">∀</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">t</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span> <span class="var token" data-binding="var-_uniq.6" data-verso-hover="263">x</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">-</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="263">x</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">.</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="263">x</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">.</span><span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">)</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-11126">example</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-ode" data-verso-hover="264">ode</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-11141">fun</span> <span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-SciLean.Scalar.cos" data-verso-hover="265">cos</span> <span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">t</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-556938093835688537-11169-11171"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-11169" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-556938093835688537-11169-11171"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-ode" data-verso-hover="264">ode</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span> =&gt; (<span class="const token" data-binding="const-SciLean.Scalar.cos" data-verso-hover="265">cos</span> <span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span>, <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span>)</span></span></div></div></span> <span class="tactic"><label for="tactic-state-18219262327836496261-11172-11188"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-11172" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-ode" data-verso-hover="264">ode</span> <span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-18219262327836496261-11172-11188"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∀ (<span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>), (∂ (<span class="var token" data-binding="var-_uniq.3248" data-verso-hover="236">t</span>:=<span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span>), (<span class="const token" data-binding="const-SciLean.Scalar.cos" data-verso-hover="265">cos</span> <span class="var token" data-binding="var-_uniq.3248" data-verso-hover="236">t</span>, <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="var token" data-binding="var-_uniq.3248" data-verso-hover="236">t</span>)) 1<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>(<span class="const token" data-binding="const-Neg.neg" data-verso-hover="182">-</span>((<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.3276" data-verso-hover="236">t</span> =&gt; (<span class="const token" data-binding="const-SciLean.Scalar.cos" data-verso-hover="265">cos</span> <span class="var token" data-binding="var-_uniq.3276" data-verso-hover="236">t</span>, <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="var token" data-binding="var-_uniq.3276" data-verso-hover="236">t</span>)) <span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span>).2, ((<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.3289" data-verso-hover="236">t</span> =&gt; (<span class="const token" data-binding="const-SciLean.Scalar.cos" data-verso-hover="265">cos</span> <span class="var token" data-binding="var-_uniq.3289" data-verso-hover="236">t</span>, <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="var token" data-binding="var-_uniq.3289" data-verso-hover="236">t</span>)) <span class="var token" data-binding="var-_uniq.3247" data-verso-hover="236">t</span>).1)</span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-11190-11199"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-11190">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-11190-11199"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code></div>
                  </div>
                <ol start="2">
                  <li>
                    <p>
                      Show that trajectory \(x(t) = \sin(\omega t) \) corresponds to the force \(f(x) = - k x \) with \(\omega = \sqrt{(k/m)} \)</p>
                    </li>
                  </ol>
                <div class="collapsible-hint" onclick="this.classList.toggle('expanded');">
                  <div class="collapsible-hint-header">
                    Hint</div>
                  <div class="collapsible-hint-content">
                    <p>
                      After differentiation you will have to show that \(m \sqrt{\frac{k}{m}}^2 = k\). Unfortunatelly Lean is not yet very powerful computer algebra system. So you can finish the proof with</p>
                    <pre>  ring_nf --  m * (sqrt (k / m) * (sqrt (k / m) ==&gt; m * sqrt (k * m⁻¹) ^ 2
  have h : m * sqrt (k * m⁻¹) ^ 2 = k := sorry_proof
  simp[h]
</pre><p>
                      where we call <code>ring_nf</code> to clean up the expression, then we just assume that <code> m * sqrt (k * m⁻¹) ^ 2</code> is equal to <code>k</code> and finally we can finish the proof by running simp</p>
                    </div>
                  </div>
                <div class="collapsible" onclick="this.classList.toggle('expanded');">
                  <div class="collapsible-header">
                    Solution</div>
                  <div class="collapsible-content">
                    <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-11904" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span> <span class="unknown token" data-binding="">Scalar</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-11925">example</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span>
    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-11951" data-verso-hover="80">let</span> <span class="var token" data-binding="var-_uniq.108" data-verso-hover="236">ω</span> <span class="unknown token" data-binding="">:=</span> <span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="unknown token" data-binding="">)</span>
    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-11976" data-verso-hover="80">let</span> <span class="var token" data-binding="var-_uniq.187" data-verso-hover="241">x</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-11985">fun</span> <span class="var token" data-binding="var-_uniq.113" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.108" data-verso-hover="236">ω</span><span class="unknown token" data-binding="">*</span><span class="var token" data-binding="var-_uniq.113" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span>
    <span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="257">NewtonSecondLaw</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="var token" data-binding="var-_uniq.187" data-verso-hover="241">x</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-12030">fun</span> <span class="var token" data-binding="var-_uniq.191" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="unknown token" data-binding="">-</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="unknown token" data-binding="">*</span><span class="var token" data-binding="var-_uniq.187" data-verso-hover="241">x</span> <span class="var token" data-binding="var-_uniq.191" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-5527738589373119154-12051-12053"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-12051" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-5527738589373119154-12051-12053"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.19254" data-verso-hover="236">ω</span> := <span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>);
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.19273" data-verso-hover="241">x</span> := <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.19256" data-verso-hover="236">t</span> =&gt; <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="var token" data-binding="var-_uniq.19254" data-verso-hover="236">ω</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19256" data-verso-hover="236">t</span>);
<span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="257">NewtonSecondLaw</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="var token" data-binding="var-_uniq.19273" data-verso-hover="241">x</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.19275" data-verso-hover="236">t</span> =&gt; <span class="const token" data-binding="const-Neg.neg" data-verso-hover="182">-</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19273" data-verso-hover="241">x</span> <span class="var token" data-binding="var-_uniq.19275" data-verso-hover="236">t</span></span></span></div></div></span>

  <span class="tactic"><label for="tactic-state-17029044180312848375-12057-12085"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-12057" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-NewtonSecondLaw" data-verso-hover="257">NewtonSecondLaw</span> <span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-17029044180312848375-12057-12085"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.19254" data-verso-hover="236">ω</span> := <span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>);
<span class="keyword token" data-binding="">let</span> <span class="var token" data-binding="var-_uniq.19273" data-verso-hover="241">x</span> := <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.19256" data-verso-hover="236">t</span> =&gt; <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="var token" data-binding="var-_uniq.19254" data-verso-hover="236">ω</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19256" data-verso-hover="236">t</span>);
∀ (<span class="var token" data-binding="var-_uniq.19274" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>), <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>(∂ (<span class="var token" data-binding="var-_uniq.19282" data-verso-hover="236">x_1</span>:=<span class="var token" data-binding="var-_uniq.19274" data-verso-hover="236">t</span>), (∂ <span class="var token" data-binding="var-_uniq.19273" data-verso-hover="241">x</span> <span class="var token" data-binding="var-_uniq.19282" data-verso-hover="236">x_1</span>) 1) 1<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>(<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.19284" data-verso-hover="236">t</span> =&gt; <span class="const token" data-binding="const-Neg.neg" data-verso-hover="182">-</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19273" data-verso-hover="241">x</span> <span class="var token" data-binding="var-_uniq.19284" data-verso-hover="236">t</span>) <span class="var token" data-binding="var-_uniq.19274" data-verso-hover="236">t</span></span></span></div></div></span>
  <span class="tactic"><label for="tactic-state-14008120453948222803-12088-12097"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-12088">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-14008120453948222803-12088-12097"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∀ (<span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>), <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>(<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span>(<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span>)))<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span>)</span></span></div></div></span>
  <span class="tactic"><label for="tactic-state-7640825659365990867-12100-12107"><span class="keyword token" data-binding="kw-occ-Mathlib.Tactic.RingNF.ringNF-12100" data-verso-hover="267">ring_nf</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7640825659365990867-12100-12107"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∀ (<span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>), <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span>)</span></span></div></div></span>
  <span class="tactic"><label for="tactic-state-9621195212371140539-12110-12163"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.tacticHave_-12110" data-verso-hover="268">have</span> <span class="var token" data-binding="var-_uniq.19078" data-verso-hover="269">h</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">*</span> <span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span> <span class="unknown token" data-binding="">*</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="unknown token" data-binding="">⁻¹</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">^</span> <span class="unknown token" data-binding="">2</span> <span class="unknown token" data-binding="">=</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-SciLean.termSorry_proof-12152" data-verso-hover="67">sorry_proof</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-9621195212371140539-12110-12163"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.19078" data-verso-hover="269">h</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∀ (<span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>), <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.4" data-verso-hover="236">k</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">m</span><span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span>)<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.19234" data-verso-hover="236">t</span>)</span></span></div></div></span>
  <span class="tactic"><label for="tactic-state-7-12166-12173"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.simp-12166" data-verso-hover="199">simp</span><span class="unknown token" data-binding="">[</span><span class="var token" data-binding="var-_uniq.19078" data-verso-hover="269">h</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-12166-12173"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code></div>
                  </div>
                <ol start="3">
                  <li>
                    <p>
                      Show that \(u(t,x) = sin(x-t)\) is a solution to the wave equation</p>
                    </li>
                  </ol>
                <p>
                  $$\frac{\partial^2 u}{\partial t^2} = \frac{\partial^2 u}{\partial x^2}
$$</p>
                <div class="collapsible" onclick="this.classList.toggle('expanded');">
                  <div class="collapsible-header">
                    Solution</div>
                  <div class="collapsible-content">
                    <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-12361" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span> <span class="unknown token" data-binding="">Scalar</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-12381">def</span> <span class="const token" data-binding="const-WaveEquation" data-verso-hover="270">WaveEquation</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="243">u</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> 
  <span class="unknown token" data-binding="">∀</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">x</span> <span class="var token" data-binding="var-_uniq.17" data-verso-hover="236">t</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="243">u</span> <span class="unknown token" data-binding="">·</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.17" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="243">u</span> <span class="var token" data-binding="var-_uniq.17" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">·</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.14" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-12488">example</span> <span class="unknown token" data-binding="">:</span> 
    <span class="const token" data-binding="const-WaveEquation" data-verso-hover="271">WaveEquation</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-12517">fun</span> <span class="var token" data-binding="var-_uniq.316" data-verso-hover="236">t</span> <span class="var token" data-binding="var-_uniq.319" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.319" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">-</span> <span class="var token" data-binding="var-_uniq.316" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-756802295236020-12544-12546"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-12544" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-756802295236020-12544-12546"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-WaveEquation" data-verso-hover="271">WaveEquation</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.12370" data-verso-hover="236">t</span> <span class="var token" data-binding="var-_uniq.12372" data-verso-hover="236">x</span> =&gt; <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="var token" data-binding="var-_uniq.12372" data-verso-hover="236">x</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span><span class="var token" data-binding="var-_uniq.12370" data-verso-hover="236">t</span>)</span></span></div></div></span>
  <span class="tactic"><label for="tactic-state-6611102407347453286-12549-12574"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-12549" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-WaveEquation" data-verso-hover="271">WaveEquation</span> <span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-6611102407347453286-12549-12574"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∀ (<span class="var token" data-binding="var-_uniq.12368" data-verso-hover="236">x </span><span class="var token" data-binding="var-_uniq.12369" data-verso-hover="236">t</span> : <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>),
  (∂ (<span class="var token" data-binding="var-_uniq.12371" data-verso-hover="236">x_1</span>:=<span class="var token" data-binding="var-_uniq.12369" data-verso-hover="236">t</span>), (∂ (<span class="var token" data-binding="var-_uniq.12375" data-verso-hover="236">x_2</span>:=<span class="var token" data-binding="var-_uniq.12371" data-verso-hover="236">x_1</span>), (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.12377" data-verso-hover="236">t</span> <span class="var token" data-binding="var-_uniq.12379" data-verso-hover="236">x</span> =&gt; <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="var token" data-binding="var-_uniq.12379" data-verso-hover="236">x</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span><span class="var token" data-binding="var-_uniq.12377" data-verso-hover="236">t</span>)) <span class="var token" data-binding="var-_uniq.12375" data-verso-hover="236">x_2</span> <span class="var token" data-binding="var-_uniq.12368" data-verso-hover="236">x</span>) 1) 1<span class="const token" data-binding="const-Eq" data-verso-hover="72"> =
    </span>(∂ (<span class="var token" data-binding="var-_uniq.12401" data-verso-hover="236">x</span>:=<span class="var token" data-binding="var-_uniq.12368" data-verso-hover="236">x</span>), (∂ (<span class="var token" data-binding="var-_uniq.12403" data-verso-hover="236">x</span>:=<span class="var token" data-binding="var-_uniq.12401" data-verso-hover="236">x</span>), (<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.12405" data-verso-hover="236">t</span> <span class="var token" data-binding="var-_uniq.12407" data-verso-hover="236">x</span> =&gt; <span class="const token" data-binding="const-SciLean.Scalar.sin" data-verso-hover="266">sin</span> (<span class="var token" data-binding="var-_uniq.12407" data-verso-hover="236">x</span><span class="const token" data-binding="const-HSub.hSub" data-verso-hover="239"> - </span><span class="var token" data-binding="var-_uniq.12405" data-verso-hover="236">t</span>)) <span class="var token" data-binding="var-_uniq.12369" data-verso-hover="236">t</span> <span class="var token" data-binding="var-_uniq.12403" data-verso-hover="236">x</span>) 1) 1</span></span></div></div></span>
  <span class="tactic"><label for="tactic-state-7-12577-12586"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-12577">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-12577-12586"><div class="tactic-state">All goals completed! 🐙</div></span>

<span class="unknown token" data-binding=""></span></code></div>
                  </div>
                <ol start="4">
                  <li>
                    <p>
                      solution to heat equation</p>
                    </li>
                  </ol>
                </section>
              </section>
            </section>
          <section>
            <h2 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Gradient">
              Gradient</h2>
            <p>
              In many practical applications, we need to compute gradient instead of directional derivative. For a function \(f : \mathbb{R}^n \rightarrow \mathbb{R} \) the gradient of \(f\) is a vector of all its partial derivatives</p>
            <p>
              $$\nabla f = \left(\frac{\partial f}{\partial x_1}, \dots, \frac{\partial f}{\partial x_n} \right)
$$</p>
            <p>
              A more general way of defining gradient is through linear map transposition/adjoint. The derivative of a function <code>(f : X → ℝ)</code> at point <code>x</code> is a linear map from <code>X</code> to <code>ℝ</code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-13191" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-13204" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="unknown token" data-binding="">ℝ</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-13279" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="277">X</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="277">X</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ f x : X →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-13312">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>∂ f x : X →L[ℝ] ℝ
</pre></div>
            <p>
              To obtain gradient we take an adjoint and evaluate it at one. This is exactly how gradient is defined.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-13501" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-13514" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="unknown token" data-binding="">ℝ</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-13589" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="277">X</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="277">X</span><span class="unknown token" data-binding="">)</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-13622">example</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=</span> <span class="const token" data-binding="const-adjoint" data-verso-hover="279">adjoint</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">1</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-14200650673733438145-13671-13673"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-13671" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-14200650673733438145-13671-13673"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.662" data-verso-hover="138">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1330" data-verso-hover="280">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="138">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1348" data-verso-hover="281">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="138">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1983" data-verso-hover="282">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.662" data-verso-hover="138">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.662" data-verso-hover="138">X</span> → <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.662" data-verso-hover="138">X</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∇ <span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span><span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="const token" data-binding="const-adjoint" data-verso-hover="279">adjoint</span> <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span> (⇑(∂ <span class="var token" data-binding="var-_uniq.1322" data-verso-hover="276">f</span> <span class="var token" data-binding="var-_uniq.1324" data-verso-hover="278">x</span>)) 1</span></span></div></div></span> <span class="tactic"><label for="tactic-state-7-13674-13677"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.tacticRfl-13674" data-verso-hover="283">rfl</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-13674-13677"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><p>
              This coincides with the standard notion of gradient that it is a vector of all its partial derivatives. For example for <code>n=2</code> we have</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-13825" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-13838" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="4">n</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Nat" data-verso-hover="5">Nat</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.8" data-verso-hover="242">f</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.300" data-verso-hover="284">hf</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="unknown token" data-binding="">ℝ</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="242">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.302" data-verso-hover="236">x</span> <span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">y</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-13920">example</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="242">f</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.302" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">y</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.740" data-verso-hover="236">x'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.302" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="242">f</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.740" data-verso-hover="236">x'</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">y</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.768" data-verso-hover="236">y'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.304" data-verso-hover="236">y</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="242">f</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.302" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.768" data-verso-hover="236">y'</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-SciLean.termSorry_proof-13996" data-verso-hover="67">sorry_proof</span>
<span class="unknown token" data-binding=""></span></code><div class="TODO">
              <p>
                <strong>Warning for mathlib users</strong>: SciLean defines its own version of <code>adjoint</code> and <code>gradient</code>. The reason is that the product type <code>ℝ×ℝ</code> and function type <code>Fin n → ℝ</code> are not <code>InnerProductSpace</code> and therefore it is impossible do use mathlibs <code>gradient</code> on functions of type <code>ℝ×ℝ → ℝ</code> or <code>(Fin n → ℝ) → ℝ</code>. Mathlib's advice is to use <code>WithLp 2 (ℝ×ℝ)</code> or <code>EuclidianSpace n</code> however this is seriously inconvenient for people that just want to write some code.</p>
              <p>
                SciLean solution to this is to introduce new typeclass <code>AdjointSpace ℝ X</code> that is almost the same as <code>InnerProductSpace ℝ X</code> but requires that the norm induced by inner product, <code>‖x‖₂ = ⟪x,x⟫</code>, is topologically equivalent to the norm <code>‖x‖</code>. This way we can provide instance of <code>AdjointSpace ℝ (X×Y)</code> and <code>AdjointSpace ℝ (ι → X)</code> without causing issues.</p>
              </div>
            <p>
              Few examples of of computing gradients</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-14956" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">(1, 0) : ℝ × ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-14983">#check</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.13" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.13" data-verso-hover="240">x</span><span class="unknown token" data-binding="">.</span><span class="unknown token" data-binding="">1</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>(1, 0) : ℝ × ℝ
</pre></div>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-15087" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">2 • x₀ : ℝ × ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-15114">#check</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.13" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.13" data-verso-hover="240">x</span><span class="unknown token" data-binding="">‖₂²</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>2 • x₀ : ℝ × ℝ
</pre></div>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-15233" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span> <span class="var token" data-binding="var-_uniq.8" data-verso-hover="240">y</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">y : ℝ × ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-15262">#check</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.21" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">⟪</span><span class="var token" data-binding="var-_uniq.21" data-verso-hover="240">x</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.8" data-verso-hover="240">y</span><span class="unknown token" data-binding="">⟫</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>y : ℝ × ℝ
</pre></div>
            <section>
              <h3 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Gradient--Exercises">
                Exercises</h3>
              <ol start="1">
                <li>
                  <p>
                    Compute gradient of <code>x[0]</code>, <code>‖x‖₂²</code>, <code>⟪x,y⟫</code> for <code>x y : Float^[3]</code> and gradient of <code>A[0,1]</code>, <code>‖A‖₂²</code>, <code>⟪A,B⟫</code> for <code>A B : Float^[2,2]</code>. Also evaluate those results for some concrete values.</p>
                  </li>
                </ol>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-15594">set_default_scalar</span> <span class="unknown token" data-binding="">Float</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">⊞[1.000000, 0.000000, 0.000000]
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-15620">#eval</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2005" data-verso-hover="286">x</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">⊞[</span><span class="unknown token" data-binding="">1.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">2.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">3.0</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.2005" data-verso-hover="286">x</span><span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">]</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">⊞[2.000000, 4.000000, 6.000000]
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-15659">#eval</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6944" data-verso-hover="286">x</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">⊞[</span><span class="unknown token" data-binding="">1.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">2.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">3.0</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.6944" data-verso-hover="286">x</span><span class="unknown token" data-binding="">‖₂²</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">⊞[0.000000, 1.000000, 0.000000]
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-15706">#eval</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.17521" data-verso-hover="286">x</span><span class="unknown token" data-binding="">:=</span><span class="unknown token" data-binding="">⊞[</span><span class="unknown token" data-binding="">1.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">2.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">3.0</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">⟪</span><span class="var token" data-binding="var-_uniq.17521" data-verso-hover="286">x</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">⊞[</span><span class="unknown token" data-binding="">0.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">1.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">0.0</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">⟫</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-15767">def</span> <span class="const token" data-binding="const-matrix1" data-verso-hover="287">matrix1</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">⊞[</span><span class="unknown token" data-binding="">1.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">2.0</span><span class="unknown token" data-binding="">;</span><span class="unknown token" data-binding="">3.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">4.0</span><span class="unknown token" data-binding="">]</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">⊞[0.000000, 0.000000, 1.000000, 0.000000]
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-15804">#eval</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.36818" data-verso-hover="288">A</span><span class="unknown token" data-binding="">:=</span><span class="const token" data-binding="const-matrix1" data-verso-hover="289">matrix1</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.36818" data-verso-hover="288">A</span><span class="unknown token" data-binding="">[</span><span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">]</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">⊞[2.000000, 6.000000, 4.000000, 8.000000]
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-15836">#eval</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.38925" data-verso-hover="288">A</span><span class="unknown token" data-binding="">:=</span><span class="const token" data-binding="const-matrix1" data-verso-hover="289">matrix1</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.38925" data-verso-hover="288">A</span><span class="unknown token" data-binding="">‖₂²</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">⊞[0.000000, 0.000000, 1.000000, 0.000000]
</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.eval-15874">#eval</span></span> <span class="unknown token" data-binding="">∇!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.41408" data-verso-hover="288">A</span><span class="unknown token" data-binding="">:=</span><span class="const token" data-binding="const-matrix1" data-verso-hover="289">matrix1</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">⟪</span><span class="var token" data-binding="var-_uniq.41408" data-verso-hover="288">A</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">⊞[</span><span class="unknown token" data-binding="">0.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">1.0</span><span class="unknown token" data-binding="">;</span><span class="unknown token" data-binding="">0.0</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">0.0</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">⟫</span>
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              <ol start="2">
                <li>
                  <p>
                    Previously we computed \(\sqrt{y}\) using Newton's method. Similarly we can <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-mySqrt" data-verso-hover="250">mySqrt</span></code> Compute <code>sqrt y</code> using gradient descent by minimizing objective function <code>f := fun x =&gt; (x^2 - y)^2</code></p>
                  </li>
                </ol>
              <div class="TODO">
                <p>
                  Add solution to gradient descent</p>
                </div>
              <ol start="3">
                <li>
                  <p>
                    Linear regression via gradient descent. Find matrix \( A \in \mathbb{R}^{2\times 2} \) that for given data \( x_i, y_i \in \mathbb{R}^2 \) minimizes</p>
                  </li>
                </ol>
              <p>
                $$A = \text{argmin}_B \sum_i \| B x_i - y_i \|^2
$$</p>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-16439">set_default_scalar</span> <span class="unknown token" data-binding="">Float</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-16465">def</span> <span class="has-info warning"><span class="hover-container"><span class="hover-info messages"><code class="message warning">declaration uses 'sorry'</code></span></span><span class="const token" data-binding="const-linreg" data-verso-hover="290">linreg</span></span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.527" data-verso-hover="4">n</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℕ</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.583" data-verso-hover="291">x</span> <span class="var token" data-binding="var-_uniq.592" data-verso-hover="291">y</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">^[</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">^[</span><span class="var token" data-binding="var-_uniq.527" data-verso-hover="4">n</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">^[</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">:=</span> 
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-16528" data-verso-hover="80">let</span> <span class="var token" data-binding="var-_uniq.1674" data-verso-hover="292">loss</span> <span class="unknown token" data-binding="">:=</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-16540">fun</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.631" data-verso-hover="288">A</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Float" data-verso-hover="27">Float</span><span class="unknown token" data-binding="">^[</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">,</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=&gt;</span>  
    <span class="unknown token" data-binding="">∑</span> <span class="var token" data-binding="var-_uniq.641" data-verso-hover="32">i</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">⊞</span> <span class="var token" data-binding="var-_uniq.694" data-verso-hover="96">i'</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="unknown token" data-binding="">∑</span> <span class="var token" data-binding="var-_uniq.704" data-verso-hover="96">j</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.631" data-verso-hover="288">A</span><span class="unknown token" data-binding="">[</span><span class="var token" data-binding="var-_uniq.694" data-verso-hover="96">i'</span><span class="unknown token" data-binding="">,</span><span class="var token" data-binding="var-_uniq.704" data-verso-hover="96">j</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">*</span> <span class="var token" data-binding="var-_uniq.583" data-verso-hover="291">x</span><span class="unknown token" data-binding="">[</span><span class="var token" data-binding="var-_uniq.641" data-verso-hover="32">i</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">[</span><span class="var token" data-binding="var-_uniq.704" data-verso-hover="96">j</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">-</span> <span class="var token" data-binding="var-_uniq.592" data-verso-hover="291">y</span><span class="unknown token" data-binding="">[</span><span class="var token" data-binding="var-_uniq.641" data-verso-hover="32">i</span><span class="unknown token" data-binding="">]</span><span class="unknown token" data-binding="">‖₂²</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.sorry-16635" data-verso-hover="293">sorry</span>
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              <ol start="4">
                <li>
                  <p>
                    Write down Euler-Lagrange equation over abstract vector space <code>X</code> and show that for lagrangian <code>L x v := 1/2 * m * ‖v‖₂² - φ x</code> the Euler-Langran equation is <code>m * ∂ (∂ x) t = - ∇ φ x</code></p>
                  </li>
                </ol>
              <p>
                Either define the Lagrangian over <code>ℝ×ℝ</code>, <code>L : ℝ×ℝ → ℝ×ℝ → ℝ</code> or you can introduce abstract vector space <code>X</code> using this variable command</p>
              <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-17019" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="unknown token" data-binding="">ℝ</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">X</span><span class="unknown token" data-binding="">]</span>
<span class="unknown token" data-binding=""></span></code><p>
                The explanation of these typeclasses will be discussed in the last section "Abstract Vector Spaces".</p>
              <div class="collapsible" onclick="this.classList.toggle('expanded');">
                <div class="collapsible-header">
                  Solution</div>
                <div class="collapsible-content">
                  <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-17221">set_default_scalar</span> <span class="unknown token" data-binding="">ℝ</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-17244" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-17257" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.1178" data-verso-hover="294">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="294">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="unknown token" data-binding="">ℝ</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="294">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="294">X</span><span class="unknown token" data-binding="">]</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.noncomputable-17333">noncomputable</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-17347">def</span> <span class="const token" data-binding="const-EulerLagrange" data-verso-hover="295">EulerLagrange</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1840" data-verso-hover="296">L</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="138">X</span> <span class="unknown token" data-binding="">→</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="138">X</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1844" data-verso-hover="297">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="138">X</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1846" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span>
  <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.let-17418" data-verso-hover="80">let</span> <span class="var token" data-binding="var-_uniq.1940" data-verso-hover="297">v</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.1844" data-verso-hover="297">x</span>
  <span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1948" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.1846" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2024" data-verso-hover="278">v'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.1940" data-verso-hover="297">v</span> <span class="var token" data-binding="var-_uniq.1948" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.1840" data-verso-hover="296">L</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1844" data-verso-hover="297">x</span> <span class="var token" data-binding="var-_uniq.1948" data-verso-hover="236">t'</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.2024" data-verso-hover="278">v'</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">-</span> <span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2122" data-verso-hover="278">x'</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.1844" data-verso-hover="297">x</span> <span class="var token" data-binding="var-_uniq.1846" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="var token" data-binding="var-_uniq.1840" data-verso-hover="296">L</span> <span class="var token" data-binding="var-_uniq.2122" data-verso-hover="278">x'</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1940" data-verso-hover="297">v</span> <span class="var token" data-binding="var-_uniq.1846" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.noncomputable-17507">noncomputable</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-17521">def</span> <span class="const token" data-binding="const-NewtonsLaw" data-verso-hover="298">NewtonsLaw</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.3316" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.3320" data-verso-hover="276">φ</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="138">X</span> <span class="unknown token" data-binding="">→</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.3324" data-verso-hover="297">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span> <span class="unknown token" data-binding="">→</span> <span class="var token" data-binding="var-_uniq.1178" data-verso-hover="138">X</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.3326" data-verso-hover="236">t</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span>
  <span class="var token" data-binding="var-_uniq.3316" data-verso-hover="236">m</span> <span class="unknown token" data-binding="">•</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.3324" data-verso-hover="297">x</span><span class="unknown token" data-binding="">)</span> <span class="var token" data-binding="var-_uniq.3326" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">+</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="var token" data-binding="var-_uniq.3320" data-verso-hover="276">φ</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.3324" data-verso-hover="297">x</span> <span class="var token" data-binding="var-_uniq.3326" data-verso-hover="236">t</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span>

-- example 
--     (x : ℝ → X) (hx : ContDiff ℝ ⊤ x)
--     (φ : X → ℝ) (hφ : Differentiable ℝ φ) :
--     EulerLagrange (fun x v =&gt; m/2 * ‖v‖₂² - φ x) x t
--     =
--     NewtonsLaw m φ x t := by 
--   unfold EulerLagrange NewtonsLaw deriv fgradient; fun_trans [smul_smul]
--   sorry
<span class="unknown token" data-binding=""></span></code></div>
                </div>
              </section>
            </section>
          <section>
            <h2 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Derivative-Rules">
              Derivative Rules</h2>
            <p>
              A commong issue when <code>fun_trans</code> is not doing what we expect is that there is a missing differentiation theorem.</p>
            <p>
              For example, if we define a function</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-18184">def</span> <span class="const token" data-binding="const-foo" data-verso-hover="299">foo</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><p>
              then nothing happens when we try to differentiate it</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; (∂ (x:=x), foo x) 1 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-18302">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; (∂ (x:=x), foo x) 1 : ℝ → ℝ
</pre></div>
            <p>
              Turning on the <code>fun_trans</code> trace reveals useful information</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.set_option-18474" data-verso-hover="193">set_option</span> <span class="option token" data-binding="option-Mathlib.Meta.FunTrans.initFn._@.SciLean.Tactic.FunTrans.Decl._hyg.50" data-verso-hover="301">trace.Meta.Tactic.fun_trans</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.set_option-18474" data-verso-hover="193">true</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.in-18474">in</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; (∂ (x:=x), foo x) 1 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-18521">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><pre>[Meta.Tactic.fun_trans] [❌] ∂ (x:=x), foo x
  [Meta.Tactic.fun_trans] candidate theorems for foo: []
  [Meta.Tactic.fun_trans] candidate local theorems for foo: []
  [Meta.Tactic.fun_trans] candidate fvar theorems: [isContinuousLinearMap_fderiv]
  [Meta.Tactic.fun_trans] [❌] applying: isContinuousLinearMap_fderiv
    [Meta.Tactic.fun_trans] isContinuousLinearMap_fderiv, failed to discharge hypotheses
          SciLean.IsContinuousLinearMap ℝ fun x =&gt; foo x
</pre><p>
              The <code>❌</code> on the first line signifies that <code>fun_trans</code> failed to make prograss on <code>∂ (x:=x), foo x</code>. The next two lines</p>
            <pre>  [Meta.Tactic.fun_trans] candidate theorems for foo: []
  [Meta.Tactic.fun_trans] candidate local theorems for foo: []
</pre><p>
              states that there are no derivative theorems for <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></code>. The next line</p>
            <pre>  [Meta.Tactic.fun_trans] candidate fvar theorems: [isContinuousLinearMap_fderiv]
</pre><p>
              states that there is a potentially applicable theorem <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-isContinuousLinearMap_fderiv" data-verso-hover="302">isContinuousLinearMap_fderiv</span></code> which can differentiate linear functions. However the next few lines report that applying this theorem failed as <code>fun_trans</code> can't prove that <code>foo</code> is (continuous) linear map.</p>
            <p>
              To remedy this problem we can define derivative of <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.definition-19780">def</span> <span class="const token" data-binding="const-foo_deriv" data-verso-hover="303">foo_deriv</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">*</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">+</span> <span class="unknown token" data-binding="">1</span>
<span class="unknown token" data-binding=""></span></code><p>
              and add a theorem that the derivative of <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></code> is equal to <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo_deriv" data-verso-hover="304">foo_deriv</span></code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-19910" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span>
<span class="unknown token" data-binding="">@[</span><span class="unknown token" data-binding="">fun_trans</span><span class="unknown token" data-binding="">]</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.theorem-19936">theorem</span> <span class="const token" data-binding="const-foo_deriv_rule" data-verso-hover="305">foo_deriv_rule</span> <span class="unknown token" data-binding="">:</span> 
    <span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span> <span class="unknown token" data-binding="">ℝ</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> 
    <span class="unknown token" data-binding="">=</span> 
    <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-19993">fun</span> <span class="var token" data-binding="var-_uniq.190" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="keyword token" data-binding="kw-occ-SciLean.«termFun_=>L[_]_»-20002">fun</span> <span class="var token" data-binding="var-_uniq.205" data-verso-hover="236">dx</span> <span class="unknown token" data-binding="">=&gt;L[</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">]</span> <span class="var token" data-binding="var-_uniq.205" data-verso-hover="236">dx</span> <span class="unknown token" data-binding="">•</span> <span class="const token" data-binding="const-foo_deriv" data-verso-hover="304">foo_deriv</span> <span class="var token" data-binding="var-_uniq.190" data-verso-hover="236">x</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-12053836367124394835-20040-20042"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-20040" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-12053836367124394835-20040-20042"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∂ <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span><span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.7876" data-verso-hover="236">x</span> =&gt; <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.7890" data-verso-hover="236">dx</span> =&gt;L[<span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>] <span class="var token" data-binding="var-_uniq.7890" data-verso-hover="236">dx</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span><span class="const token" data-binding="const-foo_deriv" data-verso-hover="304">foo_deriv</span> <span class="var token" data-binding="var-_uniq.7876" data-verso-hover="236">x</span></span></span></div></div></span> 
  <span class="tactic"><label for="tactic-state-8629001085943303540-20046-20066"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-20046" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="const token" data-binding="const-foo_deriv" data-verso-hover="304">foo_deriv</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-8629001085943303540-20046-20066"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∂ <span class="var token" data-binding="var-_uniq.7876" data-verso-hover="236">x</span>, (<span class="var token" data-binding="var-_uniq.7876" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.7876" data-verso-hover="236">x</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.7901" data-verso-hover="236">x</span> =&gt; <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.7915" data-verso-hover="236">dx</span> =&gt;L[<span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>] <span class="var token" data-binding="var-_uniq.7915" data-verso-hover="236">dx</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.7901" data-verso-hover="236">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>1)</span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-252404580762776335-20068-20073"><span class="keyword token" data-binding="kw-occ-Lean.Elab.Tactic.Ext.ext-20068" data-verso-hover="198">ext</span> <span class="var token" data-binding="var-_uniq.2522" data-verso-hover="236">x</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-252404580762776335-20068-20073"><div class="tactic-state"><div class="goal"><details open="open"><summary><span class="goal-name">h.h</span></summary><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2522" data-verso-hover="236">x</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(∂ (<span class="var token" data-binding="var-_uniq.7875" data-verso-hover="236">x</span>:=<span class="var token" data-binding="var-_uniq.2522" data-verso-hover="236">x</span>), (<span class="var token" data-binding="var-_uniq.7875" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.7875" data-verso-hover="236">x</span>)) 1<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>(<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.7913" data-verso-hover="236">dx</span> =&gt;L[<span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>] <span class="var token" data-binding="var-_uniq.7913" data-verso-hover="236">dx</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2522" data-verso-hover="236">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>1)) 1</span></span></details></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-20075-20084"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-20075">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-20075-20084"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><p>
              Because <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo_deriv_rule" data-verso-hover="306">foo_deriv_rule</span></code> is marked with <code>fun_trans</code> attribute it will be used when we try to differentiate <code>foo</code> now</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; foo_deriv x : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-20238">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; foo_deriv x : ℝ → ℝ
</pre></div>
            <p>
              Unfortuantelly there is one more issue, <code>fun_trans</code> will do nothing when we try to compose <code>foo</code> together</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; (∂ (x:=x), foo (foo x)) 1 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-20461">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; (∂ (x:=x), foo (foo x)) 1 : ℝ → ℝ
</pre></div>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.set_option-20581" data-verso-hover="193">set_option</span> <span class="option token" data-binding="option-Mathlib.Meta.FunTrans.initFn._@.SciLean.Tactic.FunTrans.Decl._hyg.50" data-verso-hover="301">trace.Meta.Tactic.fun_trans</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.set_option-20581" data-verso-hover="193">true</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.in-20581">in</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; (∂ (x:=x), foo (foo x)) 1 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-20628">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><pre>...
  [Meta.Tactic.fun_trans] trying comp theorem SciLean.fderiv.comp_rule
  [Meta.Tactic.fun_trans] [❌] applying: SciLean.fderiv.comp_rule
    [Meta.Tactic.fun_trans] SciLean.fderiv.comp_rule, failed to discharge hypotheses
          Differentiable ℝ fun x0 =&gt; foo x0
...
</pre><p>
              The trace reveals that <code>fun_trans</code> tries to apply composition(chain) rule <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-SciLean.fderiv.comp_rule" data-verso-hover="307">SciLean.fderiv.comp_rule</span></code> but it fails as it can't prove <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="unknown token" data-binding="">ℝ</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.fun-21108">fun</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="236">x0</span> <span class="unknown token" data-binding="">=&gt;</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="236">x0</span></code>. We need another theorem stating that <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></code> is differentiable function. Mathlib has a tactic <code>fun_prop</code> that can prove differentiability and many other function properties like linearity, continuity, measurability etc. and <code>fun_trans</code> uses this tactic to ensure it can apply chain rule.</p>
            <p>
              We need to add <code>fun_prop</code> theorem for <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="unknown token" data-binding="">@[</span><span class="unknown token" data-binding="">fun_prop</span><span class="unknown token" data-binding="">]</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.theorem-21490">theorem</span> <span class="const token" data-binding="const-foo_differentiable" data-verso-hover="308">foo_differentiable</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="unknown token" data-binding="">ℝ</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-10893289003651201275-21545-21547"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-21545" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-10893289003651201275-21545-21547"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></span></span></div></div></span> <span class="tactic"><label for="tactic-state-11734240531055305780-21548-21558"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-21548" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-11734240531055305780-21548-21558"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.598" data-verso-hover="236">x</span> =&gt; <span class="var token" data-binding="var-_uniq.598" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.598" data-verso-hover="236">x</span></span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-21560-21568"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunProp.funPropTacStx-21560" data-verso-hover="309">fun_prop</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-21560-21568"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><p>
              Now <code>fun_trans</code> knows that <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></code> is differentiable function and can safely apply chain rule</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; foo_deriv x * foo_deriv (foo x) : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-21706">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂!</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="unknown token" data-binding="">(</span><span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.7" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-21713">rewrite_by</span> <span class="tactic"><label for="tactic-state-14180328119166588544-21746-21750"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.simp-21746" data-verso-hover="192">simp</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-14180328119166588544-21746-21750"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.1806" data-verso-hover="236">x</span> =&gt; <span class="const token" data-binding="const-foo_deriv" data-verso-hover="304">foo_deriv</span> <span class="var token" data-binding="var-_uniq.1806" data-verso-hover="236">x</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="const token" data-binding="const-foo_deriv" data-verso-hover="304">foo_deriv</span> (<span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="var token" data-binding="var-_uniq.1806" data-verso-hover="236">x</span>)</span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; foo_deriv x * foo_deriv (foo x) : ℝ → ℝ
</pre></div>
            <p>
              Writing these theorems by hand is quite tedious so there is a macro <code>def_fun_prop</code> and <code>def_fun_trans</code> to help you with writing these theorems</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-SciLean.«commandDef_fun_propWith_transitive__:_By_»-21999" data-verso-hover="310">def_fun_prop</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="unknown token" data-binding="">ℝ</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="keyword token" data-binding="kw-occ-SciLean.«commandDef_fun_propWith_transitive__:_By_»-21999" data-verso-hover="310">by</span> <span class="tactic"><label for="tactic-state-3567834162914227034-22040-22050"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-22040" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-3567834162914227034-22040-22050"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span> <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.584" data-verso-hover="236">x</span> =&gt; <span class="var token" data-binding="var-_uniq.584" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.584" data-verso-hover="236">x</span></span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-22052-22060"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunProp.funPropTacStx-22052" data-verso-hover="309">fun_prop</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-22052-22060"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="keyword token" data-binding="kw-occ-SciLean.«commandDef_fun_transWith_transitive__:_By_»-22061">def_fun_trans</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span> <span class="unknown token" data-binding="">ℝ</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span> <span class="keyword token" data-binding="kw-occ-SciLean.«commandDef_fun_transWith_transitive__:_By_»-22061">by</span> <span class="tactic"><label for="tactic-state-7340767202081764024-22095-22105"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.unfold-22095" data-verso-hover="311">unfold</span> <span class="const token" data-binding="const-foo" data-verso-hover="300">foo</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7340767202081764024-22095-22105"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">| </span><span class="type">∂ <span class="var token" data-binding="var-_uniq.6068" data-verso-hover="236">x</span>, (<span class="var token" data-binding="var-_uniq.6068" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.6068" data-verso-hover="236">x</span>)</span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-4831339525703391608-22107-22116"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-22107">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-4831339525703391608-22107-22116"><div class="tactic-state"><div class="goal"><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.6066" data-verso-hover="236">x</span> =&gt; <span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.6080" data-verso-hover="236">x_1</span> =&gt;L[<span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span>] 2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.6080" data-verso-hover="236">x_1</span><span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.6066" data-verso-hover="236">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.6080" data-verso-hover="236">x_1</span></span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><p>
              It generates these theorems and definition</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">foo.arg_x.Differentiable_rule : Differentiable ℝ foo</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-22192">#check</span></span> <span class="const token" data-binding="const-foo.arg_x.Differentiable_rule" data-verso-hover="312">foo.arg_x.Differentiable_rule</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">def foo.arg_x.fderiv : ℝ → ℝ →L[ℝ] ℝ :=
fun x =&gt; fun x_1 =&gt;L[ℝ] 2 * x_1 * x + x_1</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.print-22229">#print</span></span> <span class="const token" data-binding="const-foo.arg_x.fderiv" data-verso-hover="313">foo.arg_x.fderiv</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">foo.arg_x.fderiv_rule : ∂ foo = foo.arg_x.fderiv</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-22253">#check</span></span> <span class="const token" data-binding="const-foo.arg_x.fderiv_rule" data-verso-hover="314">foo.arg_x.fderiv_rule</span>
<span class="unknown token" data-binding=""></span></code><p>
              The problem of writing appropriate theorems for <code>fun_trans</code> and <code>fun_prop</code> is quite involved problem and will be discussed in future chapter.</p>
            </section>
          <section>
            <h2 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Differentiating-Division-Log-Sqrt-">
              Differentiating Division, Log, Sqrt, ...</h2>
            <p>
              So far we have worked with functions that are smooth. However, functions like division, <code>log</code>, <code>sqrt</code>, <code>‖·‖₂</code> are not differentiable everywhere. We have to be a bit careful with those functions because <strong>SciLean</strong> tries to perform computations that are, at least in principle, fully formalizable. Let's try to differentiate division</p>
            <code class="hl lean block" data-lean-context="examples"><span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; (∂ (x:=x), x⁻¹) 1 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-22888">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun x =&gt; (∂ (x:=x), x⁻¹) 1 : ℝ → ℝ
</pre></div>
            <p>
              We did not get expected <code>-x⁻²</code>. When differentiation, or any tactic, is not doing what we expect we can turn on tracing. Let's try again with tracing on</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.set_option-23154" data-verso-hover="193">set_option</span> <span class="option token" data-binding="option-Mathlib.Meta.FunTrans.initFn._@.SciLean.Tactic.FunTrans.Decl._hyg.50" data-verso-hover="301">trace.Meta.Tactic.fun_trans</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.set_option-23154" data-verso-hover="193">true</span> <span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.in-23154">in</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun x =&gt; (∂ (x:=x), x⁻¹) 1 : ℝ → ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-23201">#check</span></span> <span class="unknown token" data-binding="">∂!</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.6" data-verso-hover="236">x</span>
<span class="unknown token" data-binding=""></span></code><p>
              and the beggining of the trace is saying that <code>fun_trans</code> tried to apply theorem <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-HDiv.hDiv.arg_a0a1.fderiv_rule_at" data-verso-hover="315">HDiv.hDiv.arg_a0a1.fderiv_rule_at</span></code> however it failed to discharge <code>x ≠ 0</code></p>
            <pre>[Meta.Tactic.fun_trans] [❌] ∂ (x:=x), 1 / x
  [Meta.Tactic.fun_trans] candidate theorems for HDiv.hDiv: [HDiv.hDiv.arg_a0a1.fderiv_rule_at]
  [Meta.Tactic.fun_trans] [❌] applying: HDiv.hDiv.arg_a0a1.fderiv_rule_at
    [Meta.Tactic.fun_trans] [❌] discharging: x ≠ 0
    [Meta.Tactic.fun_trans] HDiv.hDiv.arg_a0a1.fderiv_rule_at, failed to discharge hypotheses
          x ≠ 0
</pre><p>
              This makes sense as division <code>1/x</code> is well defined and differentiable only away from zero. Therefore we have to differentiate it at a concrete point that is not equal to zero.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-23994" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.35" data-verso-hover="316">hx₀</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">≠</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">-(x₀ ^ 2)⁻¹ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-24037">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.75" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.75" data-verso-hover="236">x</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-24044">rewrite_by</span> <span class="tactic"><label for="tactic-state-15339860773356334190-24076-24105"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-24076">fun_trans</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-token.disch-24087">disch</span><span class="unknown token" data-binding="">:=</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.assumption-24094" data-verso-hover="317">assumption</span><span class="unknown token" data-binding="">)</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-15339860773356334190-24076-24105"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.35" data-verso-hover="316">hx₀</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="const token" data-binding="const-Neg.neg" data-verso-hover="182">-</span>(<span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span></span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>-(x₀ ^ 2)⁻¹ : ℝ
</pre></div>
            <p>
              We introduced a point <code>x₀</code> and assumption <code>hx₀</code> that it is not equal to zero. By default <code>fun_trans</code> does not see this assumption and we have to provide discharger. A discharger is any tactic that tries to satisfy(discharge) any assumption of the theorems <code>fun_trans</code> is using. In this simple case <code>assumption</code> tactic is enough as it just looks through the local context and tries to directly apply any existing assumptions.</p>
            <p>
              Using <code>assumption</code> is not enough for a more complicated expression</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-24688" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.35" data-verso-hover="316">hx₀</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">≠</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">∂ (x:=x₀), (x ^ 2)⁻¹ : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-24731">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.75" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.75" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-24738">rewrite_by</span> <span class="tactic"><label for="tactic-state-3224104707086150454-24772-24801"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-24772">fun_trans</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-token.disch-24783">disch</span><span class="unknown token" data-binding="">:=</span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.assumption-24790" data-verso-hover="317">assumption</span><span class="unknown token" data-binding="">)</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-3224104707086150454-24772-24801"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.35" data-verso-hover="316">hx₀</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type">∂ (<span class="var token" data-binding="var-_uniq.3271" data-verso-hover="236">x</span>:=<span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span>), (<span class="var token" data-binding="var-_uniq.3271" data-verso-hover="236">x</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2)<span class="const token" data-binding="const-Inv.inv" data-verso-hover="259">⁻¹</span></span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>∂ (x:=x₀), (x ^ 2)⁻¹ : ℝ
</pre></div>
            <p>
              tracing shows</p>
            <pre>[Meta.Tactic.fun_trans] HDiv.hDiv.arg_a0a1.fderiv_rule_at,
  failed to discharge hypotheses x₀ ^ 2 ≠ 0
</pre><p>
              We need a tactic that is capable of infering <code>(x₀^2 ≠ 0)</code> from <code>(x₀ ≠ 0)</code>. A very general and powerful tactic is <code>aesop</code></p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-25158" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.35" data-verso-hover="316">hx₀</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span> <span class="unknown token" data-binding="">≠</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span>
<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">-(2 * x₀) / (x₀ ^ 2) ^ 2 : ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-25201">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.75" data-verso-hover="236">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">1</span><span class="unknown token" data-binding="">/</span><span class="var token" data-binding="var-_uniq.75" data-verso-hover="236">x</span><span class="unknown token" data-binding="">^</span><span class="unknown token" data-binding="">2</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-25208">rewrite_by</span> <span class="tactic"><label for="tactic-state-8078952733232278183-25242-25266"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-25242">fun_trans</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-token.disch-25253">disch</span><span class="unknown token" data-binding="">:=</span><span class="has-info warning"><span class="hover-container"><span class="hover-info messages"><code class="message warning">aesop: failed to prove the goal. Some goals were not explored because the maximum rule application depth (30) was reached. Set option 'maxRuleApplicationDepth' to increase the limit.</code><code class="message warning">aesop: failed to prove the goal. Some goals were not explored because the maximum rule application depth (30) was reached. Set option 'maxRuleApplicationDepth' to increase the limit.</code></span></span><span class="keyword token" data-binding="kw-occ-Aesop.Frontend.Parser.aesopTactic-25260" data-verso-hover="318">aesop</span></span><span class="unknown token" data-binding="">)</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-8078952733232278183-25242-25266"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.35" data-verso-hover="316">hx₀</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type"><span class="const token" data-binding="const-Neg.neg" data-verso-hover="182">-</span>(2<span class="const token" data-binding="const-HMul.hMul" data-verso-hover="153"> * </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span>)<span class="const token" data-binding="const-HDiv.hDiv" data-verso-hover="152"> / </span>(<span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">x₀</span><span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2)<span class="const token" data-binding="const-HPow.hPow" data-verso-hover="238"> ^ </span>2</span></span></div></div></span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>-(2 * x₀) / (x₀ ^ 2) ^ 2 : ℝ
</pre></div>
            <p>
              In multiple dimensions we often want to differentiate the norm</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-25412" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span> <span class="unknown token" data-binding="">Scalar</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-25433" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.62" data-verso-hover="316">hx₀</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span> <span class="unknown token" data-binding="">≠</span> <span class="unknown token" data-binding="">0</span><span class="unknown token" data-binding="">)</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">‖x₀‖₂[ℝ]⁻¹ • x₀ : ℝ × ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-25482">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.129" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:=</span><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.129" data-verso-hover="240">x</span><span class="unknown token" data-binding="">‖₂</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-25489">rewrite_by</span> <span class="tactic"><label for="tactic-state-7606327244069302305-25528-25544"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.unfold-25528" data-verso-hover="311">unfold</span> <span class="const token" data-binding="const-SciLean.fgradient" data-verso-hover="319">fgradient</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7606327244069302305-25528-25544"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span><span class="const token" data-binding="const-Prod" data-verso-hover="71"> × </span><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.62" data-verso-hover="316">hx₀</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span><span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type">(&lt;∂ (<span class="var token" data-binding="var-_uniq.1567" data-verso-hover="240">x</span>:=<span class="var token" data-binding="var-_uniq.4" data-verso-hover="240">x₀</span>), <span class="const token" data-binding="const-SciLean.norm₂" data-verso-hover="320">‖</span><span class="var token" data-binding="var-_uniq.1567" data-verso-hover="240">x</span><span class="const token" data-binding="const-SciLean.norm₂" data-verso-hover="320">‖₂[</span><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span><span class="const token" data-binding="const-SciLean.norm₂" data-verso-hover="320">]</span>).2 1</span></span></div></div></span><span class="unknown token" data-binding="">;</span> <span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-25546">fun_trans</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-token.disch-25557">disch</span><span class="unknown token" data-binding="">:=</span><span class="tactic"><label for="tactic-state-7-25564-25574"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.assumption-25564" data-verso-hover="317">assumption</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-25564-25574"><div class="tactic-state">All goals completed! 🐙</div></span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><p>
              The fact that norm is not differentiable can cause issues. The common practice when writing numerical algorithms is to regularize norm using a small positive <code>ε</code>.</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-25775" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span> <span class="unknown token" data-binding="">Scalar</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-25795" data-verso-hover="52">variable</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.63" data-verso-hover="321">hε</span> <span class="unknown token" data-binding="">:</span> <span class="unknown token" data-binding="">0</span> <span class="unknown token" data-binding="">&lt;</span> <span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span><span class="unknown token" data-binding="">)</span>

<span class="has-info info"><span class="hover-container"><span class="hover-info messages"><code class="message info">fun w =&gt; fun x =&gt;L[ℝ] 2 * ⟪x, w⟫_ℝ / (2 * sqrt (ε + ‖w‖₂²)) : ℝ × ℝ → ℝ × ℝ →L[ℝ] ℝ</code></span></span><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.check-25831">#check</span></span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.134" data-verso-hover="240">x</span><span class="unknown token" data-binding="">:</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">×</span><span class="unknown token" data-binding="">ℝ</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">,</span> <span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span> <span class="unknown token" data-binding="">+</span> <span class="unknown token" data-binding="">‖</span><span class="var token" data-binding="var-_uniq.134" data-verso-hover="240">x</span><span class="unknown token" data-binding="">‖₂²</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="keyword token" data-binding="kw-occ-SciLean.term_Rewrite_byAssuming__-25838">rewrite_by</span>
  <span class="tactic"><label for="tactic-state-10394615373954461386-25896-25908"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.Conv.unfold-25896" data-verso-hover="311">unfold</span> <span class="const token" data-binding="const-deriv" data-verso-hover="246">deriv</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-10394615373954461386-25896-25908"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.63" data-verso-hover="321">hε</span></td><td class="colon">:</td><td class="type">0<span class="const token" data-binding="const-LT.lt" data-verso-hover="154"> &lt; </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span></td></tr></table><span class="conclusion"><span class="prefix">| </span><span class="type">∂ <span class="var token" data-binding="var-_uniq.7704" data-verso-hover="240">x</span>, <span class="const token" data-binding="const-SciLean.Scalar.sqrt" data-verso-hover="95">sqrt</span> (<span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>‖<span class="var token" data-binding="var-_uniq.7704" data-verso-hover="240">x</span>‖₂²)</span></span></div></div></span>
  <span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransConvStx-25911">fun_trans</span> <span class="unknown token" data-binding="">(</span><span class="keyword token" data-binding="kw-occ-token.disch-25922">disch</span><span class="unknown token" data-binding="">:=</span><span class="tactic"><label for="tactic-state-9167456033761161832-25929-25936"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.intro-25929" data-verso-hover="322">intro</span> <span class="var token" data-binding="var-_uniq.1155" data-verso-hover="240">x</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-9167456033761161832-25929-25936"><div class="tactic-state"><div class="goal"><details open="open"><summary><span class="goal-name">funProp.discharger</span></summary><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.63" data-verso-hover="321">hε</span></td><td class="colon">:</td><td class="type">0<span class="const token" data-binding="const-LT.lt" data-verso-hover="154"> &lt; </span><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1155" data-verso-hover="240">x</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span><span class="const token" data-binding="const-Prod" data-verso-hover="71"> × </span><span class="const token" data-binding="const-Real" data-verso-hover="237">ℝ</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type"><span class="var token" data-binding="var-_uniq.2" data-verso-hover="236">ε</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>‖<span class="var token" data-binding="var-_uniq.1155" data-verso-hover="240">x</span>‖₂²<span class="const token" data-binding="const-Ne" data-verso-hover="258"> ≠ </span>0</span></span></details></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-25938-25968"><span class="keyword token" data-binding="kw-occ-nlinarith-25938" data-verso-hover="323">nlinarith</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-SciLean.norm2_nonneg" data-verso-hover="324">norm2_nonneg</span> <span class="unknown token" data-binding="">ℝ</span> <span class="var token" data-binding="var-_uniq.1155" data-verso-hover="240">x</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-25938-25968"><div class="tactic-state">All goals completed! 🐙</div></span><span class="unknown token" data-binding="">)</span>
<span class="unknown token" data-binding=""></span></code><div class="information">
              <pre>fun w =&gt; fun x =&gt;L[ℝ] 2 * ⟪x, w⟫_ℝ / (2 * sqrt (ε + ‖w‖₂²)) : ℝ × ℝ → ℝ × ℝ →L[ℝ] ℝ
</pre></div>
            <div class="TODO">
              <p>
                Figuring out the right tactic like <code>intro x; nlinarith [norm2_nonneg ℝ x]</code> can be difficult. Therefore introduce tactic/discharger <code>unsafe_ad_disch</code> that assumes commong AD assumptions and reports them back to user.</p>
              <p>
                Create unsafe mode differentiation which assumes that everything works out. Effectivelly this requires discharger that recognize commong goals that should be sorries or postponed.</p>
              </div>
            <section>
              <h3 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Differentiating-Division-Log-Sqrt---Exercises">
                Exercises</h3>
              <ol start="1">
                <li>
                  <p>
                    gradient of energy for n-body system, newton's potential, lenard jones potential</p>
                  <ul>
                    <li>
                      <p>
                        do it for two particles </p>
                      </li>
                    <li>
                      <p>
                        do it for n-particles</p>
                      </li>
                    </ul>
                  </li>
                <li>
                  <p>
                    signed distance function </p>
                  <ul>
                    <li>
                      <p>
                        compute gradient of sphere sdf</p>
                      </li>
                    <li>
                      <p>
                        compute mean and gaussian curvature of sphere</p>
                      </li>
                    <li>
                      <p>
                        pick SDF from https://iquilezles.org/articles/distfunctions/</p>
                      <ul>
                        <li>
                          <p>
                            most of them involve functions that are not differentiable everywhere</p>
                          </li>
                        <li>
                          <p>
                            compute derivative in unsafe mode</p>
                          </li>
                        <li>
                          <p>
                            figure out the minimal condition under which it is differentiable</p>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ol>
              </section>
            </section>
          <section>
            <h2 id="Scientific-Computing-in-Lean---Differentiation--Symbolic-Differentiation--Abstract-Vector-Spaces">
              Abstract Vector Spaces</h2>
            <p>
              In calculus we usually consider only functions \((f : \mathbb{R}^n \rightarrow \mathbb{R}^m) \). The issue is that on computers the type \( \mathbb{R}^n \) can have multiple different realizations. For example \( \mathbb{R}^3 \) can be modeled by <code>Float×Float×Float</code>, <code>Float^[3]</code> or <code>Float×Float^[2]</code>. They are all equivalent but in code we have to explicitely convert between these types. For this reason it is better to work with abstract vector spaces instead of with \( \mathbb{R}^n \).</p>
            <p>
              Fortunately mathlib's derivative <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-fderiv" data-verso-hover="235">fderiv</span></code> is already defined for a function <code>(f : X → Y)</code> between two abstract vector spaces <code>X</code> and <code>Y</code> over a field <code>𝕜</code>. Mathlib's way of introducing an abstract vector space is rather involved and we need to spend some time talking about it. This presentation will be rather simplified. For interested reader we provide references at the end of this section that go over mathlib's algebraic stracutes in more detail.</p>
            <p>
              A vector space <code>X</code> is a set with operations <code>+,-,•,0</code> such that </p>
            <pre>  ∀ (x y z : X), x + (y + z) = (x + y) + z
  ∀ (x y : X), x + y = y + x
  ∀ (x : X), x + 0 = 0
  ∀ (x : X), x + (-x) = 0

  ∀ (r s : 𝕜) (x : X), r • (s • x) = (r * s) • x(
  ∀ (x : X), 1 • x = x
  ∀ (r : 𝕜) (x y : X), r • (x + y) = r • x + r • y
  ∀ (r s : 𝕜) (x : X), (r + s) • x = r • x + s • x
</pre><p>
              in mathlib the axioms talking about addition and negation are captured by the type class <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-AddCommGroup" data-verso-hover="325">AddCommGroup</span></code> and the aximps talking about scalar multiplication are captured by the type class <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-Module" data-verso-hover="326">Module</span></code>. Therefore if we want to introduce a new abstract vector space over a field <code>R</code> we have to introduce these variables</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-28829" data-verso-hover="52">variable</span> 
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">𝕜</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-Field" data-verso-hover="327">Field</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">𝕜</span><span class="unknown token" data-binding="">]</span>
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.9" data-verso-hover="328">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AddCommGroup" data-verso-hover="325">AddCommGroup</span> <span class="var token" data-binding="var-_uniq.9" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-Module" data-verso-hover="326">Module</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="272">𝕜</span> <span class="var token" data-binding="var-_uniq.9" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-28901">example</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span> <span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="139">𝕜</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span> <span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.9" data-verso-hover="138">X</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span> 
    <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">•</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=</span> <span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span> <span class="unknown token" data-binding="">•</span> <span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span> <span class="unknown token" data-binding="">•</span> <span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span> <span class="unknown token" data-binding="">•</span> <span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span> <span class="unknown token" data-binding="">•</span> <span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-6381913159591360303-29002-29004"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-29002" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-6381913159591360303-29002-29004"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3" data-verso-hover="139">𝕜</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_2</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.758" data-verso-hover="330">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Field" data-verso-hover="327">Field</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="139">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.9" data-verso-hover="138">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.764" data-verso-hover="331">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AddCommGroup" data-verso-hover="325">AddCommGroup</span> <span class="var token" data-binding="var-_uniq.9" data-verso-hover="138">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1504" data-verso-hover="332">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Module" data-verso-hover="326">Module</span> <span class="var token" data-binding="var-_uniq.3" data-verso-hover="139">𝕜</span> <span class="var token" data-binding="var-_uniq.9" data-verso-hover="138">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.3" data-verso-hover="139">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.3" data-verso-hover="139">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.9" data-verso-hover="138">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.9" data-verso-hover="138">X</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(<span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span>)<span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span>(<span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span><span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span><span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span><span class="var token" data-binding="var-_uniq.1510" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1506" data-verso-hover="329">s</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span><span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1508" data-verso-hover="329">r</span><span class="const token" data-binding="const-HSMul.hSMul" data-verso-hover="205"> • </span><span class="var token" data-binding="var-_uniq.1512" data-verso-hover="278">y</span></span></span></div></div></span> 
  <span class="tactic"><label for="tactic-state-7-29008-29047"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.simp-29008" data-verso-hover="199">simp</span> <span class="keyword token" data-binding="kw-occ-null-29013">only</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-add_smul" data-verso-hover="333">add_smul</span><span class="unknown token" data-binding="">,</span><span class="const token" data-binding="const-smul_add" data-verso-hover="334">smul_add</span><span class="unknown token" data-binding="">,</span><span class="const token" data-binding="const-add_assoc" data-verso-hover="335">add_assoc</span><span class="unknown token" data-binding="">]</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-29008-29047"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><p>
              When we want to differentiate a function <code>(f : X → Y)</code> between two vector spaces we also need that <code>X</code> and <code>Y</code> are equiped with a norm. For this purpose there is <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span></code> which equips <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-AddCommGroup" data-verso-hover="325">AddCommGroup</span></code> with a norm and guarantees that it compatible with addition and negation, and <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span></code> which equips <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-Module" data-verso-hover="326">Module</span></code> with a norm and guarentees that it is compatible with scalar multiplication. Furthermore, we have to restric to a filed <code>𝕜</code> that is either real numbers <code>ℝ</code> or complex numbers <code>ℂ</code>. The type class <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span></code> states exactly that. Therefore when we work with derivative in general setting the code usually looks like this</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-29741" data-verso-hover="52">variable</span> 
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.291" data-verso-hover="272">𝕜</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="272">𝕜</span><span class="unknown token" data-binding="">]</span>
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.297" data-verso-hover="328">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="272">𝕜</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span>
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.441" data-verso-hover="338">Y</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="338">Y</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="272">𝕜</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="338">Y</span><span class="unknown token" data-binding="">]</span>

<span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-29875">set_default_scalar</span> <span class="unknown token" data-binding="">𝕜</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-29900">example</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span> <span class="unknown token" data-binding="">→</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1485" data-verso-hover="340">hf</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1500" data-verso-hover="341">hg</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span>
    <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.1509" data-verso-hover="278">x</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.1509" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.1509" data-verso-hover="278">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">+</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∂</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-1238051022101496610-30032-30034"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-30032" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-1238051022101496610-30032-30034"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1111" data-verso-hover="342">inst✝⁴</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_2</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1117" data-verso-hover="280">inst✝³</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1255" data-verso-hover="343">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_3</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1261" data-verso-hover="344">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1393" data-verso-hover="345">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1485" data-verso-hover="340">hf</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1500" data-verso-hover="341">hg</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∂ <span class="var token" data-binding="var-_uniq.11903" data-verso-hover="278">x</span>, (<span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.11903" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.11903" data-verso-hover="278">x</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>∂ <span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>∂ <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span></span></span></div></div></span> <span class="tactic"><label for="tactic-state-10891431447875529112-30035-30043"><span class="keyword token" data-binding="kw-occ-Lean.Elab.Tactic.Ext.ext-30035" data-verso-hover="198">ext</span> <span class="var token" data-binding="var-_uniq.5689" data-verso-hover="278">x</span> <span class="var token" data-binding="var-_uniq.10350" data-verso-hover="278">dx</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-10891431447875529112-30035-30043"><div class="tactic-state"><div class="goal"><details open="open"><summary><span class="goal-name">h.h</span></summary><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1111" data-verso-hover="342">inst✝⁴</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_2</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1117" data-verso-hover="280">inst✝³</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1255" data-verso-hover="343">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_3</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1261" data-verso-hover="344">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1393" data-verso-hover="345">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.441" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1485" data-verso-hover="340">hf</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1500" data-verso-hover="341">hg</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.291" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5689" data-verso-hover="278">x</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.10350" data-verso-hover="278">dx</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.297" data-verso-hover="139">X</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(∂ (<span class="var token" data-binding="var-_uniq.11902" data-verso-hover="278">x</span>:=<span class="var token" data-binding="var-_uniq.5689" data-verso-hover="278">x</span>), (<span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.11902" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.11902" data-verso-hover="278">x</span>)) <span class="var token" data-binding="var-_uniq.10350" data-verso-hover="278">dx</span><span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>((∂ <span class="var token" data-binding="var-_uniq.1397" data-verso-hover="339">f</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>∂ <span class="var token" data-binding="var-_uniq.1401" data-verso-hover="339">g</span>) <span class="var token" data-binding="var-_uniq.5689" data-verso-hover="278">x</span>) <span class="var token" data-binding="var-_uniq.10350" data-verso-hover="278">dx</span></span></span></details></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-30045-30054"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-30045">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-30045-30054"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><p>
              When working with gradients we also need inner product as <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-adjoint" data-verso-hover="279">adjoint</span></code> is defined through inner product. Unfortunately, here we diverge from mathlib a little bit. Mathlib defines <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-InnerProductSpace" data-verso-hover="346">InnerProductSpace</span></code> which equips <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span></code> with inner product. Understandably <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-InnerProductSpace" data-verso-hover="346">InnerProductSpace</span></code> requires that the <code>⟪x,x⟫ = ‖x‖²</code> however mathlib made the unfortunate decision by definin norm on produce spaces as <code>‖(x,y)‖ = max ‖x‖ ‖y‖</code> which is incompatible with the inner product structure. Therefore type like <code>ℝ×ℝ</code> can't be equiped with <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-InnerProductSpace" data-verso-hover="346">InnerProductSpace</span></code>. Because of these issues, SciLean introduces <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span></code> which is almost identical to <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-InnerProductSpace" data-verso-hover="346">InnerProductSpace</span></code> but it only requires that the norm induced by inner product is equivalend to the existing norm i.e. <code>∃ (c d : ℝ⁺), ∀ x, c * ⟪x,x⟫ ≤ ‖x‖^2 ≤ d * ⟪x,x⟫</code>. On <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span></code> SciLean  introduces L₂-norm <code>‖x‖₂ := sqrt ⟪x,x⟫</code> which you have seen already and it is the norm you most likely want to use instead of the default norm <code>‖x‖</code>. Therfore when we work with gradient in general setting the code usually looks like this</p>
            <code class="hl lean block" data-lean-context="examples"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.open-31251" data-verso-hover="13">open</span> <span class="unknown token" data-binding="">SciLean</span>
<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.variable-31264" data-verso-hover="52">variable</span> 
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.1629" data-verso-hover="272">𝕜</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="272">𝕜</span><span class="unknown token" data-binding="">]</span>
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="328">X</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="272">𝕜</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="328">X</span><span class="unknown token" data-binding="">]</span>
  <span class="unknown token" data-binding="">{</span><span class="var token" data-binding="var-_uniq.2448" data-verso-hover="347">Y</span><span class="unknown token" data-binding="">}</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="347">Y</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="272">𝕜</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="347">Y</span><span class="unknown token" data-binding="">]</span> <span class="unknown token" data-binding="">[</span><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="347">Y</span><span class="unknown token" data-binding="">]</span>

<span class="keyword token" data-binding="kw-occ-SciLean.NotationOverField.commandSet_default_scalar_-31436">set_default_scalar</span> <span class="unknown token" data-binding="">𝕜</span>

<span class="keyword token" data-binding="kw-occ-Lean.Parser.Command.example-31461">example</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span> <span class="unknown token" data-binding="">:</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> <span class="unknown token" data-binding="">→</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.5549" data-verso-hover="340">hf</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.5564" data-verso-hover="341">hg</span> <span class="unknown token" data-binding="">:</span> <span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:</span>
    <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="var token" data-binding="var-_uniq.5573" data-verso-hover="278">x</span><span class="unknown token" data-binding="">,</span> <span class="unknown token" data-binding="">(</span><span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.5573" data-verso-hover="278">x</span> <span class="unknown token" data-binding="">+</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.5573" data-verso-hover="278">x</span><span class="unknown token" data-binding="">)</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">=</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">+</span> <span class="unknown token" data-binding="">(</span><span class="unknown token" data-binding="">∇</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span><span class="unknown token" data-binding="">)</span> <span class="unknown token" data-binding="">:=</span> <span class="tactic"><label for="tactic-state-12051428147710481147-31593-31595"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Term.byTactic-31593" data-verso-hover="69">by</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-12051428147710481147-31593-31595"><div class="tactic-state"><div class="goal"><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3787" data-verso-hover="342">inst✝⁶</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_2</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3793" data-verso-hover="280">inst✝⁵</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3811" data-verso-hover="348">inst✝⁴</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4600" data-verso-hover="282">inst✝³</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_3</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4606" data-verso-hover="344">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4623" data-verso-hover="349">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5407" data-verso-hover="350">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5549" data-verso-hover="340">hf</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5564" data-verso-hover="341">hg</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∇ <span class="var token" data-binding="var-_uniq.12689" data-verso-hover="278">x</span>, (<span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.12689" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.12689" data-verso-hover="278">x</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>∇ <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>∇ <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></span></span></div></div></span> 
  <span class="tactic"><label for="tactic-state-6566922109952710944-31599-31604"><span class="keyword token" data-binding="kw-occ-Lean.Elab.Tactic.Ext.ext-31599" data-verso-hover="198">ext</span> <span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-6566922109952710944-31599-31604"><div class="tactic-state"><div class="goal"><details open="open"><summary><span class="goal-name">h.h</span></summary><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3787" data-verso-hover="342">inst✝⁶</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_2</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3793" data-verso-hover="280">inst✝⁵</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3811" data-verso-hover="348">inst✝⁴</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4600" data-verso-hover="282">inst✝³</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_3</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4606" data-verso-hover="344">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4623" data-verso-hover="349">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5407" data-verso-hover="350">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5549" data-verso-hover="340">hf</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5564" data-verso-hover="341">hg</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.11396" data-verso-hover="351">x✝</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">∇ (<span class="var token" data-binding="var-_uniq.12689" data-verso-hover="278">x</span>:=<span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span>;<span class="var token" data-binding="var-_uniq.11396" data-verso-hover="351">x✝</span>), (<span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.12689" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.12689" data-verso-hover="278">x</span>)<span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>(∇ <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span>∇ <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span>) <span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span> <span class="var token" data-binding="var-_uniq.11396" data-verso-hover="351">x✝</span></span></span></details></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-15287974823856794546-31606-31626"><span class="keyword token" data-binding="kw-occ-Lean.Parser.Tactic.unfold-31606" data-verso-hover="253">unfold</span> <span class="const token" data-binding="const-SciLean.adjointFDeriv" data-verso-hover="352">adjointFDeriv</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-15287974823856794546-31606-31626"><div class="tactic-state"><div class="goal"><details open="open"><summary><span class="goal-name">h.h</span></summary><table class="hypotheses"><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_1</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3787" data-verso-hover="342">inst✝⁶</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-RCLike" data-verso-hover="337">RCLike</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_2</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3793" data-verso-hover="280">inst✝⁵</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.3811" data-verso-hover="348">inst✝⁴</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4600" data-verso-hover="282">inst✝³</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td><td class="colon">:</td><td class="type"><span class="sort token" data-binding="">Type u_3</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4606" data-verso-hover="344">inst✝²</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-NormedAddCommGroup" data-verso-hover="273">NormedAddCommGroup</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.4623" data-verso-hover="349">inst✝¹</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-AdjointSpace" data-verso-hover="274">AdjointSpace</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5407" data-verso-hover="350">inst✝</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-CompleteSpace" data-verso-hover="275">CompleteSpace</span> <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span> → <span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5549" data-verso-hover="340">hf</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.5564" data-verso-hover="341">hg</span></td><td class="colon">:</td><td class="type"><span class="const token" data-binding="const-Differentiable" data-verso-hover="285">Differentiable</span> <span class="var token" data-binding="var-_uniq.1629" data-verso-hover="138">𝕜</span> <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.1635" data-verso-hover="139">X</span></td></tr><tr class="hypothesis"><td class="name"><span class="var token" data-binding="var-_uniq.11396" data-verso-hover="351">x✝</span></td><td class="colon">:</td><td class="type"><span class="var token" data-binding="var-_uniq.2448" data-verso-hover="140">Y</span></td></tr></table><span class="conclusion"><span class="prefix">⊢ </span><span class="type">(&lt;∂ (<span class="var token" data-binding="var-_uniq.12674" data-verso-hover="278">x</span>:=<span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span>), (<span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.12674" data-verso-hover="278">x</span><span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.12674" data-verso-hover="278">x</span>)).2 <span class="var token" data-binding="var-_uniq.11396" data-verso-hover="351">x✝</span><span class="const token" data-binding="const-Eq" data-verso-hover="72"> = </span>((<span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.12702" data-verso-hover="278">x</span> <span class="var token" data-binding="var-_uniq.12704" data-verso-hover="351">dy</span> =&gt; (&lt;∂ <span class="var token" data-binding="var-_uniq.5411" data-verso-hover="339">f</span> <span class="var token" data-binding="var-_uniq.12702" data-verso-hover="278">x</span>).2 <span class="var token" data-binding="var-_uniq.12704" data-verso-hover="351">dy</span>)<span class="const token" data-binding="const-HAdd.hAdd" data-verso-hover="156"> + </span><span class="keyword token" data-binding="">fun</span> <span class="var token" data-binding="var-_uniq.12720" data-verso-hover="278">x</span> <span class="var token" data-binding="var-_uniq.12722" data-verso-hover="351">dy</span> =&gt; (&lt;∂ <span class="var token" data-binding="var-_uniq.5415" data-verso-hover="339">g</span> <span class="var token" data-binding="var-_uniq.12720" data-verso-hover="278">x</span>).2 <span class="var token" data-binding="var-_uniq.12722" data-verso-hover="351">dy</span>) <span class="var token" data-binding="var-_uniq.11362" data-verso-hover="278">x</span> <span class="var token" data-binding="var-_uniq.11396" data-verso-hover="351">x✝</span></span></span></details></div></div></span><span class="unknown token" data-binding="">;</span> <span class="tactic"><label for="tactic-state-7-31628-31637"><span class="keyword token" data-binding="kw-occ-Mathlib.Meta.FunTrans.funTransTacStx-31628">fun_trans</span></label><input type="checkbox" class="tactic-toggle" id="tactic-state-7-31628-31637"><div class="tactic-state">All goals completed! 🐙</div></span>
<span class="unknown token" data-binding=""></span></code><p>
              For interested reader we recommend reading the chapter <a href="https://leanprover-community.github.io/mathematics_in_lean/C07_Hierarchies.html">Hierachies</a> from <a href="https://leanprover-community.github.io/mathematics_in_lean/index.html">Mathematics in Lean</a> which explains how mathlib approaches algebraic hierachies like monoids, groups or modules. After reading that we recommend reading <a href="https://leanprover-community.github.io/mathematics_in_lean/C10_Differential_Calculus.html#differential-calculus-in-normed-spaces">Differential Calculus in Normed Spaces</a> which how <code class="hl lean inline" data-lean-context="examples"><span class="const token" data-binding="const-NormedSpace" data-verso-hover="336">NormedSpace</span></code> is structured.
</p>
            </section>
          </section>
        </main></div>
    </body>
  </html>

